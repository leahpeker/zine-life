var xa=Object.defineProperty;var wa=(i,t,b)=>t in i?xa(i,t,{enumerable:!0,configurable:!0,writable:!0,value:b}):i[t]=b;var bn=(i,t,b)=>wa(i,typeof t!="symbol"?t+"":t,b);import{b as xn,d as Sa,f as at,a as rt,c as oe}from"../chunks/CcV_VuSo.js";import{h as te,j as Ki,b as Ca,F as M,a1 as jt,k as ka,l as Pa,m as wn,q as wi,u as Gi,i as xe,aq as Ta,v as Lr,d as Dr,x as Aa,au as Nr,al as Ea,A as Ra,aE as Sn,aF as Li,ab as Zi,aG as rn,aH as Cn,aI as Ma,at as Fa,aJ as Ga,g as La,aK as an,aL as Da,a9 as vi,a8 as Na,S as Qi,an as Or,aM as Ir,aN as Oa,t as St,aO as Ia,ar as Ba,ap as Ua,Q as Br,L as sn,R as on,ax as Ha,y as Ya,aP as Xa,w as Ai,D as yi,p as yt,o as Ur,J as X,c as q,s as Q,a as bt,C as nt,af as mt,r as z,f as Nt,n as $t,ah as ft,V as pi,aQ as Va,aR as Hr,aS as kn,aT as ie,e as Yr}from"../chunks/DJyLtpc6.js";import{i as xt,s as Wa,a as bi}from"../chunks/gKitEQSh.js";import{a as ye,r as Lt,b as Wt,c as Te,s as Ji,i as Xr,d as Vr,e as za}from"../chunks/TsCzQh6U.js";import{b as Qt,c as Wr,p as Y,r as ne,s as qa}from"../chunks/CzgbTavc.js";import{l as ln,d as re,s as ee,g as hn}from"../chunks/DdiWcGdF.js";import{s as zr}from"../chunks/DNe1EnZt.js";import{i as qr}from"../chunks/DYkMGIht.js";function we(i,t){return t}function ja(i,t,b,u){for(var g=[],l=t.length,h=0;h<l;h++)Ma(t[h].e,g,!0);var a=l>0&&g.length===0&&b!==null;if(a){var c=b.parentNode;Fa(c),c.append(b),u.clear(),_e(i,t[0].prev,t[l-1].next)}Ga(g,()=>{for(var r=0;r<l;r++){var s=t[r];a||(u.delete(s.k),_e(i,s.prev,s.next)),La(s.e,!a)}})}function de(i,t,b,u,g,l=null){var h=i,a={flags:t,items:new Map,first:null},c=(t&Ir)!==0;if(c){var r=i;h=te?wi(vi(r)):r.appendChild(Na())}te&&Ki();var s=null,p=!1,n=jt(()=>{var e=b();return Ea(e)?e:e==null?[]:Nr(e)});Ca(()=>{var e=M(n),f=e.length;if(p&&f===0)return;p=f===0;let _=!1;if(te){var y=ka(h)===Pa;y!==(f===0)&&(h=wn(),wi(h),Gi(!1),_=!0)}if(te){for(var k=null,d,o=0;o<f;o++){if(xe.nodeType===8&&xe.data===Ta){h=xe,_=!0,Gi(!1);break}var m=e[o],x=u(m,o);d=jr(xe,a,k,null,m,x,o,g,t,b),a.items.set(x,d),k=d}f>0&&wi(wn())}te||Ka(e,a,h,g,t,u,b),l!==null&&(f===0?s?Lr(s):s=Dr(()=>l(h)):s!==null&&Aa(s,()=>{s=null})),_&&Gi(!0),M(n)}),te&&(h=xe)}function Ka(i,t,b,u,g,l,h){var C,w,R,G;var a=(g&Oa)!==0,c=(g&(an|rn))!==0,r=i.length,s=t.items,p=t.first,n=p,e,f=null,_,y=[],k=[],d,o,m,x;if(a)for(x=0;x<r;x+=1)d=i[x],o=l(d,x),m=s.get(o),m!==void 0&&((C=m.a)==null||C.measure(),(_??(_=new Set)).add(m));for(x=0;x<r;x+=1){if(d=i[x],o=l(d,x),m=s.get(o),m===void 0){var P=n?n.e.nodes_start:b;f=jr(P,t,f,f===null?t.first:f.next,d,o,x,u,g,h),s.set(o,f),y=[],k=[],n=f.next;continue}if(c&&Za(m,d,x,g),(m.e.f&Li)!==0&&(Lr(m.e),a&&((w=m.a)==null||w.unfix(),(_??(_=new Set)).delete(m))),m!==n){if(e!==void 0&&e.has(m)){if(y.length<k.length){var L=k[0],A;f=L.prev;var T=y[0],S=y[y.length-1];for(A=0;A<y.length;A+=1)Pn(y[A],L,b);for(A=0;A<k.length;A+=1)e.delete(k[A]);_e(t,T.prev,S.next),_e(t,f,T),_e(t,S,L),n=L,f=S,x-=1,y=[],k=[]}else e.delete(m),Pn(m,n,b),_e(t,m.prev,m.next),_e(t,m,f===null?t.first:f.next),_e(t,f,m),f=m;continue}for(y=[],k=[];n!==null&&n.k!==o;)(n.e.f&Li)===0&&(e??(e=new Set)).add(n),k.push(n),n=n.next;if(n===null)continue;m=n}y.push(m),f=m,n=m.next}if(n!==null||e!==void 0){for(var E=e===void 0?[]:Nr(e);n!==null;)(n.e.f&Li)===0&&E.push(n),n=n.next;var F=E.length;if(F>0){var v=(g&Ir)!==0&&r===0?b:null;if(a){for(x=0;x<F;x+=1)(R=E[x].a)==null||R.measure();for(x=0;x<F;x+=1)(G=E[x].a)==null||G.fix()}ja(t,E,v,s)}}a&&Qi(()=>{var N;if(_!==void 0)for(m of _)(N=m.a)==null||N.apply()}),Zi.first=t.first&&t.first.e,Zi.last=f&&f.e}function Za(i,t,b,u){(u&an)!==0&&Cn(i.v,t),(u&rn)!==0?Cn(i.i,b):i.i=b}function jr(i,t,b,u,g,l,h,a,c,r){var s=(c&an)!==0,p=(c&Da)===0,n=s?p?Ra(g):Sn(g):g,e=(c&rn)===0?h:Sn(h),f={i:e,v:n,k:l,a:null,e:null,prev:b,next:u};try{return f.e=Dr(()=>a(i,n,e,r),te),f.e.prev=b&&b.e,f.e.next=u&&u.e,b===null?t.first=f:(b.next=f,b.e.next=f.e),u!==null&&(u.prev=f,u.e.prev=f.e),f}finally{}}function Pn(i,t,b){for(var u=i.next?i.next.e.nodes_start:b,g=t?t.e.nodes_start:b,l=i.e.nodes_start;l!==u;){var h=Or(l);g.before(l),l=h}}function _e(i,t,b){t===null?i.first=b:(t.next=b,t.e.next=b&&b.e),b!==null&&(b.prev=t,b.e.prev=t&&t.e)}function $i(i,t,b=!1,u=!1,g=!1){var l=i,h="";St(()=>{var a=Zi;if(h===(h=t()??"")){te&&Ki();return}if(a.nodes_start!==null&&(Ia(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),h!==""){if(te){xe.data;for(var c=Ki(),r=c;c!==null&&(c.nodeType!==8||c.data!=="");)r=c,c=Or(c);if(c===null)throw Ba(),Ua;xn(xe,r),l=wi(c);return}var s=h+"";b?s=`<svg>${s}</svg>`:u&&(s=`<math>${s}</math>`);var p=Sa(s);if((b||u)&&(p=vi(p)),xn(vi(p),p.lastChild),b||u)for(;vi(p);)l.before(vi(p));else l.before(p)}})}function Qa(i,t,b){Br(()=>{var u=sn(()=>t(i,b==null?void 0:b())||{});if(u!=null&&u.destroy)return()=>u.destroy()})}function tn(i,t,b=t){var u=Xa();ln(i,"input",g=>{var l=g?i.defaultValue:i.value;if(l=Ni(i)?Oi(l):l,b(l),u&&l!==(l=t())){var h=i.selectionStart,a=i.selectionEnd;i.value=l??"",a!==null&&(i.selectionStart=h,i.selectionEnd=Math.min(a,i.value.length))}}),(te&&i.defaultValue!==i.value||sn(t)==null&&i.value)&&b(Ni(i)?Oi(i.value):i.value),on(()=>{var g=t();Ni(i)&&g===Oi(i.value)||i.type==="date"&&!g&&!i.value||g!==i.value&&(i.value=g??"")})}const Di=new Set;function ve(i,t,b,u,g=u){var l=b.getAttribute("type")==="checkbox",h=i;let a=!1;if(t!==null)for(var c of t)h=h[c]??(h[c]=[]);h.push(b),ln(b,"change",()=>{var r=b.__value;l&&(r=Tn(h,r,b.checked)),g(r)},()=>g(l?[]:null)),on(()=>{var r=u();if(te&&b.defaultChecked!==b.checked){a=!0;return}l?(r=r||[],b.checked=r.includes(b.__value)):b.checked=Ha(b.__value,r)}),Ya(()=>{var r=h.indexOf(b);r!==-1&&h.splice(r,1)}),Di.has(h)||(Di.add(h),Qi(()=>{h.sort((r,s)=>r.compareDocumentPosition(s)===4?-1:1),Di.delete(h)})),Qi(()=>{if(a){var r;if(l)r=Tn(h,r,b.checked);else{var s=h.find(p=>p.checked);r=s==null?void 0:s.__value}g(r)}})}function Ja(i,t,b=t){ln(i,"change",u=>{var g=u?i.defaultChecked:i.checked;b(g)}),(te&&i.defaultChecked!==i.checked||sn(t)==null)&&b(i.checked),on(()=>{var u=t();i.checked=!!u})}function Tn(i,t,b){for(var u=new Set,g=0;g<i.length;g+=1)i[g].checked&&u.add(i[g].__value);return b||u.delete(t),Array.from(u)}function Ni(i){var t=i.type;return t==="number"||t==="range"}function Oi(i){return i===""?null:+i}const J={Circle:"circle",Rectangle:"rectangle",Square:"square",Triangle:"triangle",Pentagon:"pentagon",Hexagon:"hexagon",Star:"star",Diamond:"diamond",Ellipse:"ellipse",Arrow:"arrow",Heart:"heart",Cross:"cross"},le=Ai([]),Ii={Heading:"heading",Paragraph:"paragraph",Caption:"caption"},he=Ai([]),$a={Upload:"upload"},ce=Ai([]);function ts(){const{subscribe:i,set:t,update:b}=Ai({states:[],currentIndex:-1});function u(s,p,n){return{shapes:yi(le),textElements:yi(he),images:yi(ce),canvasBackgroundColor:s||"#ffffff",canvasWidth:p||500,canvasHeight:n||400}}function g(s,p,n){const e=u(s,p,n);b(f=>{const _=f.states.slice(0,f.currentIndex+1);return _.push(e),_.length>50?(_.shift(),{states:_,currentIndex:_.length-1}):{states:_,currentIndex:_.length-1}})}function l(){b(s=>{if(s.currentIndex>0){const p=s.states[s.currentIndex-1];return le.set(p.shapes),he.set(p.textElements),ce.set(p.images),{...s,currentIndex:s.currentIndex-1,restoredState:p}}return s})}function h(){b(s=>{if(s.currentIndex<s.states.length-1){const p=s.states[s.currentIndex+1];return le.set(p.shapes),he.set(p.textElements),ce.set(p.images),{...s,currentIndex:s.currentIndex+1,restoredState:p}}return s})}function a(s){return s.currentIndex>0}function c(s){return s.currentIndex<s.states.length-1}g();function r(){return yi({subscribe:i,update:b,set:t}).restoredState}return{subscribe:i,pushState:g,undo:l,redo:h,canUndo:a,canRedo:c,getRestoredState:r}}const Kt=ts(),Tt={Shape:"shape",Text:"text",Image:"image"},Mt={Shapes:"shapes",Text:"text",Images:"images"};class es{constructor(){bn(this,"elements",new Map)}getKey(t,b){return`${t}:${b}`}register(t){const b=this.getKey(t.type,t.subType);this.elements.set(b,t)}get(t,b){const u=this.getKey(t,b);return this.elements.get(u)}getByCategory(t){return Array.from(this.elements.values()).filter(b=>b.category===t)}getEditPanel(t,b){var u;return(u=this.get(t,b))==null?void 0:u.editPanel}getKonvaComponent(t,b){var u;return(u=this.get(t,b))==null?void 0:u.konvaComponent}}const Pt=new es,pt={Black:"#000000",Gray:"#808080",Transparent:"transparent",DefaultFill:"#ffa500",DefaultStroke:"#000000"};function Kr(){return`hsl(${Math.random()*360}, 70%, 50%)`}function Zr(){return{x:Math.random()*300+50,y:Math.random()*300+50}}function is(i,t,b){const u=Pt.get(i,t);if(!u)return;const g={id:crypto.randomUUID(),type:i,subType:t,...Zr(),draggable:!0,...u.defaultProps,...b};u.defaultProps.fill&&u.defaultProps.fill!==pt.Transparent&&(g.fill=Kr()),i===Tt.Shape?le.update(l=>[...l,g]):i===Tt.Text?he.update(l=>[...l,g]):i===Tt.Image&&ce.update(l=>[...l,g]),Kt.pushState()}function Qr(i,t,b){le.update(u=>u.map(g=>g.id===i?{...g,x:t,y:b}:g)),he.update(u=>u.map(g=>g.id===i?{...g,x:t,y:b}:g)),ce.update(u=>u.map(g=>g.id===i?{...g,x:t,y:b}:g))}function Jr(){le.set([]),he.set([]),ce.set([]),Kt.pushState()}function ns(i){return t=>{i(t),Kt.pushState(t)}}function rs(i){return t=>{i(t)}}function as(i){return t=>{i(t)}}function ss(i,t){return(b,u)=>{i(b),t(u)}}function os(i,t,b){return()=>{const u=window.innerWidth-80-96,g=window.innerHeight-64-80-96,l=u/i,h=g/t,a=Math.min(l,h),c=Math.max(25,Math.min(500,Math.round(a*100)));b(c)}}function ls(i){return()=>{confirm("Are you sure you want to clear all elements? This cannot be undone.")&&(Jr(),i(null))}}function hs(i){return t=>{i(t)}}function cs(i){const t={id:crypto.randomUUID(),...Zr(),fill:Kr(),draggable:!0,stroke:pt.DefaultStroke,strokeWidth:4};le.update(b=>{let u;switch(i){case J.Circle:u={...t,type:J.Circle,subType:J.Circle,radius:30};break;case J.Rectangle:u={...t,type:J.Rectangle,subType:J.Rectangle,width:60,height:40};break;case J.Square:u={...t,type:J.Square,subType:J.Square,size:50};break;case J.Triangle:u={...t,type:J.Triangle,subType:J.Triangle,sides:3,radius:35};break;case J.Pentagon:u={...t,type:J.Pentagon,subType:J.Pentagon,sides:5,radius:35};break;case J.Hexagon:u={...t,type:J.Hexagon,subType:J.Hexagon,sides:6,radius:35};break;case J.Star:u={...t,type:J.Star,subType:J.Star,numPoints:5,innerRadius:20,outerRadius:40};break;case J.Diamond:u={...t,type:J.Diamond,subType:J.Diamond,sides:4,radius:35};break;case J.Ellipse:u={...t,type:J.Ellipse,subType:J.Ellipse,radiusX:50,radiusY:30};break;case J.Arrow:u={...t,type:J.Arrow,subType:J.Arrow,points:[0,0,60,0],pointerLength:15,pointerWidth:10};break;case J.Heart:u={...t,type:J.Heart,subType:J.Heart,width:50,height:45};break;case J.Cross:u={...t,type:J.Cross,subType:J.Cross,width:50,height:50,thickness:15};break;default:return b}return[...b,u]})}function ds(i,t,b){le.update(u=>u.map(g=>g.id===i?{...g,x:t,y:b}:g))}function us(i,t,b){const u=i/2,g=t/2,l=b/2;return[-l,-g,l,-g,l,-l,u,-l,u,l,l,l,l,g,-l,g,-l,l,-u,l,-u,-l,-l,-l]}function fs(i){switch(i.subType){case J.Circle:return{radius:i.radius};case J.Rectangle:return{width:i.width,height:i.height};case J.Square:return{width:i.size,height:i.size};case J.Triangle:return{sides:3,radius:i.radius};case J.Pentagon:return{sides:5,radius:i.radius};case J.Hexagon:return{sides:6,radius:i.radius};case J.Diamond:return{sides:4,radius:i.radius,rotation:(i.rotation||45)*Math.PI/180};case J.Star:return{numPoints:i.numPoints,innerRadius:i.innerRadius,outerRadius:i.outerRadius};case J.Ellipse:return{radiusX:i.radiusX,radiusY:i.radiusY};case J.Arrow:return{points:i.points,pointerLength:i.pointerLength,pointerWidth:i.pointerWidth};case J.Heart:return{width:i.width,height:i.height,sceneFunc:(b,u)=>{const g=u.width()||50,l=u.height()||45;b.beginPath(),b.moveTo(g/2,l*.9),b.bezierCurveTo(g/2,l*.6,g*.1,l*.6,g*.1,l*.35),b.bezierCurveTo(g*.1,l*.15,g*.3,l*.1,g/2,l*.25),b.bezierCurveTo(g*.7,l*.1,g*.9,l*.15,g*.9,l*.35),b.bezierCurveTo(g*.9,l*.6,g/2,l*.6,g/2,l*.9),b.closePath(),b.fillStrokeShape(u)}};case J.Cross:return{width:i.width,height:i.height,thickness:i.thickness,sceneFunc:(b,u)=>{const g=us(u.width()||50,u.height()||50,u.attrs.thickness||15);b.beginPath(),b.moveTo(g[0],g[1]);for(let l=2;l<g.length;l+=2)b.lineTo(g[l],g[l+1]);b.closePath(),b.fillStrokeShape(u)}};default:return{}}}function gs(i,t){return(b,u)=>{if(b==="upload"&&u){vs(u,i,t);return}const g=Pt.get(Tt.Shape,b)||Pt.get(Tt.Text,b)||Pt.get(Tt.Image,b);g?is(g.type,b):cs(b)}}function vs(i,t,b){const u=document.createElement("img");return u.onload=()=>{const g=u.naturalWidth/u.naturalHeight,l=200;let h=l,a=l;g>1?a=l/g:h=l*g;const c={id:crypto.randomUUID(),type:"image",subType:"upload",x:Math.random()*(t-h),y:Math.random()*(b-a),width:Math.round(h),height:Math.round(a),originalWidth:u.naturalWidth,originalHeight:u.naturalHeight,draggable:!0,opacity:1,scaleX:1,scaleY:1,rotation:0,brightness:0,contrast:0,imageElement:u};ce.update(r=>[...r,c])},u.src=i.src,null}function ps(){return(i,t)=>{le.update(b=>b.map(u=>u.id===i?{...u,...t}:u)),he.update(b=>b.map(u=>u.id===i?{...u,...t}:u)),ce.update(b=>b.map(u=>u.id===i?{...u,...t}:u)),Kt.pushState()}}function _s(i){return()=>{i(null)}}function ms(i){return(t,b)=>{const u=b.target,g=i/100;Qr(t.id,u.x()/g,u.y()/g),Kt.pushState()}}var ys=(i,t)=>t("shapes"),bs=(i,t)=>t("images"),xs=(i,t)=>t("text"),ws=(i,t)=>{confirm("Are you sure you want to clear all elements? This cannot be undone.")&&t.clearCanvas()},Ss=(i,t,b)=>t(M(b).subType),Cs=at('<button class="group flex flex-col items-center rounded-lg border border-gray-200 p-4 text-center transition-all duration-200 hover:border-blue-300 hover:shadow-md"><div class="mb-2 transition-transform duration-200 group-hover:scale-110 text-purple-600"><!></div> <div class="text-sm font-medium text-gray-900 group-hover:text-purple-600"> </div></button>'),ks=at('<div class="border-b border-gray-200 p-6"><h2 class="text-lg font-semibold text-gray-900">Shapes</h2></div> <div class="flex-1 overflow-y-auto p-4"><div class="grid grid-cols-2 gap-3"></div></div>',1),Ps=at('<div class="border-b border-gray-200 p-6"><h2 class="text-lg font-semibold text-gray-900">Images</h2></div> <div class="flex-1 overflow-y-auto p-6"><div class="mb-6"><label for="image-upload" class="block w-full cursor-pointer rounded-lg border-2 border-dashed border-gray-300 p-6 text-center transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"><svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> <p class="mt-2 text-sm font-medium text-gray-900">Upload an image</p> <p class="mt-1 text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p></label> <input id="image-upload" type="file" accept="image/*" class="hidden"/></div> <div class="text-center text-gray-500"><p class="text-sm">Click or drag an image file above to add it to your canvas</p></div></div>',1),Ts=(i,t,b)=>t(M(b).subType),As=at('<button class="group flex items-center rounded-xl border border-gray-200 p-4 text-left transition-all duration-200 hover:border-green-300 hover:shadow-lg w-full bg-white"><div class="mr-3 text-green-600"><!></div> <div><div class="text-sm font-medium text-gray-900 group-hover:text-green-600"> </div></div></button>'),Es=at('<div class="space-y-3"></div>'),Rs=at('<div class="mt-8 text-center text-gray-500"><svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path></svg> <p class="text-sm">Text functionality coming soon</p></div>'),Ms=at('<div class="border-b border-gray-200 p-6"><h2 class="text-lg font-semibold text-gray-900">Text</h2></div> <div class="flex-1 overflow-y-auto p-6"><!></div>',1),Fs=at('<div class="border-b border-gray-200 p-4"><h2 class="text-lg font-semibold text-gray-800">Other Elements</h2> <p class="text-sm text-gray-500">Additional design elements</p></div> <div class="flex-1 overflow-y-auto p-4"><div class="mt-8 text-center text-gray-500"><div class="mb-4 text-4xl">⚡</div> <p>Other elements coming soon!</p></div></div>',1),Gs=at('<div class="flex w-80 flex-col bg-white border-r border-gray-200 transition-all duration-200 ease-in-out h-full"><!></div>'),Ls=at('<div class="flex h-full"><div class="flex w-20 flex-col bg-gray-50 border-r border-gray-200 h-full"><div class="flex-1 space-y-1 px-2 pt-4"><button><svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg> <span class="text-xs font-medium">Shapes</span></button> <button><svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <span class="text-xs font-medium">Images</span></button> <button><svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path></svg> <span class="text-xs font-medium">Text</span></button></div> <div class="p-2 border-t border-gray-200"><button class="flex w-full flex-col items-center rounded-lg p-3 text-gray-500 transition-all duration-200 hover:bg-red-50 hover:text-red-600"><svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16"></path></svg> <span class="text-xs font-medium">Clear</span></button></div></div> <!></div>');function Ds(i,t){yt(t,!0);let b=mt(null),u=mt(null),g=mt(null);const l=Pt.getByCategory(Mt.Shapes),h=Pt.getByCategory(Mt.Text);Pt.getByCategory(Mt.Images);function a(x){M(b)&&M(u)&&M(g)&&!M(u).contains(x.target)&&!M(g).contains(x.target)&&(nt(b,null),t.close())}function c(x){M(b)===x?(nt(b,null),t.close()):(nt(b,x,!0),t.open({panel:x}))}function r(x){t.elementSelected(x)}function s(x){var T;const P=x.target,L=(T=P.files)==null?void 0:T[0];if(!L)return;if(!L.type.startsWith("image/")){alert("Please select a valid image file.");return}if(L.size>10*1024*1024){alert("File size must be less than 10MB.");return}const A=URL.createObjectURL(L);t.elementSelected("upload",{src:A,originalName:L.name}),P.value=""}Ur(()=>(document.addEventListener("click",a),()=>{document.removeEventListener("click",a)})),X(()=>{t.isOpen||nt(b,null)});var p=Ls(),n=q(p),e=q(n),f=q(e);f.__click=[ys,c];var _=Q(f,2);_.__click=[bs,c];var y=Q(_,2);y.__click=[xs,c],z(e);var k=Q(e,2),d=q(k);d.__click=[ws,t],z(k),z(n),Qt(n,x=>nt(g,x),()=>M(g));var o=Q(n,2);{var m=x=>{var P=Gs(),L=q(P);{var A=S=>{var E=ks(),F=Q(Nt(E),2),v=q(F);de(v,21,()=>l,we,(C,w)=>{var R=Cs();R.__click=[Ss,r,w];var G=q(R),N=q(G);$i(N,()=>M(w).icon),z(G);var I=Q(G,2),O=q(I,!0);z(I),z(R),St(()=>ee(O,M(w).name)),rt(C,R)}),z(v),z(F),rt(S,E)},T=(S,E)=>{{var F=C=>{var w=Ps(),R=Q(Nt(w),2),G=q(R),N=Q(q(G),2);N.__change=s,z(G),$t(2),z(R),rt(C,w)},v=(C,w)=>{{var R=N=>{var I=Ms(),O=Q(Nt(I),2),H=q(O);{var j=W=>{var Z=Es();de(Z,21,()=>h,we,(tt,D)=>{var B=As();B.__click=[Ts,r,D];var V=q(B),K=q(V);$i(K,()=>M(D).icon),z(V);var et=Q(V,2),it=q(et),ht=q(it,!0);z(it),z(et),z(B),St(()=>ee(ht,M(D).name)),rt(tt,B)}),z(Z),rt(W,Z)},U=W=>{var Z=Rs();rt(W,Z)};xt(H,W=>{h.length>0?W(j):W(U,!1)})}z(O),rt(N,I)},G=(N,I)=>{{var O=H=>{var j=Fs();$t(2),rt(H,j)};xt(N,H=>{M(b)==="other"&&H(O)},I)}};xt(C,N=>{M(b)==="text"?N(R):N(G,!1)},w)}};xt(S,C=>{M(b)==="images"?C(F):C(v,!1)},E)}};xt(L,S=>{M(b)==="shapes"?S(A):S(T,!1)})}z(P),Qt(P,S=>nt(u,S),()=>M(u)),rt(x,P)};xt(o,x=>{M(b)&&x(m)})}z(p),St(()=>{ye(f,1,`flex w-full flex-col items-center rounded-lg p-3 transition-all duration-200 ${M(b)==="shapes"?"bg-purple-100 text-purple-600 shadow-sm":"text-gray-500 hover:bg-gray-50 hover:text-gray-700"}`),ye(_,1,`flex w-full flex-col items-center rounded-lg p-3 transition-all duration-200 ${M(b)==="images"?"bg-blue-100 text-blue-600 shadow-sm":"text-gray-500 hover:bg-gray-50 hover:text-gray-700"}`),ye(y,1,`flex w-full flex-col items-center rounded-lg p-3 transition-all duration-200 ${M(b)==="text"?"bg-green-100 text-green-600 shadow-sm":"text-gray-500 hover:bg-gray-50 hover:text-gray-700"}`)}),rt(i,p),bt()}re(["click","change"]);var Ns=at('<div class="flex h-full items-center gap-6 overflow-x-auto"><div class="flex items-center gap-3 flex-shrink-0"><span class="text-purple-600"><!></span></div> <div class="h-6 w-px bg-gray-300 flex-shrink-0"></div> <div class="flex-1 min-w-0"><!></div></div>'),Os=at("<div><!></div>");function Is(i,t){yt(t,!0);function b(h,a){t.selectedElement&&t.onUpdateElement(t.selectedElement.id,{[h]:a})}var u=Os(),g=q(u);{var l=h=>{var a=oe();const c=ft(()=>Pt.getEditPanel(t.selectedElement.type,t.selectedElement.subType));var r=Nt(a);{var s=p=>{var n=Ns(),e=q(n),f=q(e),_=q(f);$i(_,()=>M(c).icon),z(f),z(e);var y=Q(e,4),k=q(y);Wr(k,()=>M(c).component,(d,o)=>{o(d,{get element(){return t.selectedElement},updateProperty:b})}),z(y),z(n),rt(p,n)};xt(r,p=>{M(c)&&p(s)})}rt(h,a)};xt(g,h=>{t.isVisible&&t.selectedElement&&h(l)})}z(u),St(()=>ye(u,1,`h-full bg-gray-50 px-6 py-3 ${t.isVisible&&t.selectedElement?"border-b border-gray-200":""}`)),rt(i,u),bt()}const ke={Fill:"fill",Border:"border",Text:"text"};function Bs(i,t){i.preventDefault(),i.stopPropagation(),nt(t,!M(t))}function Us(i){i.stopPropagation()}function Hs(i,t){const u=i.target.value;(/^#[0-9A-Fa-f]{6}$/.test(u)||u==="transparent")&&t.onUpdate(u)}var Ys=at('<div class="absolute inset-0 bg-gray-200" style="background-image: repeating-conic-gradient(#ccc 0% 25%, transparent 0% 50%) 50% / 4px 4px;"></div> <div class="absolute inset-0 flex items-center justify-center"><span class="text-red-500 text-xs font-bold">∅</span></div>',1),Xs=at('<div class="absolute inset-0"></div>'),Vs=at('<span class="text-red-500 text-xs font-bold">∅</span>'),Ws=at('<div class="absolute inset-0 rounded border-4 bg-transparent pointer-events-none"></div>'),zs=at('<span class="text-red-500 text-xs font-bold">∅</span>'),qs=at('<span class="text-sm font-medium">A</span>'),js=(i,t)=>nt(t,!1),Ks=(i,t)=>t("transparent"),Zs=(i,t,b)=>t(M(b)),Qs=at('<button type="button" class="w-6 h-6 rounded border border-gray-200 hover:scale-110 transition-transform focus:ring-2 focus:ring-purple-500 focus:outline-none"></button>'),Js=(i,t)=>t("transparent"),$s=(i,t)=>t("#000000"),to=(i,t)=>t("#ffffff"),eo=at('<div class="fixed bg-white border border-gray-200 rounded-xl shadow-xl p-4 w-64 z-[9999]"><div class="flex justify-end mb-3"><button type="button" class="text-gray-400 hover:text-gray-600 text-lg leading-none" aria-label="Close color picker">×</button></div> <div class="grid grid-cols-10 gap-1 mb-4"><button type="button" class="w-6 h-6 rounded border border-gray-200 hover:scale-110 transition-transform relative overflow-hidden" aria-label="Transparent"><div class="absolute inset-0 bg-gray-200" style="background-image: repeating-conic-gradient(#ccc 0% 25%, transparent 0% 50%) 50% / 4px 4px;"></div> <div class="absolute inset-0 flex items-center justify-center"><span class="text-red-500 text-xs font-bold">∅</span></div></button> <!></div> <div class="flex items-center gap-2 mb-3"><label class="text-xs text-gray-500 w-8">Hex:</label> <input type="text" class="flex-1 px-2 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-purple-500"/></div> <div class="flex items-center gap-2 pt-2 border-t border-gray-100"><button type="button" class="text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded transition-colors">Clear</button> <button type="button" class="text-xs bg-gray-900 hover:bg-gray-800 text-white px-2 py-1 rounded transition-colors">Black</button> <button type="button" class="text-xs bg-white hover:bg-gray-50 border border-gray-200 px-2 py-1 rounded transition-colors">White</button></div></div>'),io=at('<div class="relative flex items-center gap-2"><button type="button" class="h-8 w-8 rounded border border-gray-300 relative overflow-hidden transition-all hover:scale-105 focus:ring-2 focus:ring-purple-500 focus:outline-none flex items-center justify-center bg-white" aria-label="Choose color"><!></button> <!></div>');function cn(i,t){yt(t,!0);let b=Y(t,"type",19,()=>ke.Fill),u=mt(!1),g,l=mt(void 0);const h=["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff","#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86c7","#0000ff","#9900ff","#ff00ff","#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc","#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"];function a(y){t.onUpdate(y)}function c(){if(!M(l))return{top:"120px",left:"50%"};const y=M(l).getBoundingClientRect();return{top:`${y.bottom+8}px`,left:`${y.left}px`}}X(()=>{if(M(u)){let y=function(d){g&&!g.contains(d.target)&&M(l)&&!M(l).contains(d.target)&&nt(u,!1)};const k=setTimeout(()=>{document.addEventListener("click",y,!0)},100);return()=>{clearTimeout(k),document.removeEventListener("click",y,!0)}}});var r=io(),s=q(r);s.__click=[Bs,u];var p=q(s);{var n=y=>{var k=oe(),d=Nt(k);{var o=x=>{var P=Ys();$t(2),rt(x,P)},m=x=>{var P=Xs();St(()=>Wt(P,`background-color: ${t.value??""};`)),rt(x,P)};xt(d,x=>{t.value==="transparent"||t.value==="#00000000"?x(o):x(m,!1)})}rt(y,k)},e=(y,k)=>{{var d=m=>{var x=oe(),P=Nt(x);{var L=T=>{var S=Vs();rt(T,S)},A=T=>{var S=Ws();St(()=>Wt(S,`border-color: ${t.value??""};`)),rt(T,S)};xt(P,T=>{t.value==="transparent"||t.value==="#00000000"?T(L):T(A,!1)})}rt(m,x)},o=(m,x)=>{{var P=L=>{var A=oe(),T=Nt(A);{var S=F=>{var v=zs();rt(F,v)},E=F=>{var v=qs();St(()=>Wt(v,`color: ${t.value??""};`)),rt(F,v)};xt(T,F=>{t.value==="transparent"||t.value==="#00000000"?F(S):F(E,!1)})}rt(L,A)};xt(m,L=>{b()===ke.Text&&L(P)},x)}};xt(y,m=>{b()===ke.Border?m(d):m(o,!1)},k)}};xt(p,y=>{b()===ke.Fill?y(n):y(e,!1)})}z(s),Qt(s,y=>nt(l,y),()=>M(l));var f=Q(s,2);{var _=y=>{var k=eo();const d=ft(c);k.__click=[Us];var o=q(k),m=q(o);m.__click=[js,u],z(o);var x=Q(o,2),P=q(x);P.__click=[Ks,a];var L=Q(P,2);de(L,17,()=>h,we,(C,w)=>{var R=Qs();R.__click=[Zs,a,w],St(()=>{Wt(R,`background-color: ${M(w)??""}`),Ji(R,"aria-label",`Color ${M(w)??""}`)}),rt(C,R)}),z(x);var A=Q(x,2),T=Q(q(A),2);Lt(T),T.__input=[Hs,t],z(A);var S=Q(A,2),E=q(S);E.__click=[Js,a];var F=Q(E,2);F.__click=[$s,a];var v=Q(F,2);v.__click=[to,a],z(S),z(k),Qt(k,C=>g=C,()=>g),St(()=>{Wt(k,`top: ${M(d).top??""}; left: ${M(d).left??""};`),Te(T,t.value==="transparent"?"":t.value),Ji(T,"placeholder",t.value==="transparent"?"transparent":"#000000")}),rt(y,k)};xt(f,y=>{M(u)&&y(_)})}return z(r),rt(i,r),bt({ColorPickerType:ke})}re(["click","input"]);function no(i,t,b,u,g,l){M(t)>0&&M(b)>0&&(u.onSizeChange(M(t),M(b)),nt(g,!1),nt(l,!1))}function ro(i,t,b,u,g){nt(t,!M(t)),M(t)&&(nt(b,u.currentWidth,!0),nt(g,u.currentHeight,!0))}var ao=(i,t)=>nt(t,!M(t)),so=(i,t,b)=>t(M(b)),oo=at('<button type="button" class="w-full text-left px-2 py-1.5 text-sm hover:bg-gray-50 rounded flex justify-between items-center group"><span> </span> <span class="text-xs text-gray-400 group-hover:text-gray-600"> </span></button>'),lo=at('<div class="border-t border-gray-100"></div>'),ho=at('<div class="p-2"><div class="text-xs font-medium text-gray-500 uppercase tracking-wide mb-1 px-2"> </div> <!></div> <!>',1),co=at('<div class="mt-2 px-2 pb-2"><div class="flex gap-2 items-center"><input type="number" placeholder="Width" min="1" class="w-20 px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"/> <span class="text-xs text-gray-400">×</span> <input type="number" placeholder="Height" min="1" class="w-20 px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-purple-500"/> <button type="button" class="px-2 py-1 text-xs bg-purple-600 text-white rounded hover:bg-purple-700 focus:outline-none focus:ring-1 focus:ring-purple-500">Apply</button></div></div>'),uo=at('<div class="fixed w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-[999999] max-h-96 overflow-y-auto"><!> <div class="border-t border-gray-100 p-2"><button type="button" class="w-full text-left px-2 py-1.5 text-sm hover:bg-gray-50 rounded flex justify-between items-center"><span>Custom Size</span> <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6,9 12,15 18,9"></polyline></svg></button> <!></div></div>'),fo=(i,t,b)=>{nt(t,!1),nt(b,!1)},go=at('<div class="fixed inset-0 z-[999998]"></div>'),vo=at('<div class="relative"><button type="button" class="flex items-center gap-2 px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><path d="M9 9h6v6H9z"></path></svg> <span class="max-w-32 truncate"> </span> <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6,9 12,15 18,9"></polyline></svg></button> <!></div> <!>',1);function po(i,t){yt(t,!0);const b=[{name:"Instagram Post",width:1080,height:1080,category:"Social"},{name:"Instagram Story",width:1080,height:1920,category:"Social"},{name:"Facebook Post",width:1200,height:630,category:"Social"},{name:"Twitter Post",width:1200,height:675,category:"Social"},{name:"LinkedIn Post",width:1200,height:627,category:"Social"},{name:"A4",width:2480,height:3508,category:"Print"},{name:"US Letter",width:2550,height:3300,category:"Print"},{name:"Business Card",width:1050,height:600,category:"Print"},{name:"Poster",width:2400,height:3600,category:"Print"},{name:"Desktop Banner",width:1920,height:1080,category:"Web"},{name:"Mobile Banner",width:320,height:568,category:"Web"},{name:"Square",width:800,height:800,category:"Web"}];let u=mt(!1),g=mt(void 0),l=mt(pi(t.currentWidth)),h=mt(pi(t.currentHeight)),a=mt(!1);const c=ft(()=>()=>{const x=b.find(P=>P.width===t.currentWidth&&P.height===t.currentHeight);return x?x.name:`${t.currentWidth} × ${t.currentHeight}`});X(()=>{nt(l,t.currentWidth,!0),nt(h,t.currentHeight,!0)});function r(x){t.onSizeChange(x.width,x.height),nt(u,!1),nt(a,!1)}const s=ft(()=>()=>{const x={};return b.forEach(P=>{x[P.category]||(x[P.category]=[]),x[P.category].push(P)}),x});var p=vo(),n=Nt(p),e=q(n);e.__click=[ao,u];var f=Q(q(e),2),_=q(f,!0);z(f);var y=Q(f,2);z(e),Qt(e,x=>nt(g,x),()=>M(g));var k=Q(e,2);{var d=x=>{var P=uo();const L=ft(()=>{var C;return(C=M(g))==null?void 0:C.getBoundingClientRect()});var A=q(P);de(A,17,()=>Object.entries(M(s)()),we,(C,w)=>{var R=ft(()=>Va(M(w),2));let G=()=>M(R)[0],N=()=>M(R)[1];var I=ho(),O=Nt(I),H=q(O),j=q(H,!0);z(H);var U=Q(H,2);de(U,17,N,we,(tt,D)=>{var B=oo();B.__click=[so,r,D];var V=q(B),K=q(V,!0);z(V);var et=Q(V,2),it=q(et);z(et),z(B),St(()=>{ee(K,M(D).name),ee(it,`${M(D).width??""} × ${M(D).height??""}`)}),rt(tt,B)}),z(O);var W=Q(O,2);{var Z=tt=>{var D=lo();rt(tt,D)};xt(W,tt=>{G()!=="Web"&&tt(Z)})}St(()=>ee(j,G())),rt(C,I)});var T=Q(A,2),S=q(T);S.__click=[ro,a,l,t,h];var E=Q(q(S),2);z(S);var F=Q(S,2);{var v=C=>{var w=co(),R=q(w),G=q(R);Lt(G);var N=Q(G,4);Lt(N);var I=Q(N,2);I.__click=[no,l,h,t,u,a],z(R),z(w),tn(G,()=>M(l),O=>nt(l,O)),tn(N,()=>M(h),O=>nt(h,O)),rt(C,w)};xt(F,C=>{M(a)&&C(v)})}z(T),z(P),St(()=>{Wt(P,`top: ${M(L)?M(L).bottom+4:0}px; left: ${(M(L)?M(L).left:0)??""}px;`),ye(E,0,`transition-transform ${M(a)?"rotate-180":""}`)}),rt(x,P)};xt(k,x=>{M(u)&&x(d)})}z(n);var o=Q(n,2);{var m=x=>{var P=go();P.__click=[fo,u,a],rt(x,P)};xt(o,x=>{M(u)&&x(m)})}St(x=>{ee(_,x),ye(y,0,`transition-transform ${M(u)?"rotate-180":""}`)},[()=>M(c)()]),rt(i,p),bt()}re(["click"]);var _o=(i,t)=>t.onToggleGrid(!t.showGrid),mo=(i,t)=>t.onUpdateZoom(Math.max(25,t.zoom-25)),yo=(i,t)=>t.onUpdateZoom(+i.target.value),bo=at("<option> </option>"),xo=(i,t)=>t.onUpdateZoom(Math.min(500,t.zoom+25)),wo=at('<div class="flex items-center gap-4"><!> <div class="h-6 w-px bg-gray-200"></div> <!> <div class="h-6 w-px bg-gray-200"></div> <button type="button" title="Toggle grid"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><line x1="8" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="16" y2="21"></line><line x1="3" y1="8" x2="21" y2="8"></line><line x1="3" y1="16" x2="21" y2="16"></line></svg></button> <div class="h-6 w-px bg-gray-200"></div> <div class="flex items-center gap-2"><button type="button" class="flex h-6 w-6 items-center justify-center rounded border border-gray-300 bg-white text-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500" title="Zoom out"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="M21 21l-4.35-4.35"></path><line x1="8" y1="11" x2="14" y2="11"></line></svg></button> <select class="rounded border border-gray-300 px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 w-20"></select> <button type="button" class="flex h-6 w-6 items-center justify-center rounded border border-gray-300 bg-white text-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500" title="Zoom in"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="M21 21l-4.35-4.35"></path><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg></button></div> <div class="h-6 w-px bg-gray-200"></div> <button type="button" class="flex h-8 w-8 items-center justify-center rounded border border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors" title="Fit to window"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg></button></div>');function So(i,t){yt(t,!0);const b=[25,50,75,100,125,150,200,300,400,500],u=ft(()=>b.includes(t.zoom)?b:[...b,t.zoom].sort((f,_)=>f-_));var g=wo(),l=q(g);po(l,{get currentWidth(){return t.canvasWidth},get currentHeight(){return t.canvasHeight},get onSizeChange(){return t.onUpdateCanvasSize}});var h=Q(l,4);cn(h,{get value(){return t.backgroundColor},get onUpdate(){return t.onUpdateBackground}});var a=Q(h,4);a.__click=[_o,t];var c=Q(a,4),r=q(c);r.__click=[mo,t];var s=Q(r,2);Xr(s,()=>t.zoom);var p;s.__change=[yo,t],de(s,21,()=>M(u),we,(f,_)=>{var y=bo(),k={},d=q(y);z(y),St(()=>{k!==(k=M(_))&&(y.value=(y.__value=M(_))??""),ee(d,`${M(_)??""}%`)}),rt(f,y)}),z(s);var n=Q(s,2);n.__click=[xo,t],z(c);var e=Q(c,4);e.__click=function(...f){var _;(_=t.onFitToWindow)==null||_.apply(this,f)},z(g),St(()=>{ye(a,1,`flex h-8 w-8 items-center justify-center rounded border border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors ${t.showGrid?"text-gray-700":"text-gray-400"}`),Ji(a,"aria-pressed",t.showGrid),r.disabled=t.zoom<=25,p!==(p=t.zoom)&&(s.value=(s.__value=t.zoom)??"",Vr(s,t.zoom)),n.disabled=t.zoom>=500}),rt(i,g),bt()}re(["click","change"]);var An=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $r(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Ae={},Bi={},Ui={},Hi={},En;function dt(){return En||(En=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i._registerNode=i.Konva=i.glob=void 0;const t=Math.PI/180;function b(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}i.glob=typeof An<"u"?An:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},i.Konva={_global:i.glob,version:"9.3.20",isBrowser:b(),isUnminified:/param/.test((function(g){}).toString()),dblClickWindow:400,getAngle(g){return i.Konva.angleDeg?g*t:g},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return i.Konva.DD.isDragging},isTransforming(){var g;return(g=i.Konva.Transformer)===null||g===void 0?void 0:g.isTransforming()},isDragReady(){return!!i.Konva.DD.node},releaseCanvasOnDestroy:!0,document:i.glob.document,_injectGlobal(g){i.glob.Konva=g}};const u=g=>{i.Konva[g.prototype.getClassName()]=g};i._registerNode=u,i.Konva._injectGlobal(i.Konva)}(Hi)),Hi}var Rn;function At(){return Rn||(Rn=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Util=i.Transform=void 0;const t=dt();class b{constructor(m=[1,0,0,1,0,0]){this.dirty=!1,this.m=m&&m.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new b(this.m)}copyInto(m){m.m[0]=this.m[0],m.m[1]=this.m[1],m.m[2]=this.m[2],m.m[3]=this.m[3],m.m[4]=this.m[4],m.m[5]=this.m[5]}point(m){const x=this.m;return{x:x[0]*m.x+x[2]*m.y+x[4],y:x[1]*m.x+x[3]*m.y+x[5]}}translate(m,x){return this.m[4]+=this.m[0]*m+this.m[2]*x,this.m[5]+=this.m[1]*m+this.m[3]*x,this}scale(m,x){return this.m[0]*=m,this.m[1]*=m,this.m[2]*=x,this.m[3]*=x,this}rotate(m){const x=Math.cos(m),P=Math.sin(m),L=this.m[0]*x+this.m[2]*P,A=this.m[1]*x+this.m[3]*P,T=this.m[0]*-P+this.m[2]*x,S=this.m[1]*-P+this.m[3]*x;return this.m[0]=L,this.m[1]=A,this.m[2]=T,this.m[3]=S,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(m,x){const P=this.m[0]+this.m[2]*x,L=this.m[1]+this.m[3]*x,A=this.m[2]+this.m[0]*m,T=this.m[3]+this.m[1]*m;return this.m[0]=P,this.m[1]=L,this.m[2]=A,this.m[3]=T,this}multiply(m){const x=this.m[0]*m.m[0]+this.m[2]*m.m[1],P=this.m[1]*m.m[0]+this.m[3]*m.m[1],L=this.m[0]*m.m[2]+this.m[2]*m.m[3],A=this.m[1]*m.m[2]+this.m[3]*m.m[3],T=this.m[0]*m.m[4]+this.m[2]*m.m[5]+this.m[4],S=this.m[1]*m.m[4]+this.m[3]*m.m[5]+this.m[5];return this.m[0]=x,this.m[1]=P,this.m[2]=L,this.m[3]=A,this.m[4]=T,this.m[5]=S,this}invert(){const m=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),x=this.m[3]*m,P=-this.m[1]*m,L=-this.m[2]*m,A=this.m[0]*m,T=m*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),S=m*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=x,this.m[1]=P,this.m[2]=L,this.m[3]=A,this.m[4]=T,this.m[5]=S,this}getMatrix(){return this.m}decompose(){const m=this.m[0],x=this.m[1],P=this.m[2],L=this.m[3],A=this.m[4],T=this.m[5],S=m*L-x*P,E={x:A,y:T,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(m!=0||x!=0){const F=Math.sqrt(m*m+x*x);E.rotation=x>0?Math.acos(m/F):-Math.acos(m/F),E.scaleX=F,E.scaleY=S/F,E.skewX=(m*P+x*L)/S,E.skewY=0}else if(P!=0||L!=0){const F=Math.sqrt(P*P+L*L);E.rotation=Math.PI/2-(L>0?Math.acos(-P/F):-Math.acos(P/F)),E.scaleX=S/F,E.scaleY=F,E.skewX=0,E.skewY=(m*P+x*L)/S}return E.rotation=i.Util._getRotation(E.rotation),E}}i.Transform=b;const u="[object Array]",g="[object Number]",l="[object String]",h="[object Boolean]",a=Math.PI/180,c=180/Math.PI,r="#",s="",p="0",n="Konva warning: ",e="Konva error: ",f="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},y=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let k=[];const d=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)};i.Util={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===u},_isNumber(o){return Object.prototype.toString.call(o)===g&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===l},_isBoolean(o){return Object.prototype.toString.call(o)===h},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const m=o[0];return m==="#"||m==="."||m===m.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){k.push(o),k.length===1&&d(function(){const m=k;k=[],m.forEach(function(x){x()})})},createCanvasElement(){const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,m){const x=i.Util.createImageElement();x.onload=function(){m(x)},x.src=o},_rgbToHex(o,m,x){return((1<<24)+(o<<16)+(m<<8)+x).toString(16).slice(1)},_hexToRgb(o){o=o.replace(r,s);const m=parseInt(o,16);return{r:m>>16&255,g:m>>8&255,b:m&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=p+o;return r+o},getRGB(o){let m;return o in _?(m=_[o],{r:m[0],g:m[1],b:m[2]}):o[0]===r?this._hexToRgb(o.substring(1)):o.substr(0,4)===f?(m=y.exec(o.replace(/ /g,"")),{r:parseInt(m[1],10),g:parseInt(m[2],10),b:parseInt(m[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",i.Util._namedColorToRBA(o)||i.Util._hex3ColorToRGBA(o)||i.Util._hex4ColorToRGBA(o)||i.Util._hex6ColorToRGBA(o)||i.Util._hex8ColorToRGBA(o)||i.Util._rgbColorToRGBA(o)||i.Util._rgbaColorToRGBA(o)||i.Util._hslColorToRGBA(o)},_namedColorToRBA(o){const m=_[o.toLowerCase()];return m?{r:m[0],g:m[1],b:m[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const m=o.split(/ *, */).map(Number);return{r:m[0],g:m[1],b:m[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const m=o.split(/ *, */).map((x,P)=>x.slice(-1)==="%"?P===3?parseInt(x)/100:parseInt(x)/100*255:Number(x));return{r:m[0],g:m[1],b:m[2],a:m[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[m,...x]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),P=Number(x[0])/360,L=Number(x[1])/100,A=Number(x[2])/100;let T,S,E;if(L===0)return E=A*255,{r:Math.round(E),g:Math.round(E),b:Math.round(E),a:1};A<.5?T=A*(1+L):T=A+L-A*L;const F=2*A-T,v=[0,0,0];for(let C=0;C<3;C++)S=P+1/3*-(C-1),S<0&&S++,S>1&&S--,6*S<1?E=F+(T-F)*6*S:2*S<1?E=T:3*S<2?E=F+(T-F)*(2/3-S)*6:E=F,v[C]=E*255;return{r:Math.round(v[0]),g:Math.round(v[1]),b:Math.round(v[2]),a:1}}},haveIntersection(o,m){return!(m.x>o.x+o.width||m.x+m.width<o.x||m.y>o.y+o.height||m.y+m.height<o.y)},cloneObject(o){const m={};for(const x in o)this._isPlainObject(o[x])?m[x]=this.cloneObject(o[x]):this._isArray(o[x])?m[x]=this.cloneArray(o[x]):m[x]=o[x];return m},cloneArray(o){return o.slice(0)},degToRad(o){return o*a},radToDeg(o){return o*c},_degToRad(o){return i.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),i.Util.degToRad(o)},_radToDeg(o){return i.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),i.Util.radToDeg(o)},_getRotation(o){return t.Konva.angleDeg?i.Util.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(e+o)},error(o){console.error(e+o)},warn(o){t.Konva.showWarnings&&console.warn(n+o)},each(o,m){for(const x in o)m(x,o[x])},_inRange(o,m,x){return m<=o&&o<x},_getProjectionToSegment(o,m,x,P,L,A){let T,S,E;const F=(o-x)*(o-x)+(m-P)*(m-P);if(F==0)T=o,S=m,E=(L-x)*(L-x)+(A-P)*(A-P);else{const v=((L-o)*(x-o)+(A-m)*(P-m))/F;v<0?(T=o,S=m,E=(o-L)*(o-L)+(m-A)*(m-A)):v>1?(T=x,S=P,E=(x-L)*(x-L)+(P-A)*(P-A)):(T=o+v*(x-o),S=m+v*(P-m),E=(T-L)*(T-L)+(S-A)*(S-A))}return[T,S,E]},_getProjectionToLine(o,m,x){const P=i.Util.cloneObject(o);let L=Number.MAX_VALUE;return m.forEach(function(A,T){if(!x&&T===m.length-1)return;const S=m[(T+1)%m.length],E=i.Util._getProjectionToSegment(A.x,A.y,S.x,S.y,o.x,o.y),F=E[0],v=E[1],C=E[2];C<L&&(P.x=F,P.y=v,L=C)}),P},_prepareArrayForTween(o,m,x){const P=[],L=[];if(o.length>m.length){const T=m;m=o,o=T}for(let T=0;T<o.length;T+=2)P.push({x:o[T],y:o[T+1]});for(let T=0;T<m.length;T+=2)L.push({x:m[T],y:m[T+1]});const A=[];return L.forEach(function(T){const S=i.Util._getProjectionToLine(T,P,x);A.push(S.x),A.push(S.y)}),A},_prepareToStringify(o){let m;o.visitedByCircularReferenceRemoval=!0;for(const x in o)if(o.hasOwnProperty(x)&&o[x]&&typeof o[x]=="object"){if(m=Object.getOwnPropertyDescriptor(o,x),o[x].visitedByCircularReferenceRemoval||i.Util._isElement(o[x]))if(m.configurable)delete o[x];else return null;else if(i.Util._prepareToStringify(o[x])===null)if(m.configurable)delete o[x];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,m){for(const x in m)o[x]=m[x];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){t.Konva.releaseCanvasOnDestroy&&o.forEach(m=>{m.width=0,m.height=0})},drawRoundedRectPath(o,m,x,P){let L=0,A=0,T=0,S=0;typeof P=="number"?L=A=T=S=Math.min(P,m/2,x/2):(L=Math.min(P[0]||0,m/2,x/2),A=Math.min(P[1]||0,m/2,x/2),S=Math.min(P[2]||0,m/2,x/2),T=Math.min(P[3]||0,m/2,x/2)),o.moveTo(L,0),o.lineTo(m-A,0),o.arc(m-A,A,A,Math.PI*3/2,0,!1),o.lineTo(m,x-S),o.arc(m-S,x-S,S,0,Math.PI/2,!1),o.lineTo(T,x),o.arc(T,x-T,T,Math.PI/2,Math.PI,!1),o.lineTo(0,L),o.arc(L,L,L,Math.PI,Math.PI*3/2,!1)}}}(Ui)),Ui}var Xt={},Mn;function gt(){if(Mn)return Xt;Mn=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.RGBComponent=u,Xt.alphaComponent=g,Xt.getNumberValidator=l,Xt.getNumberOrArrayOfNumbersValidator=h,Xt.getNumberOrAutoValidator=a,Xt.getStringValidator=c,Xt.getStringOrGradientValidator=r,Xt.getFunctionValidator=s,Xt.getNumberArrayValidator=p,Xt.getBooleanValidator=n,Xt.getComponentValidator=e;const i=dt(),t=At();function b(f){return t.Util._isString(f)?'"'+f+'"':Object.prototype.toString.call(f)==="[object Number]"||t.Util._isBoolean(f)?f:Object.prototype.toString.call(f)}function u(f){return f>255?255:f<0?0:Math.round(f)}function g(f){return f>1?1:f<1e-4?1e-4:f}function l(){if(i.Konva.isUnminified)return function(f,_){return t.Util._isNumber(f)||t.Util.warn(b(f)+' is a not valid value for "'+_+'" attribute. The value should be a number.'),f}}function h(f){if(i.Konva.isUnminified)return function(_,y){let k=t.Util._isNumber(_),d=t.Util._isArray(_)&&_.length==f;return!k&&!d&&t.Util.warn(b(_)+' is a not valid value for "'+y+'" attribute. The value should be a number or Array<number>('+f+")"),_}}function a(){if(i.Konva.isUnminified)return function(f,_){var y=t.Util._isNumber(f),k=f==="auto";return y||k||t.Util.warn(b(f)+' is a not valid value for "'+_+'" attribute. The value should be a number or "auto".'),f}}function c(){if(i.Konva.isUnminified)return function(f,_){return t.Util._isString(f)||t.Util.warn(b(f)+' is a not valid value for "'+_+'" attribute. The value should be a string.'),f}}function r(){if(i.Konva.isUnminified)return function(f,_){const y=t.Util._isString(f),k=Object.prototype.toString.call(f)==="[object CanvasGradient]"||f&&f.addColorStop;return y||k||t.Util.warn(b(f)+' is a not valid value for "'+_+'" attribute. The value should be a string or a native gradient.'),f}}function s(){if(i.Konva.isUnminified)return function(f,_){return t.Util._isFunction(f)||t.Util.warn(b(f)+' is a not valid value for "'+_+'" attribute. The value should be a function.'),f}}function p(){if(i.Konva.isUnminified)return function(f,_){const y=Int8Array?Object.getPrototypeOf(Int8Array):null;return y&&f instanceof y||(t.Util._isArray(f)?f.forEach(function(k){t.Util._isNumber(k)||t.Util.warn('"'+_+'" attribute has non numeric element '+k+". Make sure that all elements are numbers.")}):t.Util.warn(b(f)+' is a not valid value for "'+_+'" attribute. The value should be a array of numbers.')),f}}function n(){if(i.Konva.isUnminified)return function(f,_){var y=f===!0||f===!1;return y||t.Util.warn(b(f)+' is a not valid value for "'+_+'" attribute. The value should be a boolean.'),f}}function e(f){if(i.Konva.isUnminified)return function(_,y){return _==null||t.Util.isObject(_)||t.Util.warn(b(_)+' is a not valid value for "'+y+'" attribute. The value should be an object with properties '+f),_}}return Xt}var Fn;function ut(){return Fn||(Fn=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Factory=void 0;const t=At(),b=gt(),u="get",g="set";i.Factory={addGetterSetter(l,h,a,c,r){i.Factory.addGetter(l,h,a),i.Factory.addSetter(l,h,c,r),i.Factory.addOverloadedGetterSetter(l,h)},addGetter(l,h,a){var c=u+t.Util._capitalize(h);l.prototype[c]=l.prototype[c]||function(){const r=this.attrs[h];return r===void 0?a:r}},addSetter(l,h,a,c){var r=g+t.Util._capitalize(h);l.prototype[r]||i.Factory.overWriteSetter(l,h,a,c)},overWriteSetter(l,h,a,c){var r=g+t.Util._capitalize(h);l.prototype[r]=function(s){return a&&s!==void 0&&s!==null&&(s=a.call(this,s,h)),this._setAttr(h,s),c&&c.call(this),this}},addComponentsGetterSetter(l,h,a,c,r){const s=a.length,p=t.Util._capitalize,n=u+p(h),e=g+p(h);l.prototype[n]=function(){const _={};for(let y=0;y<s;y++){const k=a[y];_[k]=this.getAttr(h+p(k))}return _};const f=(0,b.getComponentValidator)(a);l.prototype[e]=function(_){const y=this.attrs[h];c&&(_=c.call(this,_,h)),f&&f.call(this,_,h);for(const k in _)_.hasOwnProperty(k)&&this._setAttr(h+p(k),_[k]);return _||a.forEach(k=>{this._setAttr(h+p(k),void 0)}),this._fireChangeEvent(h,y,_),r&&r.call(this),this},i.Factory.addOverloadedGetterSetter(l,h)},addOverloadedGetterSetter(l,h){var a=t.Util._capitalize(h),c=g+a,r=u+a;l.prototype[h]=function(){return arguments.length?(this[c](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(l,h,a,c){t.Util.error("Adding deprecated "+h);const r=u+t.Util._capitalize(h),s=h+" property is deprecated and will be removed soon. Look at Konva change log for more information.";l.prototype[r]=function(){t.Util.error(s);const p=this.attrs[h];return p===void 0?a:p},i.Factory.addSetter(l,h,c,function(){t.Util.error(s)}),i.Factory.addOverloadedGetterSetter(l,h)},backCompat(l,h){t.Util.each(h,function(a,c){const r=l.prototype[c],s=u+t.Util._capitalize(a),p=g+t.Util._capitalize(a);function n(){r.apply(this,arguments),t.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}l.prototype[a]=n,l.prototype[s]=n,l.prototype[p]=n})},afterSetFilter(){this._filterUpToDate=!1}}}(Bi)),Bi}var Yi={},Ee={},fe={},ge={},Gn;function ta(){if(Gn)return ge;Gn=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.HitContext=ge.SceneContext=ge.Context=void 0;const i=At(),t=dt();function b(k){const d=[],o=k.length,m=i.Util;for(let x=0;x<o;x++){let P=k[x];m._isNumber(P)?P=Math.round(P*1e3)/1e3:m._isString(P)||(P=P+""),d.push(P)}return d}const u=",",g="(",l=")",h="([",a="])",c=";",r="()",s="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],n=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],e=100;let f=class{constructor(d){this.canvas=d,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(d){d.fillEnabled()&&this._fill(d)}_fill(d){}strokeShape(d){d.hasStroke()&&this._stroke(d)}_stroke(d){}fillStrokeShape(d){d.attrs.fillAfterStrokeEnabled?(this.strokeShape(d),this.fillShape(d)):(this.fillShape(d),this.strokeShape(d))}getTrace(d,o){let m=this.traceArr,x=m.length,P="",L,A,T,S;for(L=0;L<x;L++)A=m[L],T=A.method,T?(S=A.args,P+=T,d?P+=r:i.Util._isArray(S[0])?P+=h+S.join(u)+a:(o&&(S=S.map(E=>typeof E=="number"?Math.floor(E):E)),P+=g+S.join(u)+l)):(P+=A.property,d||(P+=s+A.val)),P+=c;return P}clearTrace(){this.traceArr=[]}_trace(d){let o=this.traceArr,m;o.push(d),m=o.length,m>=e&&o.shift()}reset(){const d=this.getCanvas().getPixelRatio();this.setTransform(1*d,0,0,1*d,0,0)}getCanvas(){return this.canvas}clear(d){const o=this.getCanvas();d?this.clearRect(d.x||0,d.y||0,d.width||0,d.height||0):this.clearRect(0,0,o.getWidth()/o.pixelRatio,o.getHeight()/o.pixelRatio)}_applyLineCap(d){const o=d.attrs.lineCap;o&&this.setAttr("lineCap",o)}_applyOpacity(d){const o=d.getAbsoluteOpacity();o!==1&&this.setAttr("globalAlpha",o)}_applyLineJoin(d){const o=d.attrs.lineJoin;o&&this.setAttr("lineJoin",o)}setAttr(d,o){this._context[d]=o}arc(d,o,m,x,P,L){this._context.arc(d,o,m,x,P,L)}arcTo(d,o,m,x,P){this._context.arcTo(d,o,m,x,P)}beginPath(){this._context.beginPath()}bezierCurveTo(d,o,m,x,P,L){this._context.bezierCurveTo(d,o,m,x,P,L)}clearRect(d,o,m,x){this._context.clearRect(d,o,m,x)}clip(...d){this._context.clip.apply(this._context,d)}closePath(){this._context.closePath()}createImageData(d,o){const m=arguments;if(m.length===2)return this._context.createImageData(d,o);if(m.length===1)return this._context.createImageData(d)}createLinearGradient(d,o,m,x){return this._context.createLinearGradient(d,o,m,x)}createPattern(d,o){return this._context.createPattern(d,o)}createRadialGradient(d,o,m,x,P,L){return this._context.createRadialGradient(d,o,m,x,P,L)}drawImage(d,o,m,x,P,L,A,T,S){const E=arguments,F=this._context;E.length===3?F.drawImage(d,o,m):E.length===5?F.drawImage(d,o,m,x,P):E.length===9&&F.drawImage(d,o,m,x,P,L,A,T,S)}ellipse(d,o,m,x,P,L,A,T){this._context.ellipse(d,o,m,x,P,L,A,T)}isPointInPath(d,o,m,x){return m?this._context.isPointInPath(m,d,o,x):this._context.isPointInPath(d,o,x)}fill(...d){this._context.fill.apply(this._context,d)}fillRect(d,o,m,x){this._context.fillRect(d,o,m,x)}strokeRect(d,o,m,x){this._context.strokeRect(d,o,m,x)}fillText(d,o,m,x){x?this._context.fillText(d,o,m,x):this._context.fillText(d,o,m)}measureText(d){return this._context.measureText(d)}getImageData(d,o,m,x){return this._context.getImageData(d,o,m,x)}lineTo(d,o){this._context.lineTo(d,o)}moveTo(d,o){this._context.moveTo(d,o)}rect(d,o,m,x){this._context.rect(d,o,m,x)}roundRect(d,o,m,x,P){this._context.roundRect(d,o,m,x,P)}putImageData(d,o,m){this._context.putImageData(d,o,m)}quadraticCurveTo(d,o,m,x){this._context.quadraticCurveTo(d,o,m,x)}restore(){this._context.restore()}rotate(d){this._context.rotate(d)}save(){this._context.save()}scale(d,o){this._context.scale(d,o)}setLineDash(d){this._context.setLineDash?this._context.setLineDash(d):"mozDash"in this._context?this._context.mozDash=d:"webkitLineDash"in this._context&&(this._context.webkitLineDash=d)}getLineDash(){return this._context.getLineDash()}setTransform(d,o,m,x,P,L){this._context.setTransform(d,o,m,x,P,L)}stroke(d){d?this._context.stroke(d):this._context.stroke()}strokeText(d,o,m,x){this._context.strokeText(d,o,m,x)}transform(d,o,m,x,P,L){this._context.transform(d,o,m,x,P,L)}translate(d,o){this._context.translate(d,o)}_enableTrace(){let d=this,o=p.length,m=this.setAttr,x,P;const L=function(A){let T=d[A],S;d[A]=function(){return P=b(Array.prototype.slice.call(arguments,0)),S=T.apply(d,arguments),d._trace({method:A,args:P}),S}};for(x=0;x<o;x++)L(p[x]);d.setAttr=function(){m.apply(d,arguments);const A=arguments[0];let T=arguments[1];(A==="shadowOffsetX"||A==="shadowOffsetY"||A==="shadowBlur")&&(T=T/this.canvas.getPixelRatio()),d._trace({property:A,val:T})}}_applyGlobalCompositeOperation(d){const o=d.attrs.globalCompositeOperation;!o||o==="source-over"||this.setAttr("globalCompositeOperation",o)}};ge.Context=f,n.forEach(function(k){Object.defineProperty(f.prototype,k,{get(){return this._context[k]},set(d){this._context[k]=d}})});class _ extends f{constructor(d,{willReadFrequently:o=!1}={}){super(d),this._context=d._canvas.getContext("2d",{willReadFrequently:o})}_fillColor(d){const o=d.fill();this.setAttr("fillStyle",o),d._fillFunc(this)}_fillPattern(d){this.setAttr("fillStyle",d._getFillPattern()),d._fillFunc(this)}_fillLinearGradient(d){const o=d._getLinearGradient();o&&(this.setAttr("fillStyle",o),d._fillFunc(this))}_fillRadialGradient(d){const o=d._getRadialGradient();o&&(this.setAttr("fillStyle",o),d._fillFunc(this))}_fill(d){const o=d.fill(),m=d.getFillPriority();if(o&&m==="color"){this._fillColor(d);return}const x=d.getFillPatternImage();if(x&&m==="pattern"){this._fillPattern(d);return}const P=d.getFillLinearGradientColorStops();if(P&&m==="linear-gradient"){this._fillLinearGradient(d);return}const L=d.getFillRadialGradientColorStops();if(L&&m==="radial-gradient"){this._fillRadialGradient(d);return}o?this._fillColor(d):x?this._fillPattern(d):P?this._fillLinearGradient(d):L&&this._fillRadialGradient(d)}_strokeLinearGradient(d){const o=d.getStrokeLinearGradientStartPoint(),m=d.getStrokeLinearGradientEndPoint(),x=d.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(o.x,o.y,m.x,m.y);if(x){for(let L=0;L<x.length;L+=2)P.addColorStop(x[L],x[L+1]);this.setAttr("strokeStyle",P)}}_stroke(d){const o=d.dash(),m=d.getStrokeScaleEnabled();if(d.hasStroke()){if(!m){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(d),o&&d.dashEnabled()&&(this.setLineDash(o),this.setAttr("lineDashOffset",d.dashOffset())),this.setAttr("lineWidth",d.strokeWidth()),d.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),d.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(d):this.setAttr("strokeStyle",d.stroke()),d._strokeFunc(this),m||this.restore()}}_applyShadow(d){var o,m,x;const P=(o=d.getShadowRGBA())!==null&&o!==void 0?o:"black",L=(m=d.getShadowBlur())!==null&&m!==void 0?m:5,A=(x=d.getShadowOffset())!==null&&x!==void 0?x:{x:0,y:0},T=d.getAbsoluteScale(),S=this.canvas.getPixelRatio(),E=T.x*S,F=T.y*S;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",L*Math.min(Math.abs(E),Math.abs(F))),this.setAttr("shadowOffsetX",A.x*E),this.setAttr("shadowOffsetY",A.y*F)}}ge.SceneContext=_;class y extends f{constructor(d){super(d),this._context=d._canvas.getContext("2d",{willReadFrequently:!0})}_fill(d){this.save(),this.setAttr("fillStyle",d.colorKey),d._fillFuncHit(this),this.restore()}strokeShape(d){d.hasHitStroke()&&this._stroke(d)}_stroke(d){if(d.hasHitStroke()){const o=d.getStrokeScaleEnabled();if(!o){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(d);const m=d.hitStrokeWidth(),x=m==="auto"?d.strokeWidth():m;this.setAttr("lineWidth",x),this.setAttr("strokeStyle",d.colorKey),d._strokeFuncHit(this),o||this.restore()}}}return ge.HitContext=y,ge}var Ln;function Ei(){if(Ln)return fe;Ln=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.HitCanvas=fe.SceneCanvas=fe.Canvas=void 0;const i=At(),t=ta(),b=dt();let u;function g(){if(u)return u;const c=i.Util.createCanvasElement(),r=c.getContext("2d");return u=function(){const s=b.Konva._global.devicePixelRatio||1,p=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return s/p}(),i.Util.releaseCanvas(c),u}let l=class{constructor(r){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(r||{}).pixelRatio||b.Konva.pixelRatio||g();this.pixelRatio=p,this._canvas=i.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(r){const s=this.pixelRatio;this.pixelRatio=r,this.setSize(this.getWidth()/s,this.getHeight()/s)}setWidth(r){this.width=this._canvas.width=r*this.pixelRatio,this._canvas.style.width=r+"px";const s=this.pixelRatio;this.getContext()._context.scale(s,s)}setHeight(r){this.height=this._canvas.height=r*this.pixelRatio,this._canvas.style.height=r+"px";const s=this.pixelRatio;this.getContext()._context.scale(s,s)}getWidth(){return this.width}getHeight(){return this.height}setSize(r,s){this.setWidth(r||0),this.setHeight(s||0)}toDataURL(r,s){try{return this._canvas.toDataURL(r,s)}catch{try{return this._canvas.toDataURL()}catch(n){return i.Util.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};fe.Canvas=l;class h extends l{constructor(r={width:0,height:0,willReadFrequently:!1}){super(r),this.context=new t.SceneContext(this,{willReadFrequently:r.willReadFrequently}),this.setSize(r.width,r.height)}}fe.SceneCanvas=h;class a extends l{constructor(r={width:0,height:0}){super(r),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(r.width,r.height)}}return fe.HitCanvas=a,fe}var Xi={},Dn;function dn(){return Dn||(Dn=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.DD=void 0;const t=dt(),b=At();i.DD={get isDragging(){let u=!1;return i.DD._dragElements.forEach(g=>{g.dragStatus==="dragging"&&(u=!0)}),u},justDragged:!1,get node(){let u;return i.DD._dragElements.forEach(g=>{u=g.node}),u},_dragElements:new Map,_drag(u){const g=[];i.DD._dragElements.forEach((l,h)=>{const{node:a}=l,c=a.getStage();c.setPointersPositions(u),l.pointerId===void 0&&(l.pointerId=b.Util._getFirstPointerId(u));const r=c._changedPointerPositions.find(s=>s.id===l.pointerId);if(r){if(l.dragStatus!=="dragging"){const s=a.dragDistance();if(Math.max(Math.abs(r.x-l.startPointerPos.x),Math.abs(r.y-l.startPointerPos.y))<s||(a.startDrag({evt:u}),!a.isDragging()))return}a._setDragPosition(u,l),g.push(a)}}),g.forEach(l=>{l.fire("dragmove",{type:"dragmove",target:l,evt:u},!0)})},_endDragBefore(u){const g=[];i.DD._dragElements.forEach(l=>{const{node:h}=l,a=h.getStage();if(u&&a.setPointersPositions(u),!a._changedPointerPositions.find(s=>s.id===l.pointerId))return;(l.dragStatus==="dragging"||l.dragStatus==="stopped")&&(i.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,l.dragStatus="stopped");const r=l.node.getLayer()||l.node instanceof t.Konva.Stage&&l.node;r&&g.indexOf(r)===-1&&g.push(r)}),g.forEach(l=>{l.draw()})},_endDragAfter(u){i.DD._dragElements.forEach((g,l)=>{g.dragStatus==="stopped"&&g.node.fire("dragend",{type:"dragend",target:g.node,evt:u},!0),g.dragStatus!=="dragging"&&i.DD._dragElements.delete(l)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",i.DD._endDragBefore,!0),window.addEventListener("touchend",i.DD._endDragBefore,!0),window.addEventListener("touchcancel",i.DD._endDragBefore,!0),window.addEventListener("mousemove",i.DD._drag),window.addEventListener("touchmove",i.DD._drag),window.addEventListener("mouseup",i.DD._endDragAfter,!1),window.addEventListener("touchend",i.DD._endDragAfter,!1),window.addEventListener("touchcancel",i.DD._endDragAfter,!1))}(Xi)),Xi}var Nn;function Rt(){if(Nn)return Ee;Nn=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.Node=void 0;const i=At(),t=ut(),b=Ei(),u=dt(),g=dn(),l=gt(),h="absoluteOpacity",a="allEventListeners",c="absoluteTransform",r="absoluteScale",s="canvas",p="Change",n="children",e="konva",f="listening",_="mouseenter",y="mouseleave",k="set",d="Shape",o=" ",m="stage",x="transform",P="Stage",L="visible",A=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(o);let T=1,S=class en{constructor(v){this._id=T++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(v),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(v){(v===x||v===c)&&this._cache.get(v)?this._cache.get(v).dirty=!0:v?this._cache.delete(v):this._cache.clear()}_getCache(v,C){let w=this._cache.get(v);return(w===void 0||(v===x||v===c)&&w.dirty===!0)&&(w=C.call(this),this._cache.set(v,w)),w}_calculate(v,C,w){if(!this._attachedDepsListeners.get(v)){const R=C.map(G=>G+"Change.konva").join(o);this.on(R,()=>{this._clearCache(v)}),this._attachedDepsListeners.set(v,!0)}return this._getCache(v,w)}_getCanvasCache(){return this._cache.get(s)}_clearSelfAndDescendantCache(v){this._clearCache(v),v===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(s)){const{scene:v,filter:C,hit:w}=this._cache.get(s);i.Util.releaseCanvas(v,C,w),this._cache.delete(s)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(v){const C=v||{};let w={};(C.x===void 0||C.y===void 0||C.width===void 0||C.height===void 0)&&(w=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let R=Math.ceil(C.width||w.width),G=Math.ceil(C.height||w.height),N=C.pixelRatio,I=C.x===void 0?Math.floor(w.x):C.x,O=C.y===void 0?Math.floor(w.y):C.y,H=C.offset||0,j=C.drawBorder||!1,U=C.hitCanvasPixelRatio||1;if(!R||!G){i.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const W=Math.abs(Math.round(w.x)-I)>.5?1:0,Z=Math.abs(Math.round(w.y)-O)>.5?1:0;R+=H*2+W,G+=H*2+Z,I-=H,O-=H;const tt=new b.SceneCanvas({pixelRatio:N,width:R,height:G}),D=new b.SceneCanvas({pixelRatio:N,width:0,height:0,willReadFrequently:!0}),B=new b.HitCanvas({pixelRatio:U,width:R,height:G}),V=tt.getContext(),K=B.getContext();return B.isCache=!0,tt.isCache=!0,this._cache.delete(s),this._filterUpToDate=!1,C.imageSmoothingEnabled===!1&&(tt.getContext()._context.imageSmoothingEnabled=!1,D.getContext()._context.imageSmoothingEnabled=!1),V.save(),K.save(),V.translate(-I,-O),K.translate(-I,-O),this._isUnderCache=!0,this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(r),this.drawScene(tt,this),this.drawHit(B,this),this._isUnderCache=!1,V.restore(),K.restore(),j&&(V.save(),V.beginPath(),V.rect(0,0,R,G),V.closePath(),V.setAttr("strokeStyle","red"),V.setAttr("lineWidth",5),V.stroke(),V.restore()),this._cache.set(s,{scene:tt,filter:D,hit:B,x:I,y:O}),this._requestDraw(),this}isCached(){return this._cache.has(s)}getClientRect(v){throw new Error('abstract "getClientRect" method call')}_transformedRect(v,C){const w=[{x:v.x,y:v.y},{x:v.x+v.width,y:v.y},{x:v.x+v.width,y:v.y+v.height},{x:v.x,y:v.y+v.height}];let R=1/0,G=1/0,N=-1/0,I=-1/0;const O=this.getAbsoluteTransform(C);return w.forEach(function(H){const j=O.point(H);R===void 0&&(R=N=j.x,G=I=j.y),R=Math.min(R,j.x),G=Math.min(G,j.y),N=Math.max(N,j.x),I=Math.max(I,j.y)}),{x:R,y:G,width:N-R,height:I-G}}_drawCachedSceneCanvas(v){v.save(),v._applyOpacity(this),v._applyGlobalCompositeOperation(this);const C=this._getCanvasCache();v.translate(C.x,C.y);const w=this._getCachedSceneCanvas(),R=w.pixelRatio;v.drawImage(w._canvas,0,0,w.width/R,w.height/R),v.restore()}_drawCachedHitCanvas(v){const C=this._getCanvasCache(),w=C.hit;v.save(),v.translate(C.x,C.y),v.drawImage(w._canvas,0,0,w.width/w.pixelRatio,w.height/w.pixelRatio),v.restore()}_getCachedSceneCanvas(){let v=this.filters(),C=this._getCanvasCache(),w=C.scene,R=C.filter,G=R.getContext(),N,I,O,H;if(v){if(!this._filterUpToDate){const j=w.pixelRatio;R.setSize(w.width/w.pixelRatio,w.height/w.pixelRatio);try{for(N=v.length,G.clear(),G.drawImage(w._canvas,0,0,w.getWidth()/j,w.getHeight()/j),I=G.getImageData(0,0,R.getWidth(),R.getHeight()),O=0;O<N;O++){if(H=v[O],typeof H!="function"){i.Util.error("Filter should be type of function, but got "+typeof H+" instead. Please check correct filters");continue}H.call(this,I),G.putImageData(I,0,0)}}catch(U){i.Util.error("Unable to apply filter. "+U.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return R}return w}on(v,C){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);let w=v.split(o),R=w.length,G,N,I,O,H;for(G=0;G<R;G++)N=w[G],I=N.split("."),O=I[0],H=I[1]||"",this.eventListeners[O]||(this.eventListeners[O]=[]),this.eventListeners[O].push({name:H,handler:C});return this}off(v,C){let w=(v||"").split(o),R=w.length,G,N,I,O,H,j;if(this._cache&&this._cache.delete(a),!v)for(N in this.eventListeners)this._off(N);for(G=0;G<R;G++)if(I=w[G],O=I.split("."),H=O[0],j=O[1],H)this.eventListeners[H]&&this._off(H,j,C);else for(N in this.eventListeners)this._off(N,j,C);return this}dispatchEvent(v){const C={target:this,type:v.type,evt:v};return this.fire(v.type,C),this}addEventListener(v,C){return this.on(v,function(w){C.call(this,w.evt)}),this}removeEventListener(v){return this.off(v),this}_delegate(v,C,w){const R=this;this.on(v,function(G){const N=G.target.findAncestors(C,!0,R);for(let I=0;I<N.length;I++)G=i.Util.cloneObject(G),G.currentTarget=N[I],w.call(N[I],G)})}remove(){return this.isDragging()&&this.stopDrag(),g.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(r),this._clearSelfAndDescendantCache(m),this._clearSelfAndDescendantCache(L),this._clearSelfAndDescendantCache(f)}_remove(){this._clearCaches();const v=this.getParent();v&&v.children&&(v.children.splice(this.index,1),v._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(v){const C="get"+i.Util._capitalize(v);return i.Util._isFunction(this[C])?this[C]():this.attrs[v]}getAncestors(){let v=this.getParent(),C=[];for(;v;)C.push(v),v=v.getParent();return C}getAttrs(){return this.attrs||{}}setAttrs(v){return this._batchTransformChanges(()=>{let C,w;if(!v)return this;for(C in v)C!==n&&(w=k+i.Util._capitalize(C),i.Util._isFunction(this[w])?this[w](v[C]):this._setAttr(C,v[C]))}),this}isListening(){return this._getCache(f,this._isListening)}_isListening(v){if(!this.listening())return!1;const w=this.getParent();return w&&w!==v&&this!==v?w._isListening(v):!0}isVisible(){return this._getCache(L,this._isVisible)}_isVisible(v){if(!this.visible())return!1;const w=this.getParent();return w&&w!==v&&this!==v?w._isVisible(v):!0}shouldDrawHit(v,C=!1){if(v)return this._isVisible(v)&&this._isListening(v);const w=this.getLayer();let R=!1;g.DD._dragElements.forEach(N=>{N.dragStatus==="dragging"&&(N.node.nodeType==="Stage"||N.node.getLayer()===w)&&(R=!0)});const G=!C&&!u.Konva.hitOnDragEnabled&&(R||u.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!G}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let v=this.getDepth(),C=this,w=0,R,G,N,I;function O(j){for(R=[],G=j.length,N=0;N<G;N++)I=j[N],w++,I.nodeType!==d&&(R=R.concat(I.getChildren().slice())),I._id===C._id&&(N=G);R.length>0&&R[0].getDepth()<=v&&O(R)}const H=this.getStage();return C.nodeType!==P&&H&&O(H.getChildren()),w}getDepth(){let v=0,C=this.parent;for(;C;)v++,C=C.parent;return v}_batchTransformChanges(v){this._batchingTransformChange=!0,v(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(x),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(v){return this._batchTransformChanges(()=>{this.x(v.x),this.y(v.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const v=this.getStage();if(!v)return null;const C=v.getPointerPosition();if(!C)return null;const w=this.getAbsoluteTransform().copy();return w.invert(),w.point(C)}getAbsolutePosition(v){let C=!1,w=this.parent;for(;w;){if(w.isCached()){C=!0;break}w=w.parent}C&&!v&&(v=!0);const R=this.getAbsoluteTransform(v).getMatrix(),G=new i.Transform,N=this.offset();return G.m=R.slice(),G.translate(N.x,N.y),G.getTranslation()}setAbsolutePosition(v){const{x:C,y:w,...R}=this._clearTransform();this.attrs.x=C,this.attrs.y=w,this._clearCache(x);const G=this._getAbsoluteTransform().copy();return G.invert(),G.translate(v.x,v.y),v={x:this.attrs.x+G.getTranslation().x,y:this.attrs.y+G.getTranslation().y},this._setTransform(R),this.setPosition({x:v.x,y:v.y}),this._clearCache(x),this._clearSelfAndDescendantCache(c),this}_setTransform(v){let C;for(C in v)this.attrs[C]=v[C]}_clearTransform(){const v={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,v}move(v){let C=v.x,w=v.y,R=this.x(),G=this.y();return C!==void 0&&(R+=C),w!==void 0&&(G+=w),this.setPosition({x:R,y:G}),this}_eachAncestorReverse(v,C){let w=[],R=this.getParent(),G,N;if(!(C&&C._id===this._id)){for(w.unshift(this);R&&(!C||R._id!==C._id);)w.unshift(R),R=R.parent;for(G=w.length,N=0;N<G;N++)v(w[N])}}rotate(v){return this.rotation(this.rotation()+v),this}moveToTop(){if(!this.parent)return i.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const v=this.index,C=this.parent.getChildren().length;return v<C-1?(this.parent.children.splice(v,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return i.Util.warn("Node has no parent. moveUp function is ignored."),!1;const v=this.index,C=this.parent.getChildren().length;return v<C-1?(this.parent.children.splice(v,1),this.parent.children.splice(v+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return i.Util.warn("Node has no parent. moveDown function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.splice(v-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return i.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(v){if(!this.parent)return i.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(v<0||v>=this.parent.children.length)&&i.Util.warn("Unexpected value "+v+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const C=this.index;return this.parent.children.splice(C,1),this.parent.children.splice(v,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(h,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let v=this.opacity();const C=this.getParent();return C&&!C._isUnderCache&&(v*=C.getAbsoluteOpacity()),v}moveTo(v){return this.getParent()!==v&&(this._remove(),v.add(this)),this}toObject(){let v=this.getAttrs(),C,w,R,G,N;const I={attrs:{},className:this.getClassName()};for(C in v)w=v[C],N=i.Util.isObject(w)&&!i.Util._isPlainObject(w)&&!i.Util._isArray(w),!N&&(R=typeof this[C]=="function"&&this[C],delete v[C],G=R?R.call(this):null,v[C]=w,G!==w&&(I.attrs[C]=w));return i.Util._prepareToStringify(I)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(v,C,w){const R=[];C&&this._isMatch(v)&&R.push(this);let G=this.parent;for(;G;){if(G===w)return R;G._isMatch(v)&&R.push(G),G=G.parent}return R}isAncestorOf(v){return!1}findAncestor(v,C,w){return this.findAncestors(v,C,w)[0]}_isMatch(v){if(!v)return!1;if(typeof v=="function")return v(this);let C=v.replace(/ /g,"").split(","),w=C.length,R,G;for(R=0;R<w;R++)if(G=C[R],i.Util.isValidSelector(G)||(i.Util.warn('Selector "'+G+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),i.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),i.Util.warn("Konva is awesome, right?")),G.charAt(0)==="#"){if(this.id()===G.slice(1))return!0}else if(G.charAt(0)==="."){if(this.hasName(G.slice(1)))return!0}else if(this.className===G||this.nodeType===G)return!0;return!1}getLayer(){const v=this.getParent();return v?v.getLayer():null}getStage(){return this._getCache(m,this._getStage)}_getStage(){const v=this.getParent();return v?v.getStage():null}fire(v,C={},w){return C.target=C.target||this,w?this._fireAndBubble(v,C):this._fire(v,C),this}getAbsoluteTransform(v){return v?this._getAbsoluteTransform(v):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(v){let C;if(v)return C=new i.Transform,this._eachAncestorReverse(function(w){const R=w.transformsEnabled();R==="all"?C.multiply(w.getTransform()):R==="position"&&C.translate(w.x()-w.offsetX(),w.y()-w.offsetY())},v),C;{C=this._cache.get(c)||new i.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(C):C.reset();const w=this.transformsEnabled();if(w==="all")C.multiply(this.getTransform());else if(w==="position"){const R=this.attrs.x||0,G=this.attrs.y||0,N=this.attrs.offsetX||0,I=this.attrs.offsetY||0;C.translate(R-N,G-I)}return C.dirty=!1,C}}getAbsoluteScale(v){let C=this;for(;C;)C._isUnderCache&&(v=C),C=C.getParent();const R=this.getAbsoluteTransform(v).decompose();return{x:R.scaleX,y:R.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(x,this._getTransform)}_getTransform(){var v,C;const w=this._cache.get(x)||new i.Transform;w.reset();const R=this.x(),G=this.y(),N=u.Konva.getAngle(this.rotation()),I=(v=this.attrs.scaleX)!==null&&v!==void 0?v:1,O=(C=this.attrs.scaleY)!==null&&C!==void 0?C:1,H=this.attrs.skewX||0,j=this.attrs.skewY||0,U=this.attrs.offsetX||0,W=this.attrs.offsetY||0;return(R!==0||G!==0)&&w.translate(R,G),N!==0&&w.rotate(N),(H!==0||j!==0)&&w.skew(H,j),(I!==1||O!==1)&&w.scale(I,O),(U!==0||W!==0)&&w.translate(-1*U,-1*W),w.dirty=!1,w}clone(v){let C=i.Util.cloneObject(this.attrs),w,R,G,N,I;for(w in v)C[w]=v[w];const O=new this.constructor(C);for(w in this.eventListeners)for(R=this.eventListeners[w],G=R.length,N=0;N<G;N++)I=R[N],I.name.indexOf(e)<0&&(O.eventListeners[w]||(O.eventListeners[w]=[]),O.eventListeners[w].push(I));return O}_toKonvaCanvas(v){v=v||{};const C=this.getClientRect(),w=this.getStage(),R=v.x!==void 0?v.x:Math.floor(C.x),G=v.y!==void 0?v.y:Math.floor(C.y),N=v.pixelRatio||1,I=new b.SceneCanvas({width:v.width||Math.ceil(C.width)||(w?w.width():0),height:v.height||Math.ceil(C.height)||(w?w.height():0),pixelRatio:N}),O=I.getContext(),H=new b.SceneCanvas({width:I.width/I.pixelRatio+Math.abs(R),height:I.height/I.pixelRatio+Math.abs(G),pixelRatio:I.pixelRatio});return v.imageSmoothingEnabled===!1&&(O._context.imageSmoothingEnabled=!1),O.save(),(R||G)&&O.translate(-1*R,-1*G),this.drawScene(I,void 0,H),O.restore(),I}toCanvas(v){return this._toKonvaCanvas(v)._canvas}toDataURL(v){v=v||{};const C=v.mimeType||null,w=v.quality||null,R=this._toKonvaCanvas(v).toDataURL(C,w);return v.callback&&v.callback(R),R}toImage(v){return new Promise((C,w)=>{try{const R=v==null?void 0:v.callback;R&&delete v.callback,i.Util._urlToImage(this.toDataURL(v),function(G){C(G),R==null||R(G)})}catch(R){w(R)}})}toBlob(v){return new Promise((C,w)=>{try{const R=v==null?void 0:v.callback;R&&delete v.callback,this.toCanvas(v).toBlob(G=>{C(G),R==null||R(G)},v==null?void 0:v.mimeType,v==null?void 0:v.quality)}catch(R){w(R)}})}setSize(v){return this.width(v.width),this.height(v.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():u.Konva.dragDistance}_off(v,C,w){let R=this.eventListeners[v],G,N,I;for(G=0;G<R.length;G++)if(N=R[G].name,I=R[G].handler,(N!=="konva"||C==="konva")&&(!C||N===C)&&(!w||w===I)){if(R.splice(G,1),R.length===0){delete this.eventListeners[v];break}G--}}_fireChangeEvent(v,C,w){this._fire(v+p,{oldVal:C,newVal:w})}addName(v){if(!this.hasName(v)){const C=this.name(),w=C?C+" "+v:v;this.name(w)}return this}hasName(v){if(!v)return!1;const C=this.name();return C?(C||"").split(/\s/g).indexOf(v)!==-1:!1}removeName(v){const C=(this.name()||"").split(/\s/g),w=C.indexOf(v);return w!==-1&&(C.splice(w,1),this.name(C.join(" "))),this}setAttr(v,C){const w=this[k+i.Util._capitalize(v)];return i.Util._isFunction(w)?w.call(this,C):this._setAttr(v,C),this}_requestDraw(){if(u.Konva.autoDrawEnabled){const v=this.getLayer()||this.getStage();v==null||v.batchDraw()}}_setAttr(v,C){const w=this.attrs[v];w===C&&!i.Util.isObject(C)||(C==null?delete this.attrs[v]:this.attrs[v]=C,this._shouldFireChangeEvents&&this._fireChangeEvent(v,w,C),this._requestDraw())}_setComponentAttr(v,C,w){let R;w!==void 0&&(R=this.attrs[v],R||(this.attrs[v]=this.getAttr(v)),this.attrs[v][C]=w,this._fireChangeEvent(v,R,w))}_fireAndBubble(v,C,w){if(C&&this.nodeType===d&&(C.target=this),!((v===_||v===y)&&(w&&(this===w||this.isAncestorOf&&this.isAncestorOf(w))||this.nodeType==="Stage"&&!w))){this._fire(v,C);const G=(v===_||v===y)&&w&&w.isAncestorOf&&w.isAncestorOf(this)&&!w.isAncestorOf(this.parent);(C&&!C.cancelBubble||!C)&&this.parent&&this.parent.isListening()&&!G&&(w&&w.parent?this._fireAndBubble.call(this.parent,v,C,w):this._fireAndBubble.call(this.parent,v,C))}}_getProtoListeners(v){var C,w,R;const G=(C=this._cache.get(a))!==null&&C!==void 0?C:{};let N=G==null?void 0:G[v];if(N===void 0){N=[];let I=Object.getPrototypeOf(this);for(;I;){const O=(R=(w=I.eventListeners)===null||w===void 0?void 0:w[v])!==null&&R!==void 0?R:[];N.push(...O),I=Object.getPrototypeOf(I)}G[v]=N,this._cache.set(a,G)}return N}_fire(v,C){C=C||{},C.currentTarget=this,C.type=v;const w=this._getProtoListeners(v);if(w)for(var R=0;R<w.length;R++)w[R].handler.call(this,C);const G=this.eventListeners[v];if(G)for(var R=0;R<G.length;R++)G[R].handler.call(this,C)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(v){const C=v?v.pointerId:void 0,w=this.getStage(),R=this.getAbsolutePosition();if(!w)return;const G=w._getPointerById(C)||w._changedPointerPositions[0]||R;g.DD._dragElements.set(this._id,{node:this,startPointerPos:G,offset:{x:G.x-R.x,y:G.y-R.y},dragStatus:"ready",pointerId:C})}startDrag(v,C=!0){g.DD._dragElements.has(this._id)||this._createDragElement(v);const w=g.DD._dragElements.get(this._id);w.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:v&&v.evt},C)}_setDragPosition(v,C){const w=this.getStage()._getPointerById(C.pointerId);if(!w)return;let R={x:w.x-C.offset.x,y:w.y-C.offset.y};const G=this.dragBoundFunc();if(G!==void 0){const N=G.call(this,R,v);N?R=N:i.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==R.x||this._lastPos.y!==R.y)&&(this.setAbsolutePosition(R),this._requestDraw()),this._lastPos=R}stopDrag(v){const C=g.DD._dragElements.get(this._id);C&&(C.dragStatus="stopped"),g.DD._endDragBefore(v),g.DD._endDragAfter(v)}setDraggable(v){this._setAttr("draggable",v),this._dragChange()}isDragging(){const v=g.DD._dragElements.get(this._id);return v?v.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(v){if(!(!(v.evt.button!==void 0)||u.Konva.dragButtons.indexOf(v.evt.button)>=0)||this.isDragging())return;let R=!1;g.DD._dragElements.forEach(G=>{this.isAncestorOf(G.node)&&(R=!0)}),R||this._createDragElement(v)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const C=g.DD._dragElements.get(this._id),w=C&&C.dragStatus==="dragging",R=C&&C.dragStatus==="ready";w?this.stopDrag():R&&g.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(v={x:0,y:0}){const C=this.getStage();if(!C)return!1;const w={x:-v.x,y:-v.y,width:C.width()+2*v.x,height:C.height()+2*v.y};return i.Util.haveIntersection(w,this.getClientRect())}static create(v,C){return i.Util._isString(v)&&(v=JSON.parse(v)),this._createNode(v,C)}static _createNode(v,C){let w=en.prototype.getClassName.call(v),R=v.children,G,N,I;C&&(v.attrs.container=C),u.Konva[w]||(i.Util.warn('Can not find a node with class name "'+w+'". Fallback to "Shape".'),w="Shape");const O=u.Konva[w];if(G=new O(v.attrs),R)for(N=R.length,I=0;I<N;I++)G.add(en._createNode(R[I]));return G}};Ee.Node=S,S.prototype.nodeType="Node",S.prototype._attrsAffectingSize=[],S.prototype.eventListeners={},S.prototype.on.call(S.prototype,A,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(x),this._clearSelfAndDescendantCache(c)}),S.prototype.on.call(S.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(L)}),S.prototype.on.call(S.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(f)}),S.prototype.on.call(S.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(h)});const E=t.Factory.addGetterSetter;return E(S,"zIndex"),E(S,"absolutePosition"),E(S,"position"),E(S,"x",0,(0,l.getNumberValidator)()),E(S,"y",0,(0,l.getNumberValidator)()),E(S,"globalCompositeOperation","source-over",(0,l.getStringValidator)()),E(S,"opacity",1,(0,l.getNumberValidator)()),E(S,"name","",(0,l.getStringValidator)()),E(S,"id","",(0,l.getStringValidator)()),E(S,"rotation",0,(0,l.getNumberValidator)()),t.Factory.addComponentsGetterSetter(S,"scale",["x","y"]),E(S,"scaleX",1,(0,l.getNumberValidator)()),E(S,"scaleY",1,(0,l.getNumberValidator)()),t.Factory.addComponentsGetterSetter(S,"skew",["x","y"]),E(S,"skewX",0,(0,l.getNumberValidator)()),E(S,"skewY",0,(0,l.getNumberValidator)()),t.Factory.addComponentsGetterSetter(S,"offset",["x","y"]),E(S,"offsetX",0,(0,l.getNumberValidator)()),E(S,"offsetY",0,(0,l.getNumberValidator)()),E(S,"dragDistance",void 0,(0,l.getNumberValidator)()),E(S,"width",0,(0,l.getNumberValidator)()),E(S,"height",0,(0,l.getNumberValidator)()),E(S,"listening",!0,(0,l.getBooleanValidator)()),E(S,"preventDefault",!0,(0,l.getBooleanValidator)()),E(S,"filters",void 0,function(F){return this._filterUpToDate=!1,F}),E(S,"visible",!0,(0,l.getBooleanValidator)()),E(S,"transformsEnabled","all",(0,l.getStringValidator)()),E(S,"size"),E(S,"dragBoundFunc"),E(S,"draggable",!1,(0,l.getBooleanValidator)()),t.Factory.backCompat(S,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Ee}var pe={},On;function ea(){if(On)return pe;On=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.getCapturedShape=u,pe.createEvent=g,pe.hasPointerCapture=l,pe.setPointerCapture=h,pe.releaseCapture=a;const i=dt(),t=new Map,b=i.Konva._global.PointerEvent!==void 0;function u(c){return t.get(c)}function g(c){return{evt:c,pointerId:c.pointerId}}function l(c,r){return t.get(c)===r}function h(c,r){a(c),r.getStage()&&(t.set(c,r),b&&r._fire("gotpointercapture",g(new PointerEvent("gotpointercapture"))))}function a(c,r){const s=t.get(c);if(!s)return;const p=s.getStage();p&&p.content,t.delete(c),b&&s._fire("lostpointercapture",g(new PointerEvent("lostpointercapture")))}return pe}var In;function Ft(){return In||(In=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Shape=i.shapes=void 0;const t=dt(),b=At(),u=ut(),g=Rt(),l=gt(),h=dt(),a=ea(),c="hasShadow",r="shadowRGBA",s="patternImage",p="linearGradient",n="radialGradient";let e;function f(){return e||(e=b.Util.createCanvasElement().getContext("2d"),e)}i.shapes={};function _(T){const S=this.attrs.fillRule;S?T.fill(S):T.fill()}function y(T){T.stroke()}function k(T){const S=this.attrs.fillRule;S?T.fill(S):T.fill()}function d(T){T.stroke()}function o(){this._clearCache(c)}function m(){this._clearCache(r)}function x(){this._clearCache(s)}function P(){this._clearCache(p)}function L(){this._clearCache(n)}class A extends g.Node{constructor(S){super(S);let E;for(;E=b.Util.getRandomColor(),!(E&&!(E in i.shapes)););this.colorKey=E,i.shapes[E]=this}getContext(){return b.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return b.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(s,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const E=f().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(E&&E.setTransform){const F=new b.Transform;F.translate(this.fillPatternX(),this.fillPatternY()),F.rotate(t.Konva.getAngle(this.fillPatternRotation())),F.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),F.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const v=F.getMatrix(),C=typeof DOMMatrix>"u"?{a:v[0],b:v[1],c:v[2],d:v[3],e:v[4],f:v[5]}:new DOMMatrix(v);E.setTransform(C)}return E}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const S=this.fillLinearGradientColorStops();if(S){const E=f(),F=this.fillLinearGradientStartPoint(),v=this.fillLinearGradientEndPoint(),C=E.createLinearGradient(F.x,F.y,v.x,v.y);for(let w=0;w<S.length;w+=2)C.addColorStop(S[w],S[w+1]);return C}}_getRadialGradient(){return this._getCache(n,this.__getRadialGradient)}__getRadialGradient(){const S=this.fillRadialGradientColorStops();if(S){const E=f(),F=this.fillRadialGradientStartPoint(),v=this.fillRadialGradientEndPoint(),C=E.createRadialGradient(F.x,F.y,this.fillRadialGradientStartRadius(),v.x,v.y,this.fillRadialGradientEndRadius());for(let w=0;w<S.length;w+=2)C.addColorStop(S[w],S[w+1]);return C}}getShadowRGBA(){return this._getCache(r,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const S=b.Util.colorToRGBA(this.shadowColor());if(S)return"rgba("+S.r+","+S.g+","+S.b+","+S.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const S=this.hitStrokeWidth();return S==="auto"?this.hasStroke():this.strokeEnabled()&&!!S}intersects(S){const E=this.getStage();if(!E)return!1;const F=E.bufferHitCanvas;return F.getContext().clear(),this.drawHit(F,void 0,!0),F.context.getImageData(Math.round(S.x),Math.round(S.y),1,1).data[3]>0}destroy(){return g.Node.prototype.destroy.call(this),delete i.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(S){var E;if(!((E=this.attrs.perfectDrawEnabled)!==null&&E!==void 0?E:!0))return!1;const v=S||this.hasFill(),C=this.hasStroke(),w=this.getAbsoluteOpacity()!==1;if(v&&C&&w)return!0;const R=this.hasShadow(),G=this.shadowForStrokeEnabled();return!!(v&&C&&R&&G)}setStrokeHitEnabled(S){b.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),S?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const S=this.size();return{x:this._centroid?-S.width/2:0,y:this._centroid?-S.height/2:0,width:S.width,height:S.height}}getClientRect(S={}){let E=!1,F=this.getParent();for(;F;){if(F.isCached()){E=!0;break}F=F.getParent()}const v=S.skipTransform,C=S.relativeTo||E&&this.getStage()||void 0,w=this.getSelfRect(),G=!S.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,N=w.width+G,I=w.height+G,O=!S.skipShadow&&this.hasShadow(),H=O?this.shadowOffsetX():0,j=O?this.shadowOffsetY():0,U=N+Math.abs(H),W=I+Math.abs(j),Z=O&&this.shadowBlur()||0,tt=U+Z*2,D=W+Z*2,B={width:tt,height:D,x:-(G/2+Z)+Math.min(H,0)+w.x,y:-(G/2+Z)+Math.min(j,0)+w.y};return v?B:this._transformedRect(B,C)}drawScene(S,E,F){const v=this.getLayer();let C=S||v.getCanvas(),w=C.getContext(),R=this._getCanvasCache(),G=this.getSceneFunc(),N=this.hasShadow(),I,O;const H=C.isCache,j=E===this;if(!this.isVisible()&&!j)return this;if(R){w.save();const W=this.getAbsoluteTransform(E).getMatrix();return w.transform(W[0],W[1],W[2],W[3],W[4],W[5]),this._drawCachedSceneCanvas(w),w.restore(),this}if(!G)return this;if(w.save(),this._useBufferCanvas()&&!H){I=this.getStage();const W=F||I.bufferCanvas;O=W.getContext(),O.clear(),O.save(),O._applyLineJoin(this);var U=this.getAbsoluteTransform(E).getMatrix();O.transform(U[0],U[1],U[2],U[3],U[4],U[5]),G.call(this,O,this),O.restore();const Z=W.pixelRatio;N&&w._applyShadow(this),w._applyOpacity(this),w._applyGlobalCompositeOperation(this),w.drawImage(W._canvas,0,0,W.width/Z,W.height/Z)}else{if(w._applyLineJoin(this),!j){var U=this.getAbsoluteTransform(E).getMatrix();w.transform(U[0],U[1],U[2],U[3],U[4],U[5]),w._applyOpacity(this),w._applyGlobalCompositeOperation(this)}N&&w._applyShadow(this),G.call(this,w,this)}return w.restore(),this}drawHit(S,E,F=!1){if(!this.shouldDrawHit(E,F))return this;const v=this.getLayer(),C=S||v.hitCanvas,w=C&&C.getContext(),R=this.hitFunc()||this.sceneFunc(),G=this._getCanvasCache(),N=G&&G.hit;if(this.colorKey||b.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),N){w.save();const O=this.getAbsoluteTransform(E).getMatrix();return w.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedHitCanvas(w),w.restore(),this}if(!R)return this;if(w.save(),w._applyLineJoin(this),!(this===E)){const O=this.getAbsoluteTransform(E).getMatrix();w.transform(O[0],O[1],O[2],O[3],O[4],O[5])}return R.call(this,w,this),w.restore(),this}drawHitFromCache(S=0){const E=this._getCanvasCache(),F=this._getCachedSceneCanvas(),v=E.hit,C=v.getContext(),w=v.getWidth(),R=v.getHeight();C.clear(),C.drawImage(F._canvas,0,0,w,R);try{const G=C.getImageData(0,0,w,R),N=G.data,I=N.length,O=b.Util._hexToRgb(this.colorKey);for(let H=0;H<I;H+=4)N[H+3]>S?(N[H]=O.r,N[H+1]=O.g,N[H+2]=O.b,N[H+3]=255):N[H+3]=0;C.putImageData(G,0,0)}catch(G){b.Util.error("Unable to draw hit graph from cached scene canvas. "+G.message)}return this}hasPointerCapture(S){return a.hasPointerCapture(S,this)}setPointerCapture(S){a.setPointerCapture(S,this)}releaseCapture(S){a.releaseCapture(S,this)}}i.Shape=A,A.prototype._fillFunc=_,A.prototype._strokeFunc=y,A.prototype._fillFuncHit=k,A.prototype._strokeFuncHit=d,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,h._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",o),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",m),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",x),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",L),u.Factory.addGetterSetter(A,"stroke",void 0,(0,l.getStringOrGradientValidator)()),u.Factory.addGetterSetter(A,"strokeWidth",2,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),u.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,l.getNumberOrAutoValidator)()),u.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,l.getBooleanValidator)()),u.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,l.getBooleanValidator)()),u.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,l.getBooleanValidator)()),u.Factory.addGetterSetter(A,"lineJoin"),u.Factory.addGetterSetter(A,"lineCap"),u.Factory.addGetterSetter(A,"sceneFunc"),u.Factory.addGetterSetter(A,"hitFunc"),u.Factory.addGetterSetter(A,"dash"),u.Factory.addGetterSetter(A,"dashOffset",0,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"shadowColor",void 0,(0,l.getStringValidator)()),u.Factory.addGetterSetter(A,"shadowBlur",0,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"shadowOpacity",1,(0,l.getNumberValidator)()),u.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),u.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"fillPatternImage"),u.Factory.addGetterSetter(A,"fill",void 0,(0,l.getStringOrGradientValidator)()),u.Factory.addGetterSetter(A,"fillPatternX",0,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"fillPatternY",0,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),u.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),u.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),u.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),u.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),u.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),u.Factory.addGetterSetter(A,"fillEnabled",!0),u.Factory.addGetterSetter(A,"strokeEnabled",!0),u.Factory.addGetterSetter(A,"shadowEnabled",!0),u.Factory.addGetterSetter(A,"dashEnabled",!0),u.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),u.Factory.addGetterSetter(A,"fillPriority","color"),u.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),u.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,l.getNumberValidator)()),u.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),u.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,l.getNumberValidator)()),u.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,l.getNumberValidator)()),u.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),u.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),u.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),u.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),u.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),u.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),u.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),u.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),u.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),u.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),u.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),u.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),u.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),u.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),u.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),u.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),u.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),u.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),u.Factory.addGetterSetter(A,"fillPatternRotation",0),u.Factory.addGetterSetter(A,"fillRule",void 0,(0,l.getStringValidator)()),u.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(Yi)),Yi}var Bn;function Co(){if(Bn)return Ae;Bn=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.Arc=void 0;const i=ut(),t=Ft(),b=dt(),u=gt(),g=dt();let l=class extends t.Shape{_sceneFunc(a){const c=b.Konva.getAngle(this.angle()),r=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,c,r),a.arc(0,0,this.innerRadius(),c,0,!r),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),c=this.outerRadius(),r=this.clockwise(),s=b.Konva.getAngle(r?360-this.angle():this.angle()),p=Math.cos(Math.min(s,Math.PI)),n=1,e=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),f=Math.sin(Math.min(s,Math.PI/2)),_=p*(p>0?a:c),y=n*c,k=e*(e>0?a:c),d=f*(f>0?c:a);return{x:_,y:r?-1*d:k,width:y-_,height:d-k}}};return Ae.Arc=l,l.prototype._centroid=!0,l.prototype.className="Arc",l.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,g._registerNode)(l),i.Factory.addGetterSetter(l,"innerRadius",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(l,"outerRadius",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(l,"angle",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(l,"clockwise",!1,(0,u.getBooleanValidator)()),Ae}const ko=["mouseover","mouseout","mouseenter","mouseleave","mousemove","mousedown","mouseup","wheel","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerenter","pointerout","pointerleave","pointerclick","pointerdblclick","contextmenu","dragstart","dragmove","dragend","transformstart","transform","transformend"];function ae(i,t){ko.forEach(b=>{const u=i[`on${b}`];typeof u=="function"&&t.on(b,g=>{u(g)})})}const ki=["svelte-konva-stage","svelte-konva-layer","svelte-konva-group","svelte-konva-label"];var _i;(function(i){i[i.Stage=0]="Stage",i[i.Layer=1]="Layer",i[i.Group=2]="Group",i[i.Label=3]="Label"})(_i||(_i={}));const Po="svelte-konva: Component does not have any parent container. Please make sure that the component is wrapped inside a Layer or Group.",To="svelte-konva: A Layer needs to have a Stage as parent.";function ia(i,t){ki.forEach(b=>{kn(b,null)}),kn(ki[i],t)}function ue(){for(let i=1;i<4;i++){const t=Hr(ki[i]);if(t)return t}throw new Error(Po)}function Ao(){const i=Hr(ki[_i.Stage]);if(i)return i;throw new Error(To)}var Re={},Me={},Un;function na(){if(Un)return Me;Un=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.Line=void 0;const i=ut(),t=dt(),b=Ft(),u=gt();function g(a,c,r,s,p,n,e){const f=Math.sqrt(Math.pow(r-a,2)+Math.pow(s-c,2)),_=Math.sqrt(Math.pow(p-r,2)+Math.pow(n-s,2)),y=e*f/(f+_),k=e*_/(f+_),d=r-y*(p-a),o=s-y*(n-c),m=r+k*(p-a),x=s+k*(n-c);return[d,o,m,x]}function l(a,c){const r=a.length,s=[];for(let p=2;p<r-2;p+=2){const n=g(a[p-2],a[p-1],a[p],a[p+1],a[p+2],a[p+3],c);isNaN(n[0])||(s.push(n[0]),s.push(n[1]),s.push(a[p]),s.push(a[p+1]),s.push(n[2]),s.push(n[3]))}return s}let h=class extends b.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){let r=this.points(),s=r.length,p=this.tension(),n=this.closed(),e=this.bezier(),f,_,y;if(s){if(c.beginPath(),c.moveTo(r[0],r[1]),p!==0&&s>4){for(f=this.getTensionPoints(),_=f.length,y=n?0:4,n||c.quadraticCurveTo(f[0],f[1],f[2],f[3]);y<_-2;)c.bezierCurveTo(f[y++],f[y++],f[y++],f[y++],f[y++],f[y++]);n||c.quadraticCurveTo(f[_-2],f[_-1],r[s-2],r[s-1])}else if(e)for(y=2;y<s;)c.bezierCurveTo(r[y++],r[y++],r[y++],r[y++],r[y++],r[y++]);else for(y=2;y<s;y+=2)c.lineTo(r[y],r[y+1]);n?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():l(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),r=c.length,s=this.tension(),p=g(c[r-2],c[r-1],c[0],c[1],c[2],c[3],s),n=g(c[r-4],c[r-3],c[r-2],c[r-1],c[0],c[1],s),e=l(c,s);return[p[2],p[3]].concat(e).concat([n[0],n[1],c[r-2],c[r-1],n[2],n[3],p[0],p[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let r=c[0],s=c[0],p=c[1],n=c[1],e,f;for(let _=0;_<c.length/2;_++)e=c[_*2],f=c[_*2+1],r=Math.min(r,e),s=Math.max(s,e),p=Math.min(p,f),n=Math.max(n,f);return{x:r,y:p,width:s-r,height:n-p}}};return Me.Line=h,h.prototype.className="Line",h.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(h),i.Factory.addGetterSetter(h,"closed",!1),i.Factory.addGetterSetter(h,"bezier",!1),i.Factory.addGetterSetter(h,"tension",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(h,"points",[],(0,u.getNumberArrayValidator)()),Me}var Fe={},Vi={},Hn;function Eo(){return Hn||(Hn=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.t2length=i.getQuadraticArcLength=i.getCubicArcLength=i.binomialCoefficients=i.cValues=i.tValues=void 0,i.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],i.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],i.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(h,a,c)=>{let r,s;const n=c/2;r=0;for(let e=0;e<20;e++)s=n*i.tValues[20][e]+n,r+=i.cValues[20][e]*u(h,a,s);return n*r};i.getCubicArcLength=t;const b=(h,a,c)=>{c===void 0&&(c=1);const r=h[0]-2*h[1]+h[2],s=a[0]-2*a[1]+a[2],p=2*h[1]-2*h[0],n=2*a[1]-2*a[0],e=4*(r*r+s*s),f=4*(r*p+s*n),_=p*p+n*n;if(e===0)return c*Math.sqrt(Math.pow(h[2]-h[0],2)+Math.pow(a[2]-a[0],2));const y=f/(2*e),k=_/e,d=c+y,o=k-y*y,m=d*d+o>0?Math.sqrt(d*d+o):0,x=y*y+o>0?Math.sqrt(y*y+o):0,P=y+Math.sqrt(y*y+o)!==0?o*Math.log(Math.abs((d+m)/(y+x))):0;return Math.sqrt(e)/2*(d*m-y*x+P)};i.getQuadraticArcLength=b;function u(h,a,c){const r=g(1,c,h),s=g(1,c,a),p=r*r+s*s;return Math.sqrt(p)}const g=(h,a,c)=>{const r=c.length-1;let s,p;if(r===0)return 0;if(h===0){p=0;for(let n=0;n<=r;n++)p+=i.binomialCoefficients[r][n]*Math.pow(1-a,r-n)*Math.pow(a,n)*c[n];return p}else{s=new Array(r);for(let n=0;n<r;n++)s[n]=r*(c[n+1]-c[n]);return g(h-1,a,s)}},l=(h,a,c)=>{let r=1,s=h/a,p=(h-c(s))/a,n=0;for(;r>.001;){const e=c(s+p),f=Math.abs(h-e)/a;if(f<r)r=f,s+=p;else{const _=c(s-p),y=Math.abs(h-_)/a;y<r?(r=y,s-=p):p/=2}if(n++,n>500)break}return s};i.t2length=l}(Vi)),Vi}var Yn;function un(){if(Yn)return Fe;Yn=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.Path=void 0;const i=ut(),t=Ft(),b=dt(),u=Eo();let g=class Vt extends t.Shape{constructor(h){super(h),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Vt.parsePathData(this.data()),this.pathLength=Vt.getPathLength(this.dataArray)}_sceneFunc(h){const a=this.dataArray;h.beginPath();let c=!1;for(let m=0;m<a.length;m++){const x=a[m].command,P=a[m].points;switch(x){case"L":h.lineTo(P[0],P[1]);break;case"M":h.moveTo(P[0],P[1]);break;case"C":h.bezierCurveTo(P[0],P[1],P[2],P[3],P[4],P[5]);break;case"Q":h.quadraticCurveTo(P[0],P[1],P[2],P[3]);break;case"A":var r=P[0],s=P[1],p=P[2],n=P[3],e=P[4],f=P[5],_=P[6],y=P[7],k=p>n?p:n,d=p>n?1:p/n,o=p>n?n/p:1;h.translate(r,s),h.rotate(_),h.scale(d,o),h.arc(0,0,k,e,e+f,1-y),h.scale(1/d,1/o),h.rotate(-_),h.translate(-r,-s);break;case"z":c=!0,h.closePath();break}}!c&&!this.hasFill()?h.strokeShape(this):h.fillStrokeShape(this)}getSelfRect(){let h=[];this.dataArray.forEach(function(e){if(e.command==="A"){const f=e.points[4],_=e.points[5],y=e.points[4]+_;let k=Math.PI/180;if(Math.abs(f-y)<k&&(k=Math.abs(f-y)),_<0)for(let d=f-k;d>y;d-=k){const o=Vt.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],d,0);h.push(o.x,o.y)}else for(let d=f+k;d<y;d+=k){const o=Vt.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],d,0);h.push(o.x,o.y)}}else if(e.command==="C")for(let f=0;f<=1;f+=.01){const _=Vt.getPointOnCubicBezier(f,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);h.push(_.x,_.y)}else h=h.concat(e.points)});let a=h[0],c=h[0],r=h[1],s=h[1],p,n;for(let e=0;e<h.length/2;e++)p=h[e*2],n=h[e*2+1],isNaN(p)||(a=Math.min(a,p),c=Math.max(c,p)),isNaN(n)||(r=Math.min(r,n),s=Math.max(s,n));return{x:a,y:r,width:c-a,height:s-r}}getLength(){return this.pathLength}getPointAtLength(h){return Vt.getPointAtLengthOfDataArray(h,this.dataArray)}static getLineLength(h,a,c,r){return Math.sqrt((c-h)*(c-h)+(r-a)*(r-a))}static getPathLength(h){let a=0;for(let c=0;c<h.length;++c)a+=h[c].pathLength;return a}static getPointAtLengthOfDataArray(h,a){let c,r=0,s=a.length;if(!s)return null;for(;r<s&&h>a[r].pathLength;)h-=a[r].pathLength,++r;if(r===s)return c=a[r-1].points.slice(-2),{x:c[0],y:c[1]};if(h<.01)return c=a[r].points.slice(0,2),{x:c[0],y:c[1]};const p=a[r],n=p.points;switch(p.command){case"L":return Vt.getPointOnLine(h,p.start.x,p.start.y,n[0],n[1]);case"C":return Vt.getPointOnCubicBezier((0,u.t2length)(h,Vt.getPathLength(a),m=>(0,u.getCubicArcLength)([p.start.x,n[0],n[2],n[4]],[p.start.y,n[1],n[3],n[5]],m)),p.start.x,p.start.y,n[0],n[1],n[2],n[3],n[4],n[5]);case"Q":return Vt.getPointOnQuadraticBezier((0,u.t2length)(h,Vt.getPathLength(a),m=>(0,u.getQuadraticArcLength)([p.start.x,n[0],n[2]],[p.start.y,n[1],n[3]],m)),p.start.x,p.start.y,n[0],n[1],n[2],n[3]);case"A":var e=n[0],f=n[1],_=n[2],y=n[3],k=n[4],d=n[5],o=n[6];return k+=d*h/p.pathLength,Vt.getPointOnEllipticalArc(e,f,_,y,k,o)}return null}static getPointOnLine(h,a,c,r,s,p,n){p=p??a,n=n??c;const e=this.getLineLength(a,c,r,s);if(e<1e-10)return{x:a,y:c};if(r===a)return{x:p,y:n+(s>c?h:-h)};const f=(s-c)/(r-a),_=Math.sqrt(h*h/(1+f*f))*(r<a?-1:1),y=f*_;if(Math.abs(n-c-f*(p-a))<1e-10)return{x:p+_,y:n+y};const k=((p-a)*(r-a)+(n-c)*(s-c))/(e*e),d=a+k*(r-a),o=c+k*(s-c),m=this.getLineLength(p,n,d,o),x=Math.sqrt(h*h-m*m),P=Math.sqrt(x*x/(1+f*f))*(r<a?-1:1),L=f*P;return{x:d+P,y:o+L}}static getPointOnCubicBezier(h,a,c,r,s,p,n,e,f){function _(x){return x*x*x}function y(x){return 3*x*x*(1-x)}function k(x){return 3*x*(1-x)*(1-x)}function d(x){return(1-x)*(1-x)*(1-x)}const o=e*_(h)+p*y(h)+r*k(h)+a*d(h),m=f*_(h)+n*y(h)+s*k(h)+c*d(h);return{x:o,y:m}}static getPointOnQuadraticBezier(h,a,c,r,s,p,n){function e(d){return d*d}function f(d){return 2*d*(1-d)}function _(d){return(1-d)*(1-d)}const y=p*e(h)+r*f(h)+a*_(h),k=n*e(h)+s*f(h)+c*_(h);return{x:y,y:k}}static getPointOnEllipticalArc(h,a,c,r,s,p){const n=Math.cos(p),e=Math.sin(p),f={x:c*Math.cos(s),y:r*Math.sin(s)};return{x:h+(f.x*n-f.y*e),y:a+(f.x*e+f.y*n)}}static parsePathData(h){if(!h)return[];let a=h;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(var r=0;r<c.length;r++)a=a.replace(new RegExp(c[r],"g"),"|"+c[r]);const s=a.split("|"),p=[],n=[];let e=0,f=0;const _=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let y;for(r=1;r<s.length;r++){let v=s[r],C=v.charAt(0);for(v=v.slice(1),n.length=0;y=_.exec(v);)n.push(y[0]);const w=[];for(let R=0,G=n.length;R<G;R++){if(n[R]==="00"){w.push(0,0);continue}const N=parseFloat(n[R]);isNaN(N)?w.push(0):w.push(N)}for(;w.length>0&&!isNaN(w[0]);){let R="",G=[];const N=e,I=f;var k,d,o,m,x,P,L,A,T,S;switch(C){case"l":e+=w.shift(),f+=w.shift(),R="L",G.push(e,f);break;case"L":e=w.shift(),f=w.shift(),G.push(e,f);break;case"m":var E=w.shift(),F=w.shift();if(e+=E,f+=F,R="M",p.length>2&&p[p.length-1].command==="z"){for(let O=p.length-2;O>=0;O--)if(p[O].command==="M"){e=p[O].points[0]+E,f=p[O].points[1]+F;break}}G.push(e,f),C="l";break;case"M":e=w.shift(),f=w.shift(),R="M",G.push(e,f),C="L";break;case"h":e+=w.shift(),R="L",G.push(e,f);break;case"H":e=w.shift(),R="L",G.push(e,f);break;case"v":f+=w.shift(),R="L",G.push(e,f);break;case"V":f=w.shift(),R="L",G.push(e,f);break;case"C":G.push(w.shift(),w.shift(),w.shift(),w.shift()),e=w.shift(),f=w.shift(),G.push(e,f);break;case"c":G.push(e+w.shift(),f+w.shift(),e+w.shift(),f+w.shift()),e+=w.shift(),f+=w.shift(),R="C",G.push(e,f);break;case"S":d=e,o=f,k=p[p.length-1],k.command==="C"&&(d=e+(e-k.points[2]),o=f+(f-k.points[3])),G.push(d,o,w.shift(),w.shift()),e=w.shift(),f=w.shift(),R="C",G.push(e,f);break;case"s":d=e,o=f,k=p[p.length-1],k.command==="C"&&(d=e+(e-k.points[2]),o=f+(f-k.points[3])),G.push(d,o,e+w.shift(),f+w.shift()),e+=w.shift(),f+=w.shift(),R="C",G.push(e,f);break;case"Q":G.push(w.shift(),w.shift()),e=w.shift(),f=w.shift(),G.push(e,f);break;case"q":G.push(e+w.shift(),f+w.shift()),e+=w.shift(),f+=w.shift(),R="Q",G.push(e,f);break;case"T":d=e,o=f,k=p[p.length-1],k.command==="Q"&&(d=e+(e-k.points[0]),o=f+(f-k.points[1])),e=w.shift(),f=w.shift(),R="Q",G.push(d,o,e,f);break;case"t":d=e,o=f,k=p[p.length-1],k.command==="Q"&&(d=e+(e-k.points[0]),o=f+(f-k.points[1])),e+=w.shift(),f+=w.shift(),R="Q",G.push(d,o,e,f);break;case"A":m=w.shift(),x=w.shift(),P=w.shift(),L=w.shift(),A=w.shift(),T=e,S=f,e=w.shift(),f=w.shift(),R="A",G=this.convertEndpointToCenterParameterization(T,S,e,f,L,A,m,x,P);break;case"a":m=w.shift(),x=w.shift(),P=w.shift(),L=w.shift(),A=w.shift(),T=e,S=f,e+=w.shift(),f+=w.shift(),R="A",G=this.convertEndpointToCenterParameterization(T,S,e,f,L,A,m,x,P);break}p.push({command:R||C,points:G,start:{x:N,y:I},pathLength:this.calcLength(N,I,R||C,G)})}(C==="z"||C==="Z")&&p.push({command:"z",points:[],start:void 0,pathLength:0})}return p}static calcLength(h,a,c,r){let s,p,n,e;const f=Vt;switch(c){case"L":return f.getLineLength(h,a,r[0],r[1]);case"C":return(0,u.getCubicArcLength)([h,r[0],r[2],r[4]],[a,r[1],r[3],r[5]],1);case"Q":return(0,u.getQuadraticArcLength)([h,r[0],r[2]],[a,r[1],r[3]],1);case"A":s=0;var _=r[4],y=r[5],k=r[4]+y,d=Math.PI/180;if(Math.abs(_-k)<d&&(d=Math.abs(_-k)),p=f.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],_,0),y<0)for(e=_-d;e>k;e-=d)n=f.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],e,0),s+=f.getLineLength(p.x,p.y,n.x,n.y),p=n;else for(e=_+d;e<k;e+=d)n=f.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],e,0),s+=f.getLineLength(p.x,p.y,n.x,n.y),p=n;return n=f.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],k,0),s+=f.getLineLength(p.x,p.y,n.x,n.y),s}return 0}static convertEndpointToCenterParameterization(h,a,c,r,s,p,n,e,f){const _=f*(Math.PI/180),y=Math.cos(_)*(h-c)/2+Math.sin(_)*(a-r)/2,k=-1*Math.sin(_)*(h-c)/2+Math.cos(_)*(a-r)/2,d=y*y/(n*n)+k*k/(e*e);d>1&&(n*=Math.sqrt(d),e*=Math.sqrt(d));let o=Math.sqrt((n*n*(e*e)-n*n*(k*k)-e*e*(y*y))/(n*n*(k*k)+e*e*(y*y)));s===p&&(o*=-1),isNaN(o)&&(o=0);const m=o*n*k/e,x=o*-e*y/n,P=(h+c)/2+Math.cos(_)*m-Math.sin(_)*x,L=(a+r)/2+Math.sin(_)*m+Math.cos(_)*x,A=function(w){return Math.sqrt(w[0]*w[0]+w[1]*w[1])},T=function(w,R){return(w[0]*R[0]+w[1]*R[1])/(A(w)*A(R))},S=function(w,R){return(w[0]*R[1]<w[1]*R[0]?-1:1)*Math.acos(T(w,R))},E=S([1,0],[(y-m)/n,(k-x)/e]),F=[(y-m)/n,(k-x)/e],v=[(-1*y-m)/n,(-1*k-x)/e];let C=S(F,v);return T(F,v)<=-1&&(C=Math.PI),T(F,v)>=1&&(C=0),p===0&&C>0&&(C=C-2*Math.PI),p===1&&C<0&&(C=C+2*Math.PI),[P,L,n,e,E,C,_,p]}};return Fe.Path=g,g.prototype.className="Path",g.prototype._attrsAffectingSize=["data"],(0,b._registerNode)(g),i.Factory.addGetterSetter(g,"data"),Fe}var Xn;function ra(){if(Xn)return Re;Xn=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.Arrow=void 0;const i=ut(),t=na(),b=gt(),u=dt(),g=un();class l extends t.Line{_sceneFunc(a){super._sceneFunc(a);const c=Math.PI*2,r=this.points();let s=r;const p=this.tension()!==0&&r.length>4;p&&(s=this.getTensionPoints());const n=this.pointerLength(),e=r.length;let f,_;if(p){const d=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],r[e-2],r[e-1]],o=g.Path.calcLength(s[s.length-4],s[s.length-3],"C",d),m=g.Path.getPointOnQuadraticBezier(Math.min(1,1-n/o),d[0],d[1],d[2],d[3],d[4],d[5]);f=r[e-2]-m.x,_=r[e-1]-m.y}else f=r[e-2]-r[e-4],_=r[e-1]-r[e-3];const y=(Math.atan2(_,f)+c)%c,k=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(r[e-2],r[e-1]),a.rotate(y),a.moveTo(0,0),a.lineTo(-n,k/2),a.lineTo(-n,-k/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(r[0],r[1]),p?(f=(s[0]+s[2])/2-r[0],_=(s[1]+s[3])/2-r[1]):(f=r[2]-r[0],_=r[3]-r[1]),a.rotate((Math.atan2(-_,-f)+c)%c),a.moveTo(0,0),a.lineTo(-n,k/2),a.lineTo(-n,-k/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),c=this.pointerWidth()/2;return{x:a.x,y:a.y-c,width:a.width,height:a.height+c*2}}}return Re.Arrow=l,l.prototype.className="Arrow",(0,u._registerNode)(l),i.Factory.addGetterSetter(l,"pointerLength",10,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(l,"pointerWidth",10,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(l,"pointerAtBeginning",!1),i.Factory.addGetterSetter(l,"pointerAtEnding",!0),Re}var Ro=ra();function aa(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Ro.Arrow({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var Ge={},Vn;function sa(){if(Vn)return Ge;Vn=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.Circle=void 0;const i=ut(),t=Ft(),b=gt(),u=dt();class g extends t.Shape{_sceneFunc(h){h.beginPath(),h.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),h.closePath(),h.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(h){this.radius()!==h/2&&this.radius(h/2)}setHeight(h){this.radius()!==h/2&&this.radius(h/2)}}return Ge.Circle=g,g.prototype._centroid=!0,g.prototype.className="Circle",g.prototype._attrsAffectingSize=["radius"],(0,u._registerNode)(g),i.Factory.addGetterSetter(g,"radius",0,(0,b.getNumberValidator)()),Ge}var Mo=sa();function oa(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Mo.Circle({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var Le={},Wn;function la(){if(Wn)return Le;Wn=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.Ellipse=void 0;const i=ut(),t=Ft(),b=gt(),u=dt();class g extends t.Shape{_sceneFunc(h){const a=this.radiusX(),c=this.radiusY();h.beginPath(),h.save(),a!==c&&h.scale(1,c/a),h.arc(0,0,a,0,Math.PI*2,!1),h.restore(),h.closePath(),h.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(h){this.radiusX(h/2)}setHeight(h){this.radiusY(h/2)}}return Le.Ellipse=g,g.prototype.className="Ellipse",g.prototype._centroid=!0,g.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,u._registerNode)(g),i.Factory.addComponentsGetterSetter(g,"radius",["x","y"]),i.Factory.addGetterSetter(g,"radiusX",0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(g,"radiusY",0,(0,b.getNumberValidator)()),Le}var Fo=la();function ha(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Fo.Ellipse({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var xi={exports:{}},Wi={},De={},zn;function Ri(){if(zn)return De;zn=1,Object.defineProperty(De,"__esModule",{value:!0}),De.Container=void 0;const i=ut(),t=Rt(),b=gt();let u=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(l){if(!l)return this.children||[];const h=this.children||[],a=[];return h.forEach(function(c){l(c)&&a.push(c)}),a}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(l=>{l.parent=null,l.index=0,l.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(l=>{l.parent=null,l.index=0,l.destroy()}),this.children=[],this._requestDraw(),this}add(...l){if(l.length===0)return this;if(l.length>1){for(let a=0;a<l.length;a++)this.add(l[a]);return this}const h=l[0];return h.getParent()?(h.moveTo(this),this):(this._validateAdd(h),h.index=this.getChildren().length,h.parent=this,h._clearCaches(),this.getChildren().push(h),this._fire("add",{child:h}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(l){return this._generalFind(l,!1)}findOne(l){const h=this._generalFind(l,!0);return h.length>0?h[0]:void 0}_generalFind(l,h){const a=[];return this._descendants(c=>{const r=c._isMatch(l);return r&&a.push(c),!!(r&&h)}),a}_descendants(l){let h=!1;const a=this.getChildren();for(const c of a){if(h=l(c),h)return!0;if(c.hasChildren()&&(h=c._descendants(l),h))return!0}return!1}toObject(){const l=t.Node.prototype.toObject.call(this);return l.children=[],this.getChildren().forEach(h=>{l.children.push(h.toObject())}),l}isAncestorOf(l){let h=l.getParent();for(;h;){if(h._id===this._id)return!0;h=h.getParent()}return!1}clone(l){const h=t.Node.prototype.clone.call(this,l);return this.getChildren().forEach(function(a){h.add(a.clone())}),h}getAllIntersections(l){const h=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(l)&&h.push(a)}),h}_clearSelfAndDescendantCache(l){var h;super._clearSelfAndDescendantCache(l),!this.isCached()&&((h=this.children)===null||h===void 0||h.forEach(function(a){a._clearSelfAndDescendantCache(l)}))}_setChildrenIndices(){var l;(l=this.children)===null||l===void 0||l.forEach(function(h,a){h.index=a}),this._requestDraw()}drawScene(l,h,a){const c=this.getLayer(),r=l||c&&c.getCanvas(),s=r&&r.getContext(),p=this._getCanvasCache(),n=p&&p.scene,e=r&&r.isCache;if(!this.isVisible()&&!e)return this;if(n){s.save();const f=this.getAbsoluteTransform(h).getMatrix();s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",r,h,a);return this}drawHit(l,h){if(!this.shouldDrawHit(h))return this;const a=this.getLayer(),c=l||a&&a.hitCanvas,r=c&&c.getContext(),s=this._getCanvasCache();if(s&&s.hit){r.save();const n=this.getAbsoluteTransform(h).getMatrix();r.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",c,h);return this}_drawChildren(l,h,a,c){var r;const s=h&&h.getContext(),p=this.clipWidth(),n=this.clipHeight(),e=this.clipFunc(),f=typeof p=="number"&&typeof n=="number"||e,_=a===this;if(f){s.save();const k=this.getAbsoluteTransform(a);let d=k.getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.beginPath();let o;if(e)o=e.call(this,s,this);else{const m=this.clipX(),x=this.clipY();s.rect(m||0,x||0,p,n)}s.clip.apply(s,o),d=k.copy().invert().getMatrix(),s.transform(d[0],d[1],d[2],d[3],d[4],d[5])}const y=!_&&this.globalCompositeOperation()!=="source-over"&&l==="drawScene";y&&(s.save(),s._applyGlobalCompositeOperation(this)),(r=this.children)===null||r===void 0||r.forEach(function(k){k[l](h,a,c)}),y&&s.restore(),f&&s.restore()}getClientRect(l={}){var h;const a=l.skipTransform,c=l.relativeTo;let r,s,p,n,e={x:1/0,y:1/0,width:0,height:0};const f=this;(h=this.children)===null||h===void 0||h.forEach(function(k){if(!k.visible())return;const d=k.getClientRect({relativeTo:f,skipShadow:l.skipShadow,skipStroke:l.skipStroke});d.width===0&&d.height===0||(r===void 0?(r=d.x,s=d.y,p=d.x+d.width,n=d.y+d.height):(r=Math.min(r,d.x),s=Math.min(s,d.y),p=Math.max(p,d.x+d.width),n=Math.max(n,d.y+d.height)))});const _=this.find("Shape");let y=!1;for(let k=0;k<_.length;k++)if(_[k]._isVisible(this)){y=!0;break}return y&&r!==void 0?e={x:r,y:s,width:p-r,height:n-s}:e={x:0,y:0,width:0,height:0},a?e:this._transformedRect(e,c)}};return De.Container=u,i.Factory.addComponentsGetterSetter(u,"clip",["x","y","width","height"]),i.Factory.addGetterSetter(u,"clipX",void 0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(u,"clipY",void 0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(u,"clipWidth",void 0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(u,"clipHeight",void 0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(u,"clipFunc"),De}var zi={},qn;function ca(){return qn||(qn=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Stage=i.stages=void 0;const t=At(),b=ut(),u=Ri(),g=dt(),l=Ei(),h=dn(),a=dt(),c=ea(),r="Stage",s="string",p="px",n="mouseout",e="mouseleave",f="mouseover",_="mouseenter",y="mousemove",k="mousedown",d="mouseup",o="pointermove",m="pointerdown",x="pointerup",P="pointercancel",L="lostpointercapture",A="pointerout",T="pointerleave",S="pointerover",E="pointerenter",F="contextmenu",v="touchstart",C="touchend",w="touchmove",R="touchcancel",G="wheel",N=5,I=[[_,"_pointerenter"],[k,"_pointerdown"],[y,"_pointermove"],[d,"_pointerup"],[e,"_pointerleave"],[v,"_pointerdown"],[w,"_pointermove"],[C,"_pointerup"],[R,"_pointercancel"],[f,"_pointerover"],[G,"_wheel"],[F,"_contextmenu"],[m,"_pointerdown"],[o,"_pointermove"],[x,"_pointerup"],[P,"_pointercancel"],[L,"_lostpointercapture"]],O={mouse:{[A]:n,[T]:e,[S]:f,[E]:_,[o]:y,[m]:k,[x]:d,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[T]:"touchleave",[S]:"touchover",[E]:"touchenter",[o]:w,[m]:v,[x]:C,[P]:R,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[T]:T,[S]:S,[E]:E,[o]:o,[m]:m,[x]:x,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},H=tt=>tt.indexOf("pointer")>=0?"pointer":tt.indexOf("touch")>=0?"touch":"mouse",j=tt=>{const D=H(tt);if(D==="pointer")return g.Konva.pointerEventsEnabled&&O.pointer;if(D==="touch")return O.touch;if(D==="mouse")return O.mouse};function U(tt={}){return(tt.clipFunc||tt.clipWidth||tt.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),tt}const W="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";i.stages=[];class Z extends u.Container{constructor(D){super(U(D)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),i.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{U(this.attrs)}),this._checkVisibility()}_validateAdd(D){const B=D.getType()==="Layer",V=D.getType()==="FastLayer";B||V||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const D=this.visible()?"":"none";this.content.style.display=D}setContainer(D){if(typeof D===s){if(D.charAt(0)==="."){const V=D.slice(1);D=document.getElementsByClassName(V)[0]}else{var B;D.charAt(0)!=="#"?B=D:B=D.slice(1),D=document.getElementById(B)}if(!D)throw"Can not find container in document with id "+B}return this._setAttr("container",D),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),D.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const D=this.children,B=D.length;for(let V=0;V<B;V++)D[V].clear();return this}clone(D){return D||(D={}),D.container=typeof document<"u"&&document.createElement("div"),u.Container.prototype.clone.call(this,D)}destroy(){super.destroy();const D=this.content;D&&t.Util._isInDocument(D)&&this.container().removeChild(D);const B=i.stages.indexOf(this);return B>-1&&i.stages.splice(B,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const D=this._pointerPositions[0]||this._changedPointerPositions[0];return D?{x:D.x,y:D.y}:(t.Util.warn(W),null)}_getPointerById(D){return this._pointerPositions.find(B=>B.id===D)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(D){D=D||{},D.x=D.x||0,D.y=D.y||0,D.width=D.width||this.width(),D.height=D.height||this.height();const B=new l.SceneCanvas({width:D.width,height:D.height,pixelRatio:D.pixelRatio||1}),V=B.getContext()._context,K=this.children;return(D.x||D.y)&&V.translate(-1*D.x,-1*D.y),K.forEach(function(et){if(!et.isVisible())return;const it=et._toKonvaCanvas(D);V.drawImage(it._canvas,D.x,D.y,it.getWidth()/it.getPixelRatio(),it.getHeight()/it.getPixelRatio())}),B}getIntersection(D){if(!D)return null;const B=this.children,V=B.length,K=V-1;for(let et=K;et>=0;et--){const it=B[et].getIntersection(D);if(it)return it}return null}_resizeDOM(){const D=this.width(),B=this.height();this.content&&(this.content.style.width=D+p,this.content.style.height=B+p),this.bufferCanvas.setSize(D,B),this.bufferHitCanvas.setSize(D,B),this.children.forEach(V=>{V.setSize({width:D,height:B}),V.draw()})}add(D,...B){if(arguments.length>1){for(let K=0;K<arguments.length;K++)this.add(arguments[K]);return this}super.add(D);const V=this.children.length;return V>N&&t.Util.warn("The stage has "+V+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),D.setSize({width:this.width(),height:this.height()}),D.draw(),g.Konva.isBrowser&&this.content.appendChild(D.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(D){return c.hasPointerCapture(D,this)}setPointerCapture(D){c.setPointerCapture(D,this)}releaseCapture(D){c.releaseCapture(D,this)}getLayers(){return this.children}_bindContentEvents(){g.Konva.isBrowser&&I.forEach(([D,B])=>{this.content.addEventListener(D,V=>{this[B](V)},{passive:!1})})}_pointerenter(D){this.setPointersPositions(D);const B=j(D.type);B&&this._fire(B.pointerenter,{evt:D,target:this,currentTarget:this})}_pointerover(D){this.setPointersPositions(D);const B=j(D.type);B&&this._fire(B.pointerover,{evt:D,target:this,currentTarget:this})}_getTargetShape(D){let B=this[D+"targetShape"];return B&&!B.getStage()&&(B=null),B}_pointerleave(D){const B=j(D.type),V=H(D.type);if(!B)return;this.setPointersPositions(D);const K=this._getTargetShape(V),et=!(g.Konva.isDragging()||g.Konva.isTransforming())||g.Konva.hitOnDragEnabled;K&&et?(K._fireAndBubble(B.pointerout,{evt:D}),K._fireAndBubble(B.pointerleave,{evt:D}),this._fire(B.pointerleave,{evt:D,target:this,currentTarget:this}),this[V+"targetShape"]=null):et&&(this._fire(B.pointerleave,{evt:D,target:this,currentTarget:this}),this._fire(B.pointerout,{evt:D,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(D){const B=j(D.type),V=H(D.type);if(!B)return;this.setPointersPositions(D);let K=!1;this._changedPointerPositions.forEach(et=>{const it=this.getIntersection(et);if(h.DD.justDragged=!1,g.Konva["_"+V+"ListenClick"]=!0,!it||!it.isListening()){this[V+"ClickStartShape"]=void 0;return}g.Konva.capturePointerEventsEnabled&&it.setPointerCapture(et.id),this[V+"ClickStartShape"]=it,it._fireAndBubble(B.pointerdown,{evt:D,pointerId:et.id}),K=!0;const ht=D.type.indexOf("touch")>=0;it.preventDefault()&&D.cancelable&&ht&&D.preventDefault()}),K||this._fire(B.pointerdown,{evt:D,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(D){const B=j(D.type),V=H(D.type);if(!B||(g.Konva.isDragging()&&h.DD.node.preventDefault()&&D.cancelable&&D.preventDefault(),this.setPointersPositions(D),!(!(g.Konva.isDragging()||g.Konva.isTransforming())||g.Konva.hitOnDragEnabled)))return;const et={};let it=!1;const ht=this._getTargetShape(V);this._changedPointerPositions.forEach(ct=>{const st=c.getCapturedShape(ct.id)||this.getIntersection(ct),Ct=ct.id,ot={evt:D,pointerId:Ct},lt=ht!==st;if(lt&&ht&&(ht._fireAndBubble(B.pointerout,{...ot},st),ht._fireAndBubble(B.pointerleave,{...ot},st)),st){if(et[st._id])return;et[st._id]=!0}st&&st.isListening()?(it=!0,lt&&(st._fireAndBubble(B.pointerover,{...ot},ht),st._fireAndBubble(B.pointerenter,{...ot},ht),this[V+"targetShape"]=st),st._fireAndBubble(B.pointermove,{...ot})):ht&&(this._fire(B.pointerover,{evt:D,target:this,currentTarget:this,pointerId:Ct}),this[V+"targetShape"]=null)}),it||this._fire(B.pointermove,{evt:D,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(D){const B=j(D.type),V=H(D.type);if(!B)return;this.setPointersPositions(D);const K=this[V+"ClickStartShape"],et=this[V+"ClickEndShape"],it={};let ht=!1;this._changedPointerPositions.forEach(ct=>{const st=c.getCapturedShape(ct.id)||this.getIntersection(ct);if(st){if(st.releaseCapture(ct.id),it[st._id])return;it[st._id]=!0}const Ct=ct.id,ot={evt:D,pointerId:Ct};let lt=!1;g.Konva["_"+V+"InDblClickWindow"]?(lt=!0,clearTimeout(this[V+"DblTimeout"])):h.DD.justDragged||(g.Konva["_"+V+"InDblClickWindow"]=!0,clearTimeout(this[V+"DblTimeout"])),this[V+"DblTimeout"]=setTimeout(function(){g.Konva["_"+V+"InDblClickWindow"]=!1},g.Konva.dblClickWindow),st&&st.isListening()?(ht=!0,this[V+"ClickEndShape"]=st,st._fireAndBubble(B.pointerup,{...ot}),g.Konva["_"+V+"ListenClick"]&&K&&K===st&&(st._fireAndBubble(B.pointerclick,{...ot}),lt&&et&&et===st&&st._fireAndBubble(B.pointerdblclick,{...ot}))):(this[V+"ClickEndShape"]=null,g.Konva["_"+V+"ListenClick"]&&this._fire(B.pointerclick,{evt:D,target:this,currentTarget:this,pointerId:Ct}),lt&&this._fire(B.pointerdblclick,{evt:D,target:this,currentTarget:this,pointerId:Ct}))}),ht||this._fire(B.pointerup,{evt:D,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),g.Konva["_"+V+"ListenClick"]=!1,D.cancelable&&V!=="touch"&&V!=="pointer"&&D.preventDefault()}_contextmenu(D){this.setPointersPositions(D);const B=this.getIntersection(this.getPointerPosition());B&&B.isListening()?B._fireAndBubble(F,{evt:D}):this._fire(F,{evt:D,target:this,currentTarget:this})}_wheel(D){this.setPointersPositions(D);const B=this.getIntersection(this.getPointerPosition());B&&B.isListening()?B._fireAndBubble(G,{evt:D}):this._fire(G,{evt:D,target:this,currentTarget:this})}_pointercancel(D){this.setPointersPositions(D);const B=c.getCapturedShape(D.pointerId)||this.getIntersection(this.getPointerPosition());B&&B._fireAndBubble(x,c.createEvent(D)),c.releaseCapture(D.pointerId)}_lostpointercapture(D){c.releaseCapture(D.pointerId)}setPointersPositions(D){const B=this._getContentPosition();let V=null,K=null;D=D||window.event,D.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(D.touches,et=>{this._pointerPositions.push({id:et.identifier,x:(et.clientX-B.left)/B.scaleX,y:(et.clientY-B.top)/B.scaleY})}),Array.prototype.forEach.call(D.changedTouches||D.touches,et=>{this._changedPointerPositions.push({id:et.identifier,x:(et.clientX-B.left)/B.scaleX,y:(et.clientY-B.top)/B.scaleY})})):(V=(D.clientX-B.left)/B.scaleX,K=(D.clientY-B.top)/B.scaleY,this.pointerPos={x:V,y:K},this._pointerPositions=[{x:V,y:K,id:t.Util._getFirstPointerId(D)}],this._changedPointerPositions=[{x:V,y:K,id:t.Util._getFirstPointerId(D)}])}_setPointerPosition(D){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(D)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const D=this.content.getBoundingClientRect();return{top:D.top,left:D.left,scaleX:D.width/this.content.clientWidth||1,scaleY:D.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new l.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new l.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!g.Konva.isBrowser)return;const D=this.container();if(!D)throw"Stage has no container. A container is required.";D.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),D.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(D){D.batchDraw()}),this}}i.Stage=Z,Z.prototype.nodeType=r,(0,a._registerNode)(Z),b.Factory.addGetterSetter(Z,"container"),g.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{i.stages.forEach(tt=>{tt.batchDraw()})})}(zi)),zi}var Ne={},jn;function da(){if(jn)return Ne;jn=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.Layer=void 0;const i=At(),t=Ri(),b=Rt(),u=ut(),g=Ei(),l=gt(),h=Ft(),a=dt(),c="#",r="beforeDraw",s="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],n=p.length;class e extends t.Container{constructor(_){super(_),this.canvas=new g.SceneCanvas,this.hitCanvas=new g.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(_){return this.getContext().clear(_),this.getHitCanvas().getContext().clear(_),this}setZIndex(_){super.setZIndex(_);const y=this.getStage();return y&&y.content&&(y.content.removeChild(this.getNativeCanvasElement()),_<y.children.length-1?y.content.insertBefore(this.getNativeCanvasElement(),y.children[_+1].getCanvas()._canvas):y.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){b.Node.prototype.moveToTop.call(this);const _=this.getStage();return _&&_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!b.Node.prototype.moveUp.call(this))return!1;const y=this.getStage();return!y||!y.content?!1:(y.content.removeChild(this.getNativeCanvasElement()),this.index<y.children.length-1?y.content.insertBefore(this.getNativeCanvasElement(),y.children[this.index+1].getCanvas()._canvas):y.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(b.Node.prototype.moveDown.call(this)){const _=this.getStage();if(_){const y=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),y[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(b.Node.prototype.moveToBottom.call(this)){const _=this.getStage();if(_){const y=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),y[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const _=this.getNativeCanvasElement();return b.Node.prototype.remove.call(this),_&&_.parentNode&&i.Util._isInDocument(_)&&_.parentNode.removeChild(_),this}getStage(){return this.parent}setSize({width:_,height:y}){return this.canvas.setSize(_,y),this.hitCanvas.setSize(_,y),this._setSmoothEnabled(),this}_validateAdd(_){const y=_.getType();y!=="Group"&&y!=="Shape"&&i.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(_){return _=_||{},_.width=_.width||this.getWidth(),_.height=_.height||this.getHeight(),_.x=_.x!==void 0?_.x:this.x(),_.y=_.y!==void 0?_.y:this.y(),b.Node.prototype._toKonvaCanvas.call(this,_)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){i.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){i.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,i.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(_){if(!this.isListening()||!this.isVisible())return null;let y=1,k=!1;for(;;){for(let d=0;d<n;d++){const o=p[d],m=this._getIntersection({x:_.x+o.x*y,y:_.y+o.y*y}),x=m.shape;if(x)return x;if(k=!!m.antialiased,!m.antialiased)break}if(k)y+=1;else return null}}_getIntersection(_){const y=this.hitCanvas.pixelRatio,k=this.hitCanvas.context.getImageData(Math.round(_.x*y),Math.round(_.y*y),1,1).data,d=k[3];if(d===255){const o=i.Util._rgbToHex(k[0],k[1],k[2]),m=h.shapes[c+o];return m?{shape:m}:{antialiased:!0}}else if(d>0)return{antialiased:!0};return{}}drawScene(_,y){const k=this.getLayer(),d=_||k&&k.getCanvas();return this._fire(r,{node:this}),this.clearBeforeDraw()&&d.getContext().clear(),t.Container.prototype.drawScene.call(this,d,y),this._fire(s,{node:this}),this}drawHit(_,y){const k=this.getLayer(),d=_||k&&k.hitCanvas;return k&&k.clearBeforeDraw()&&k.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,d,y),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(_){i.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(_)}getHitGraphEnabled(_){return i.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const _=this.parent;!!this.hitCanvas._canvas.parentNode?_.content.removeChild(this.hitCanvas._canvas):_.content.appendChild(this.hitCanvas._canvas)}destroy(){return i.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return Ne.Layer=e,e.prototype.nodeType="Layer",(0,a._registerNode)(e),u.Factory.addGetterSetter(e,"imageSmoothingEnabled",!0),u.Factory.addGetterSetter(e,"clearBeforeDraw",!0),u.Factory.addGetterSetter(e,"hitGraphEnabled",!0,(0,l.getBooleanValidator)()),Ne}var Oe={},Kn;function Go(){if(Kn)return Oe;Kn=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.FastLayer=void 0;const i=At(),t=da(),b=dt();let u=class extends t.Layer{constructor(l){super(l),this.listening(!1),i.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return Oe.FastLayer=u,u.prototype.nodeType="FastLayer",(0,b._registerNode)(u),Oe}var Ie={},Zn;function fn(){if(Zn)return Ie;Zn=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.Group=void 0;const i=At(),t=Ri(),b=dt();let u=class extends t.Container{_validateAdd(l){const h=l.getType();h!=="Group"&&h!=="Shape"&&i.Util.throw("You may only add groups and shapes to groups.")}};return Ie.Group=u,u.prototype.nodeType="Group",(0,b._registerNode)(u),Ie}var Be={},Qn;function gn(){if(Qn)return Be;Qn=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.Animation=void 0;const i=dt(),t=At(),b=function(){return i.glob.performance&&i.glob.performance.now?function(){return i.glob.performance.now()}:function(){return new Date().getTime()}}();let u=class Pe{constructor(l,h){this.id=Pe.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:b(),frameRate:0},this.func=l,this.setLayers(h)}setLayers(l){let h=[];return l&&(h=Array.isArray(l)?l:[l]),this.layers=h,this}getLayers(){return this.layers}addLayer(l){const h=this.layers,a=h.length;for(let c=0;c<a;c++)if(h[c]._id===l._id)return!1;return this.layers.push(l),!0}isRunning(){const h=Pe.animations,a=h.length;for(let c=0;c<a;c++)if(h[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=b(),Pe._addAnimation(this),this}stop(){return Pe._removeAnimation(this),this}_updateFrameObject(l){this.frame.timeDiff=l-this.frame.lastTime,this.frame.lastTime=l,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(l){this.animations.push(l),this._handleAnimation()}static _removeAnimation(l){const h=l.id,a=this.animations,c=a.length;for(let r=0;r<c;r++)if(a[r].id===h){this.animations.splice(r,1);break}}static _runFrames(){const l={},h=this.animations;for(let a=0;a<h.length;a++){const c=h[a],r=c.layers,s=c.func;c._updateFrameObject(b());const p=r.length;let n;if(s?n=s.call(c,c.frame)!==!1:n=!0,!!n)for(let e=0;e<p;e++){const f=r[e];f._id!==void 0&&(l[f._id]=f)}}for(const a in l)l.hasOwnProperty(a)&&l[a].batchDraw()}static _animationLoop(){const l=Pe;l.animations.length?(l._runFrames(),t.Util.requestAnimFrame(l._animationLoop)):l.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return Be.Animation=u,u.animations=[],u.animIdCounter=0,u.animRunning=!1,Be}var qi={},Jn;function Lo(){return Jn||(Jn=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Easings=i.Tween=void 0;const t=At(),b=gn(),u=Rt(),g=dt(),l={node:1,duration:1,easing:1,onFinish:1,yoyo:1},h=1,a=2,c=3,r=["fill","stroke","shadowColor"];let s=0;class p{constructor(f,_,y,k,d,o,m){this.prop=f,this.propFunc=_,this.begin=k,this._pos=k,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=m,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=y,this._change=d-this.begin,this.pause()}fire(f){const _=this[f];_&&_()}setTime(f){f>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():f<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=f,this.update())}getTime(){return this._time}setPosition(f){this.prevPos=this._pos,this.propFunc(f),this._pos=f}getPosition(f){return f===void 0&&(f=this._time),this.func(f,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(f){this.pause(),this._time=f,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const f=this.getTimer()-this._startTime;this.state===a?this.setTime(f):this.state===c&&this.setTime(this.duration-f)}pause(){this.state=h,this.fire("onPause")}getTimer(){return new Date().getTime()}}class n{constructor(f){const _=this,y=f.node,k=y._id,d=f.easing||i.Easings.Linear,o=!!f.yoyo;let m,x;typeof f.duration>"u"?m=.3:f.duration===0?m=.001:m=f.duration,this.node=y,this._id=s++;const P=y.getLayer()||(y instanceof g.Konva.Stage?y.getLayers():null);P||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new b.Animation(function(){_.tween.onEnterFrame()},P),this.tween=new p(x,function(L){_._tweenFunc(L)},d,0,1,m*1e3,o),this._addListeners(),n.attrs[k]||(n.attrs[k]={}),n.attrs[k][this._id]||(n.attrs[k][this._id]={}),n.tweens[k]||(n.tweens[k]={});for(x in f)l[x]===void 0&&this._addAttr(x,f[x]);this.reset(),this.onFinish=f.onFinish,this.onReset=f.onReset,this.onUpdate=f.onUpdate}_addAttr(f,_){const y=this.node,k=y._id;let d,o,m,x,P;const L=n.tweens[k][f];L&&delete n.attrs[k][L][f];let A=y.getAttr(f);if(t.Util._isArray(_))if(d=[],o=Math.max(_.length,A.length),f==="points"&&_.length!==A.length&&(_.length>A.length?(x=A,A=t.Util._prepareArrayForTween(A,_,y.closed())):(m=_,_=t.Util._prepareArrayForTween(_,A,y.closed()))),f.indexOf("fill")===0)for(let T=0;T<o;T++)if(T%2===0)d.push(_[T]-A[T]);else{const S=t.Util.colorToRGBA(A[T]);P=t.Util.colorToRGBA(_[T]),A[T]=S,d.push({r:P.r-S.r,g:P.g-S.g,b:P.b-S.b,a:P.a-S.a})}else for(let T=0;T<o;T++)d.push(_[T]-A[T]);else r.indexOf(f)!==-1?(A=t.Util.colorToRGBA(A),P=t.Util.colorToRGBA(_),d={r:P.r-A.r,g:P.g-A.g,b:P.b-A.b,a:P.a-A.a}):d=_-A;n.attrs[k][this._id][f]={start:A,diff:d,end:_,trueEnd:m,trueStart:x},n.tweens[k][f]=this._id}_tweenFunc(f){const _=this.node,y=n.attrs[_._id][this._id];let k,d,o,m,x,P,L,A;for(k in y){if(d=y[k],o=d.start,m=d.diff,A=d.end,t.Util._isArray(o))if(x=[],L=Math.max(o.length,A.length),k.indexOf("fill")===0)for(P=0;P<L;P++)P%2===0?x.push((o[P]||0)+m[P]*f):x.push("rgba("+Math.round(o[P].r+m[P].r*f)+","+Math.round(o[P].g+m[P].g*f)+","+Math.round(o[P].b+m[P].b*f)+","+(o[P].a+m[P].a*f)+")");else for(P=0;P<L;P++)x.push((o[P]||0)+m[P]*f);else r.indexOf(k)!==-1?x="rgba("+Math.round(o.r+m.r*f)+","+Math.round(o.g+m.g*f)+","+Math.round(o.b+m.b*f)+","+(o.a+m.a*f)+")":x=o+m*f;_.setAttr(k,x)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const f=this.node,_=n.attrs[f._id][this._id];_.points&&_.points.trueEnd&&f.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const f=this.node,_=n.attrs[f._id][this._id];_.points&&_.points.trueStart&&f.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(f){return this.tween.seek(f*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const f=this.node._id,_=this._id,y=n.tweens[f];this.pause();for(const k in y)delete n.tweens[f][k];delete n.attrs[f][_]}}i.Tween=n,n.attrs={},n.tweens={},u.Node.prototype.to=function(e){const f=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),f&&f()},new n(e).play()},i.Easings={BackEaseIn(e,f,_,y){return _*(e/=y)*e*((1.70158+1)*e-1.70158)+f},BackEaseOut(e,f,_,y){return _*((e=e/y-1)*e*((1.70158+1)*e+1.70158)+1)+f},BackEaseInOut(e,f,_,y){let k=1.70158;return(e/=y/2)<1?_/2*(e*e*(((k*=1.525)+1)*e-k))+f:_/2*((e-=2)*e*(((k*=1.525)+1)*e+k)+2)+f},ElasticEaseIn(e,f,_,y,k,d){let o=0;return e===0?f:(e/=y)===1?f+_:(d||(d=y*.3),!k||k<Math.abs(_)?(k=_,o=d/4):o=d/(2*Math.PI)*Math.asin(_/k),-(k*Math.pow(2,10*(e-=1))*Math.sin((e*y-o)*(2*Math.PI)/d))+f)},ElasticEaseOut(e,f,_,y,k,d){let o=0;return e===0?f:(e/=y)===1?f+_:(d||(d=y*.3),!k||k<Math.abs(_)?(k=_,o=d/4):o=d/(2*Math.PI)*Math.asin(_/k),k*Math.pow(2,-10*e)*Math.sin((e*y-o)*(2*Math.PI)/d)+_+f)},ElasticEaseInOut(e,f,_,y,k,d){let o=0;return e===0?f:(e/=y/2)===2?f+_:(d||(d=y*(.3*1.5)),!k||k<Math.abs(_)?(k=_,o=d/4):o=d/(2*Math.PI)*Math.asin(_/k),e<1?-.5*(k*Math.pow(2,10*(e-=1))*Math.sin((e*y-o)*(2*Math.PI)/d))+f:k*Math.pow(2,-10*(e-=1))*Math.sin((e*y-o)*(2*Math.PI)/d)*.5+_+f)},BounceEaseOut(e,f,_,y){return(e/=y)<1/2.75?_*(7.5625*e*e)+f:e<2/2.75?_*(7.5625*(e-=1.5/2.75)*e+.75)+f:e<2.5/2.75?_*(7.5625*(e-=2.25/2.75)*e+.9375)+f:_*(7.5625*(e-=2.625/2.75)*e+.984375)+f},BounceEaseIn(e,f,_,y){return _-i.Easings.BounceEaseOut(y-e,0,_,y)+f},BounceEaseInOut(e,f,_,y){return e<y/2?i.Easings.BounceEaseIn(e*2,0,_,y)*.5+f:i.Easings.BounceEaseOut(e*2-y,0,_,y)*.5+_*.5+f},EaseIn(e,f,_,y){return _*(e/=y)*e+f},EaseOut(e,f,_,y){return-_*(e/=y)*(e-2)+f},EaseInOut(e,f,_,y){return(e/=y/2)<1?_/2*e*e+f:-_/2*(--e*(e-2)-1)+f},StrongEaseIn(e,f,_,y){return _*(e/=y)*e*e*e*e+f},StrongEaseOut(e,f,_,y){return _*((e=e/y-1)*e*e*e*e+1)+f},StrongEaseInOut(e,f,_,y){return(e/=y/2)<1?_/2*e*e*e*e*e+f:_/2*((e-=2)*e*e*e*e+2)+f},Linear(e,f,_,y){return _*e/y+f}}}(qi)),qi}var $n;function nn(){return $n||($n=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Konva=void 0;const t=dt(),b=At(),u=Rt(),g=Ri(),l=ca(),h=da(),a=Go(),c=fn(),r=dn(),s=Ft(),p=gn(),n=Lo(),e=ta(),f=Ei();i.Konva=b.Util._assign(t.Konva,{Util:b.Util,Transform:b.Transform,Node:u.Node,Container:g.Container,Stage:l.Stage,stages:l.stages,Layer:h.Layer,FastLayer:a.FastLayer,Group:c.Group,DD:r.DD,Shape:s.Shape,shapes:s.shapes,Animation:p.Animation,Tween:n.Tween,Easings:n.Easings,Context:e.Context,Canvas:f.Canvas}),i.default=i.Konva}(Wi)),Wi}var tr;function Do(){return tr||(tr=1,function(i,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var b=nn();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return b.Konva}});const u=nn();i.exports=u.Konva}(xi,xi.exports)),xi.exports}var No=Do();const Oo=$r(No);var Ue={},er;function ua(){if(er)return Ue;er=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.Image=void 0;const i=At(),t=ut(),b=Ft(),u=dt(),g=gt();class l extends b.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),c=this.hasShadow();return a&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const c=this.getWidth(),r=this.getHeight(),s=this.cornerRadius(),p=this.attrs.image;let n;if(p){const e=this.attrs.cropWidth,f=this.attrs.cropHeight;e&&f?n=[p,this.cropX(),this.cropY(),e,f,0,0,c,r]:n=[p,0,0,c,r]}(this.hasFill()||this.hasStroke()||s)&&(a.beginPath(),s?i.Util.drawRoundedRectPath(a,c,r,s):a.rect(0,0,c,r),a.closePath(),a.fillStrokeShape(this)),p&&(s&&a.clip(),a.drawImage.apply(a,n))}_hitFunc(a){const c=this.width(),r=this.height(),s=this.cornerRadius();a.beginPath(),s?i.Util.drawRoundedRectPath(a,c,r,s):a.rect(0,0,c,r),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,c;return(a=this.attrs.width)!==null&&a!==void 0?a:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var a,c;return(a=this.attrs.height)!==null&&a!==void 0?a:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(a,c,r=null){const s=i.Util.createImageElement();s.onload=function(){const p=new l({image:s});c(p)},s.onerror=r,s.crossOrigin="Anonymous",s.src=a}}return Ue.Image=l,l.prototype.className="Image",(0,u._registerNode)(l),t.Factory.addGetterSetter(l,"cornerRadius",0,(0,g.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(l,"image"),t.Factory.addComponentsGetterSetter(l,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(l,"cropX",0,(0,g.getNumberValidator)()),t.Factory.addGetterSetter(l,"cropY",0,(0,g.getNumberValidator)()),t.Factory.addGetterSetter(l,"cropWidth",0,(0,g.getNumberValidator)()),t.Factory.addGetterSetter(l,"cropHeight",0,(0,g.getNumberValidator)()),Ue}var Io=ua();function fa(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Io.Image({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var be={},ir;function Bo(){if(ir)return be;ir=1,Object.defineProperty(be,"__esModule",{value:!0}),be.Tag=be.Label=void 0;const i=ut(),t=Ft(),b=fn(),u=gt(),g=dt(),l=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],h="Change.konva",a="none",c="up",r="right",s="down",p="left",n=l.length;let e=class extends b.Group{constructor(y){super(y),this.on("add.konva",function(k){this._addListeners(k.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(y){let k=this,d;const o=function(){k._sync()};for(d=0;d<n;d++)y.on(l[d]+h,o)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let y=this.getText(),k=this.getTag(),d,o,m,x,P,L,A;if(y&&k){switch(d=y.width(),o=y.height(),m=k.pointerDirection(),x=k.pointerWidth(),A=k.pointerHeight(),P=0,L=0,m){case c:P=d/2,L=-1*A;break;case r:P=d+x,L=o/2;break;case s:P=d/2,L=o+A;break;case p:P=-1*x,L=o/2;break}k.setAttrs({x:-1*P,y:-1*L,width:d,height:o}),y.setAttrs({x:-1*P,y:-1*L})}}};be.Label=e,e.prototype.className="Label",(0,g._registerNode)(e);class f extends t.Shape{_sceneFunc(y){const k=this.width(),d=this.height(),o=this.pointerDirection(),m=this.pointerWidth(),x=this.pointerHeight(),P=this.cornerRadius();let L=0,A=0,T=0,S=0;typeof P=="number"?L=A=T=S=Math.min(P,k/2,d/2):(L=Math.min(P[0]||0,k/2,d/2),A=Math.min(P[1]||0,k/2,d/2),S=Math.min(P[2]||0,k/2,d/2),T=Math.min(P[3]||0,k/2,d/2)),y.beginPath(),y.moveTo(L,0),o===c&&(y.lineTo((k-m)/2,0),y.lineTo(k/2,-1*x),y.lineTo((k+m)/2,0)),y.lineTo(k-A,0),y.arc(k-A,A,A,Math.PI*3/2,0,!1),o===r&&(y.lineTo(k,(d-x)/2),y.lineTo(k+m,d/2),y.lineTo(k,(d+x)/2)),y.lineTo(k,d-S),y.arc(k-S,d-S,S,0,Math.PI/2,!1),o===s&&(y.lineTo((k+m)/2,d),y.lineTo(k/2,d+x),y.lineTo((k-m)/2,d)),y.lineTo(T,d),y.arc(T,d-T,T,Math.PI/2,Math.PI,!1),o===p&&(y.lineTo(0,(d+x)/2),y.lineTo(-1*m,d/2),y.lineTo(0,(d-x)/2)),y.lineTo(0,L),y.arc(L,L,L,Math.PI,Math.PI*3/2,!1),y.closePath(),y.fillStrokeShape(this)}getSelfRect(){let y=0,k=0,d=this.pointerWidth(),o=this.pointerHeight(),m=this.pointerDirection(),x=this.width(),P=this.height();return m===c?(k-=o,P+=o):m===s?P+=o:m===p?(y-=d*1.5,x+=d):m===r&&(x+=d*1.5),{x:y,y:k,width:x,height:P}}}return be.Tag=f,f.prototype.className="Tag",(0,g._registerNode)(f),i.Factory.addGetterSetter(f,"pointerDirection",a),i.Factory.addGetterSetter(f,"pointerWidth",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(f,"pointerHeight",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(f,"cornerRadius",0,(0,u.getNumberOrArrayOfNumbersValidator)(4)),be}function Uo(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","children","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Oo.Layer({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(Ao().add(n),!b()){const _=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(_.x),g()!==void 0&&g(_.y),l()!==void 0&&l(_.scale),h()!==void 0&&h(_.scaleX),a()!==void 0&&a(_.scaleY),c()!==void 0&&c(_.rotation),r()!==void 0&&r(_.skewX),s()!==void 0&&s(_.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(_.x),g()!==void 0&&g(_.y)})}Object.keys(p).filter(_=>!_.startsWith("on")).forEach(_=>{X(()=>{n.setAttr(_,p[_])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ia(_i.Layer,n),ie(()=>{n.destroy()});var e=oe(),f=Nt(e);return zr(f,()=>t.children??Yr),rt(i,e),bt({node:n})}var He={},nr;function vn(){if(nr)return He;nr=1,Object.defineProperty(He,"__esModule",{value:!0}),He.Rect=void 0;const i=ut(),t=Ft(),b=dt(),u=At(),g=gt();class l extends t.Shape{_sceneFunc(a){const c=this.cornerRadius(),r=this.width(),s=this.height();a.beginPath(),c?u.Util.drawRoundedRectPath(a,r,s,c):a.rect(0,0,r,s),a.closePath(),a.fillStrokeShape(this)}}return He.Rect=l,l.prototype.className="Rect",(0,b._registerNode)(l),i.Factory.addGetterSetter(l,"cornerRadius",0,(0,g.getNumberOrArrayOfNumbersValidator)(4)),He}var Ho=vn();function Pi(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Ho.Rect({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var Ye={},rr;function ga(){if(rr)return Ye;rr=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.RegularPolygon=void 0;const i=ut(),t=Ft(),b=gt(),u=dt();class g extends t.Shape{_sceneFunc(h){const a=this._getPoints();h.beginPath(),h.moveTo(a[0].x,a[0].y);for(let c=1;c<a.length;c++)h.lineTo(a[c].x,a[c].y);h.closePath(),h.fillStrokeShape(this)}_getPoints(){const h=this.attrs.sides,a=this.attrs.radius||0,c=[];for(let r=0;r<h;r++)c.push({x:a*Math.sin(r*2*Math.PI/h),y:-1*a*Math.cos(r*2*Math.PI/h)});return c}getSelfRect(){const h=this._getPoints();let a=h[0].x,c=h[0].y,r=h[0].x,s=h[0].y;return h.forEach(p=>{a=Math.min(a,p.x),c=Math.max(c,p.x),r=Math.min(r,p.y),s=Math.max(s,p.y)}),{x:a,y:r,width:c-a,height:s-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(h){this.radius(h/2)}setHeight(h){this.radius(h/2)}}return Ye.RegularPolygon=g,g.prototype.className="RegularPolygon",g.prototype._centroid=!0,g.prototype._attrsAffectingSize=["radius"],(0,u._registerNode)(g),i.Factory.addGetterSetter(g,"radius",0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(g,"sides",0,(0,b.getNumberValidator)()),Ye}var Yo=ga();function me(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Yo.RegularPolygon({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var Xe={},ar;function Xo(){if(ar)return Xe;ar=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.Ring=void 0;const i=ut(),t=Ft(),b=gt(),u=dt(),g=Math.PI*2;let l=class extends t.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,g,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),g,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return Xe.Ring=l,l.prototype.className="Ring",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,u._registerNode)(l),i.Factory.addGetterSetter(l,"innerRadius",0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(l,"outerRadius",0,(0,b.getNumberValidator)()),Xe}var Vo=Ft();function Ti(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Vo.Shape({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var Ve={},sr;function Wo(){if(sr)return Ve;sr=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.Sprite=void 0;const i=ut(),t=Ft(),b=gn(),u=gt(),g=dt();let l=class extends t.Shape{constructor(a){super(a),this._updated=!0,this.anim=new b.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const c=this.animation(),r=this.frameIndex(),s=r*4,p=this.animations()[c],n=this.frameOffsets(),e=p[s+0],f=p[s+1],_=p[s+2],y=p[s+3],k=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,_,y),a.closePath(),a.fillStrokeShape(this)),k)if(n){const d=n[c],o=r*2;a.drawImage(k,e,f,_,y,d[o+0],d[o+1],_,y)}else a.drawImage(k,e,f,_,y,0,0,_,y)}_hitFunc(a){const c=this.animation(),r=this.frameIndex(),s=r*4,p=this.animations()[c],n=this.frameOffsets(),e=p[s+2],f=p[s+3];if(a.beginPath(),n){const _=n[c],y=r*2;a.rect(_[y+0],_[y+1],e,f)}else a.rect(0,0,e,f);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),c=this.animation(),r=this.animations(),s=r[c],p=s.length/4;a<p-1?this.frameIndex(a+1):this.frameIndex(0)}};return Ve.Sprite=l,l.prototype.className="Sprite",(0,g._registerNode)(l),i.Factory.addGetterSetter(l,"animation"),i.Factory.addGetterSetter(l,"animations"),i.Factory.addGetterSetter(l,"frameOffsets"),i.Factory.addGetterSetter(l,"image"),i.Factory.addGetterSetter(l,"frameIndex",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(l,"frameRate",17,(0,u.getNumberValidator)()),i.Factory.backCompat(l,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Ve}var zo=ca(),qo=at("<div><!></div>");function jo(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=ne(t,["$$slots","$$events","$$legacy","children","staticConfig","x","y","divWrapperProps"]),h,a;try{a=document.createElement("div")}catch(p){throw new Error("svelte-konva: Library can only be used in a browser context but is currently used in a server environment. If you are using SvelteKit, please refer to the following docs: https://konvajs.org/docs/svelte/SvelteKit.html",{cause:p})}const c=new zo.Stage({container:a,y:g(),x:u(),...l});if(!b()){const p=c.getAttrs();c.on("dragend",()=>{u()!==void 0&&u(p.x),g()!==void 0&&g(p.y)})}Object.keys(l).filter(p=>!p.startsWith("on")).forEach(p=>{X(()=>{c.setAttr(p,l[p])})}),X(()=>{c.setAttr("x",u())}),X(()=>{c.setAttr("y",g())}),ae(l,c),ia(_i.Stage,c),Ur(()=>{c.setContainer(h)}),ie(()=>{c.destroy()});var r=qo();za(r,()=>({...t.divWrapperProps}));var s=q(r);return zr(s,()=>t.children??Yr),z(r),Qt(r,p=>h=p,()=>h),rt(i,r),bt({node:c})}var We={},or;function va(){if(or)return We;or=1,Object.defineProperty(We,"__esModule",{value:!0}),We.Star=void 0;const i=ut(),t=Ft(),b=gt(),u=dt();class g extends t.Shape{_sceneFunc(h){const a=this.innerRadius(),c=this.outerRadius(),r=this.numPoints();h.beginPath(),h.moveTo(0,0-c);for(let s=1;s<r*2;s++){const p=s%2===0?c:a,n=p*Math.sin(s*Math.PI/r),e=-1*p*Math.cos(s*Math.PI/r);h.lineTo(n,e)}h.closePath(),h.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(h){this.outerRadius(h/2)}setHeight(h){this.outerRadius(h/2)}}return We.Star=g,g.prototype.className="Star",g.prototype._centroid=!0,g.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,u._registerNode)(g),i.Factory.addGetterSetter(g,"numPoints",5,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(g,"innerRadius",0,(0,b.getNumberValidator)()),i.Factory.addGetterSetter(g,"outerRadius",0,(0,b.getNumberValidator)()),We}var Ko=va();function pa(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Ko.Star({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var Ce={},lr;function pn(){if(lr)return Ce;lr=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.Text=void 0,Ce.stringToArray=h;const i=At(),t=ut(),b=Ft(),u=dt(),g=gt(),l=dt();function h(j){return[...j].reduce((U,W,Z,tt)=>{if(new RegExp("\\p{Emoji}","u").test(W)){const D=tt[Z+1];D&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(D)?(U.push(W+D),tt[Z+1]=""):U.push(W)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(W+(tt[Z+1]||""))?U.push(W+tt[Z+1]):Z>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(W)?U[U.length-1]+=W:W&&U.push(W);return U},[])}const a="auto",c="center",r="inherit",s="justify",p="Change.konva",n="2d",e="-",f="left",_="text",y="Text",k="top",d="bottom",o="middle",m="normal",x="px ",P=" ",L="right",A="rtl",T="word",S="char",E="none",F="…",v=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],C=v.length;function w(j){return j.split(",").map(U=>{U=U.trim();const W=U.indexOf(" ")>=0,Z=U.indexOf('"')>=0||U.indexOf("'")>=0;return W&&!Z&&(U=`"${U}"`),U}).join(", ")}let R;function G(){return R||(R=i.Util.createCanvasElement().getContext(n),R)}function N(j){j.fillText(this._partialText,this._partialTextX,this._partialTextY)}function I(j){j.setAttr("miterLimit",2),j.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function O(j){return j=j||{},!j.fillLinearGradientColorStops&&!j.fillRadialGradientColorStops&&!j.fillPatternImage&&(j.fill=j.fill||"black"),j}class H extends b.Shape{constructor(U){super(O(U)),this._partialTextX=0,this._partialTextY=0;for(let W=0;W<C;W++)this.on(v[W]+p,this._setTextData);this._setTextData()}_sceneFunc(U){const W=this.textArr,Z=W.length;if(!this.text())return;let tt=this.padding(),D=this.fontSize(),B=this.lineHeight()*D,V=this.verticalAlign(),K=this.direction(),et=0,it=this.align(),ht=this.getWidth(),ct=this.letterSpacing(),st=this.fill(),Ct=this.textDecoration(),ot=Ct.indexOf("underline")!==-1,lt=Ct.indexOf("line-through")!==-1,vt;K=K===r?U.direction:K;let wt=B/2,zt=o;if(u.Konva._fixTextRendering){const qt=this.measureSize("M");zt="alphabetic",wt=(qt.fontBoundingBoxAscent-qt.fontBoundingBoxDescent)/2+B/2}var $=0,Et=0;for(K===A&&U.setAttr("direction",K),U.setAttr("font",this._getContextFont()),U.setAttr("textBaseline",zt),U.setAttr("textAlign",f),V===o?et=(this.getHeight()-Z*B-tt*2)/2:V===d&&(et=this.getHeight()-Z*B-tt*2),U.translate(tt,et+tt),vt=0;vt<Z;vt++){var $=0,Et=0,Ot=W[vt],Ht=Ot.text,kt=Ot.width,Dt=Ot.lastInParagraph,Gt,It;if(U.save(),it===L?$+=ht-kt-tt*2:it===c&&($+=(ht-kt-tt*2)/2),ot){U.save(),U.beginPath();const Bt=u.Konva._fixTextRendering?Math.round(D/4):Math.round(D/2),Ut=$,Yt=wt+Et+Bt;U.moveTo(Ut,Yt),Gt=Ht.split(" ").length-1,It=it===s&&!Dt?ht-tt*2:kt,U.lineTo(Ut+Math.round(It),Yt),U.lineWidth=D/15;const Se=this._getLinearGradient();U.strokeStyle=Se||st,U.stroke(),U.restore()}if(lt){U.save(),U.beginPath();const Bt=u.Konva._fixTextRendering?-Math.round(D/4):0;U.moveTo($,wt+Et+Bt),Gt=Ht.split(" ").length-1,It=it===s&&!Dt?ht-tt*2:kt,U.lineTo($+Math.round(It),wt+Et+Bt),U.lineWidth=D/15;const Ut=this._getLinearGradient();U.strokeStyle=Ut||st,U.stroke(),U.restore()}if(K!==A&&(ct!==0||it===s)){Gt=Ht.split(" ").length-1;const Bt=h(Ht);for(let Ut=0;Ut<Bt.length;Ut++){const Yt=Bt[Ut];Yt===" "&&!Dt&&it===s&&($+=(ht-tt*2-kt)/Gt),this._partialTextX=$,this._partialTextY=wt+Et,this._partialText=Yt,U.fillStrokeShape(this),$+=this.measureSize(Yt).width+ct}}else ct!==0&&U.setAttr("letterSpacing",`${ct}px`),this._partialTextX=$,this._partialTextY=wt+Et,this._partialText=Ht,U.fillStrokeShape(this);U.restore(),Z>1&&(wt+=B)}}_hitFunc(U){const W=this.getWidth(),Z=this.getHeight();U.beginPath(),U.rect(0,0,W,Z),U.closePath(),U.fillStrokeShape(this)}setText(U){const W=i.Util._isString(U)?U:U==null?"":U+"";return this._setAttr(_,W),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return i.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(U){var W,Z,tt,D,B,V,K,et,it,ht,ct;let st=G(),Ct=this.fontSize(),ot;st.save(),st.font=this._getContextFont(),ot=st.measureText(U),st.restore();const lt=Ct/100;return{actualBoundingBoxAscent:(W=ot.actualBoundingBoxAscent)!==null&&W!==void 0?W:71.58203125*lt,actualBoundingBoxDescent:(Z=ot.actualBoundingBoxDescent)!==null&&Z!==void 0?Z:0,actualBoundingBoxLeft:(tt=ot.actualBoundingBoxLeft)!==null&&tt!==void 0?tt:-7.421875*lt,actualBoundingBoxRight:(D=ot.actualBoundingBoxRight)!==null&&D!==void 0?D:75.732421875*lt,alphabeticBaseline:(B=ot.alphabeticBaseline)!==null&&B!==void 0?B:0,emHeightAscent:(V=ot.emHeightAscent)!==null&&V!==void 0?V:100*lt,emHeightDescent:(K=ot.emHeightDescent)!==null&&K!==void 0?K:-20*lt,fontBoundingBoxAscent:(et=ot.fontBoundingBoxAscent)!==null&&et!==void 0?et:91*lt,fontBoundingBoxDescent:(it=ot.fontBoundingBoxDescent)!==null&&it!==void 0?it:21*lt,hangingBaseline:(ht=ot.hangingBaseline)!==null&&ht!==void 0?ht:72.80000305175781*lt,ideographicBaseline:(ct=ot.ideographicBaseline)!==null&&ct!==void 0?ct:-21*lt,width:ot.width,height:Ct}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+x)+w(this.fontFamily())}_addTextLine(U){this.align()===s&&(U=U.trim());const Z=this._getTextWidth(U);return this.textArr.push({text:U,width:Z,lastInParagraph:!1})}_getTextWidth(U){const W=this.letterSpacing(),Z=U.length;return G().measureText(U).width+W*Z}_setTextData(){let U=this.text().split(`
`),W=+this.fontSize(),Z=0,tt=this.lineHeight()*W,D=this.attrs.width,B=this.attrs.height,V=D!==a&&D!==void 0,K=B!==a&&B!==void 0,et=this.padding(),it=D-et*2,ht=B-et*2,ct=0,st=this.wrap(),Ct=st!==E,ot=st!==S&&Ct,lt=this.ellipsis();this.textArr=[],G().font=this._getContextFont();const vt=lt?this._getTextWidth(F):0;for(let wt=0,zt=U.length;wt<zt;++wt){let $=U[wt],Et=this._getTextWidth($);if(V&&Et>it)for(;$.length>0;){let Ot=0,Ht=h($).length,kt="",Dt=0;for(;Ot<Ht;){const Gt=Ot+Ht>>>1,It=h($),qt=It.slice(0,Gt+1).join(""),se=this._getTextWidth(qt);(lt&&K&&ct+tt>ht?se+vt:se)<=it?(Ot=Gt+1,kt=qt,Dt=se):Ht=Gt}if(kt){if(ot){const qt=h($),se=h(kt),Bt=qt[se.length],Ut=Bt===P||Bt===e;let Yt;if(Ut&&Dt<=it)Yt=se.length;else{const Se=se.lastIndexOf(P),mi=se.lastIndexOf(e);Yt=Math.max(Se,mi)+1}Yt>0&&(Ot=Yt,kt=qt.slice(0,Ot).join(""),Dt=this._getTextWidth(kt))}if(kt=kt.trimRight(),this._addTextLine(kt),Z=Math.max(Z,Dt),ct+=tt,this._shouldHandleEllipsis(ct)){this._tryToAddEllipsisToLastLine();break}if($=h($).slice(Ot).join("").trimLeft(),$.length>0&&(Et=this._getTextWidth($),Et<=it)){this._addTextLine($),ct+=tt,Z=Math.max(Z,Et);break}}else break}else this._addTextLine($),ct+=tt,Z=Math.max(Z,Et),this._shouldHandleEllipsis(ct)&&wt<zt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),K&&ct+tt>ht)break}this.textHeight=W,this.textWidth=Z}_shouldHandleEllipsis(U){const W=+this.fontSize(),Z=this.lineHeight()*W,tt=this.attrs.height,D=tt!==a&&tt!==void 0,B=this.padding(),V=tt-B*2;return!(this.wrap()!==E)||D&&U+Z>V}_tryToAddEllipsisToLastLine(){const U=this.attrs.width,W=U!==a&&U!==void 0,Z=this.padding(),tt=U-Z*2,D=this.ellipsis(),B=this.textArr[this.textArr.length-1];!B||!D||(W&&(this._getTextWidth(B.text+F)<tt||(B.text=B.text.slice(0,B.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(B.text+F))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const U=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,W=this.hasShadow();return U&&W?!0:super._useBufferCanvas()}}return Ce.Text=H,H.prototype._fillFunc=N,H.prototype._strokeFunc=I,H.prototype.className=y,H.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,l._registerNode)(H),t.Factory.overWriteSetter(H,"width",(0,g.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(H,"height",(0,g.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(H,"direction",r),t.Factory.addGetterSetter(H,"fontFamily","Arial"),t.Factory.addGetterSetter(H,"fontSize",12,(0,g.getNumberValidator)()),t.Factory.addGetterSetter(H,"fontStyle",m),t.Factory.addGetterSetter(H,"fontVariant",m),t.Factory.addGetterSetter(H,"padding",0,(0,g.getNumberValidator)()),t.Factory.addGetterSetter(H,"align",f),t.Factory.addGetterSetter(H,"verticalAlign",k),t.Factory.addGetterSetter(H,"lineHeight",1,(0,g.getNumberValidator)()),t.Factory.addGetterSetter(H,"wrap",T),t.Factory.addGetterSetter(H,"ellipsis",!1,(0,g.getBooleanValidator)()),t.Factory.addGetterSetter(H,"letterSpacing",0,(0,g.getNumberValidator)()),t.Factory.addGetterSetter(H,"text","",(0,g.getStringValidator)()),t.Factory.addGetterSetter(H,"textDecoration",""),Ce}var Zo=pn();function Si(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Zo.Text({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var ze={},hr;function Qo(){if(hr)return ze;hr=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.TextPath=void 0;const i=At(),t=ut(),b=Ft(),u=un(),g=pn(),l=gt(),h=dt(),a="",c="normal";function r(n){n.fillText(this.partialText,0,0)}function s(n){n.strokeText(this.partialText,0,0)}let p=class extends b.Shape{constructor(e){super(e),this.dummyCanvas=i.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return u.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const f=this.pathLength;return e-1>f?null:u.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=u.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const f=this.textDecoration(),_=this.fill(),y=this.fontSize(),k=this.glyphInfo;f==="underline"&&e.beginPath();for(let d=0;d<k.length;d++){e.save();const o=k[d].p0;e.translate(o.x,o.y),e.rotate(k[d].rotation),this.partialText=k[d].text,e.fillStrokeShape(this),f==="underline"&&(d===0&&e.moveTo(0,y/2+1),e.lineTo(y,y/2+1)),e.restore()}f==="underline"&&(e.strokeStyle=_,e.lineWidth=y/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const f=this.glyphInfo;if(f.length>=1){const _=f[0].p0;e.moveTo(_.x,_.y)}for(let _=0;_<f.length;_++){const y=f[_].p1;e.lineTo(y.x,y.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return i.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return g.Text.prototype.setText.call(this,e)}_getContextFont(){return g.Text.prototype._getContextFont.call(this)}_getTextSize(e){const _=this.dummyCanvas.getContext("2d");_.save(),_.font=this._getContextFont();const y=_.measureText(e);return _.restore(),{width:y.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:f}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=f,this.glyphInfo=[],!this.attrs.data)return null;const _=this.letterSpacing(),y=this.align(),k=this.kerningFunc(),d=Math.max(this.textWidth+((this.attrs.text||"").length-1)*_,0);let o=0;y==="center"&&(o=Math.max(0,this.pathLength/2-d/2)),y==="right"&&(o=Math.max(0,this.pathLength-d));const m=(0,g.stringToArray)(this.text());let x=o;for(let P=0;P<m.length;P++){const L=this._getPointAtLength(x);if(!L)return;let A=this._getTextSize(m[P]).width+_;if(m[P]===" "&&y==="justify"){const C=this.text().split(" ").length-1;A+=(this.pathLength-d)/C}const T=this._getPointAtLength(x+A);if(!T)return;const S=u.Path.getLineLength(L.x,L.y,T.x,T.y);let E=0;if(k)try{E=k(m[P-1],m[P])*this.fontSize()}catch{E=0}L.x+=E,T.x+=E,this.textWidth+=E;const F=u.Path.getPointOnLine(E+S/2,L.x,L.y,T.x,T.y),v=Math.atan2(T.y-L.y,T.x-L.x);this.glyphInfo.push({transposeX:F.x,transposeY:F.y,text:m[P],rotation:v,p0:L,p1:T}),x+=A}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(x){e.push(x.p0.x),e.push(x.p0.y),e.push(x.p1.x),e.push(x.p1.y)});let f=e[0]||0,_=e[0]||0,y=e[1]||0,k=e[1]||0,d,o;for(let x=0;x<e.length/2;x++)d=e[x*2],o=e[x*2+1],f=Math.min(f,d),_=Math.max(_,d),y=Math.min(y,o),k=Math.max(k,o);const m=this.fontSize();return{x:f-m/2,y:y-m/2,width:_-f+m,height:k-y+m}}destroy(){return i.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return ze.TextPath=p,p.prototype._fillFunc=r,p.prototype._strokeFunc=s,p.prototype._fillFuncHit=r,p.prototype._strokeFuncHit=s,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,h._registerNode)(p),t.Factory.addGetterSetter(p,"data"),t.Factory.addGetterSetter(p,"fontFamily","Arial"),t.Factory.addGetterSetter(p,"fontSize",12,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(p,"fontStyle",c),t.Factory.addGetterSetter(p,"align","left"),t.Factory.addGetterSetter(p,"letterSpacing",0,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(p,"textBaseline","middle"),t.Factory.addGetterSetter(p,"fontVariant",c),t.Factory.addGetterSetter(p,"text",a),t.Factory.addGetterSetter(p,"textDecoration",""),t.Factory.addGetterSetter(p,"kerningFunc",void 0),ze}var qe={},cr;function _a(){if(cr)return qe;cr=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.Transformer=void 0;const i=At(),t=ut(),b=Rt(),u=Ft(),g=vn(),l=fn(),h=dt(),a=gt(),c=dt(),r="tr-konva",s=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(A=>A+`.${r}`).join(" "),p="nodesRect",n=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],e={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},f="ontouchstart"in h.Konva._global;function _(A,T,S){if(A==="rotater")return S;T+=i.Util.degToRad(e[A]||0);const E=(i.Util.radToDeg(T)%360+360)%360;return i.Util._inRange(E,315+22.5,360)||i.Util._inRange(E,0,22.5)?"ns-resize":i.Util._inRange(E,45-22.5,45+22.5)?"nesw-resize":i.Util._inRange(E,90-22.5,90+22.5)?"ew-resize":i.Util._inRange(E,135-22.5,135+22.5)?"nwse-resize":i.Util._inRange(E,180-22.5,180+22.5)?"ns-resize":i.Util._inRange(E,225-22.5,225+22.5)?"nesw-resize":i.Util._inRange(E,270-22.5,270+22.5)?"ew-resize":i.Util._inRange(E,315-22.5,315+22.5)?"nwse-resize":(i.Util.error("Transformer has unknown angle for cursor detection: "+E),"pointer")}const y=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function k(A){return{x:A.x+A.width/2*Math.cos(A.rotation)+A.height/2*Math.sin(-A.rotation),y:A.y+A.height/2*Math.cos(A.rotation)+A.width/2*Math.sin(A.rotation)}}function d(A,T,S){const E=S.x+(A.x-S.x)*Math.cos(T)-(A.y-S.y)*Math.sin(T),F=S.y+(A.x-S.x)*Math.sin(T)+(A.y-S.y)*Math.cos(T);return{...A,rotation:A.rotation+T,x:E,y:F}}function o(A,T){const S=k(A);return d(A,T,S)}function m(A,T,S){let E=T;for(let F=0;F<A.length;F++){const v=h.Konva.getAngle(A[F]),C=Math.abs(v-T)%(Math.PI*2);Math.min(C,Math.PI*2-C)<S&&(E=v)}return E}let x=0;class P extends l.Group{constructor(T){super(T),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(s,this.update),this.getNode()&&this.update()}attachTo(T){return this.setNode(T),this}setNode(T){return i.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([T])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return r+this._id}setNodes(T=[]){this._nodes&&this._nodes.length&&this.detach();const S=T.filter(F=>F.isAncestorOf(this)?(i.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=T=S,T.length===1&&this.useSingleNodeRotation()?this.rotation(T[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(F=>{const v=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(F._attrsAffectingSize.length){const C=F._attrsAffectingSize.map(w=>w+"Change."+this._getEventNamespace()).join(" ");F.on(C,v)}F.on(n.map(C=>C+`.${this._getEventNamespace()}`).join(" "),v),F.on(`absoluteTransformChange.${this._getEventNamespace()}`,v),this._proxyDrag(F)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(T){let S;T.on(`dragstart.${this._getEventNamespace()}`,E=>{S=T.getAbsolutePosition(),!this.isDragging()&&T!==this.findOne(".back")&&this.startDrag(E,!1)}),T.on(`dragmove.${this._getEventNamespace()}`,E=>{if(!S)return;const F=T.getAbsolutePosition(),v=F.x-S.x,C=F.y-S.y;this.nodes().forEach(w=>{if(w===T||w.isDragging())return;const R=w.getAbsolutePosition();w.setAbsolutePosition({x:R.x+v,y:R.y+C}),w.startDrag(E)}),S=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(T=>{T.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(T,S=this.rotation(),E){const F=T.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),v=T.getAbsoluteScale(E),C=T.getAbsolutePosition(E),w=F.x*v.x-T.offsetX()*v.x,R=F.y*v.y-T.offsetY()*v.y,G=(h.Konva.getAngle(T.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),N={x:C.x+w*Math.cos(G)+R*Math.sin(-G),y:C.y+R*Math.cos(G)+w*Math.sin(G),width:F.width*v.x,height:F.height*v.y,rotation:G};return d(N,-h.Konva.getAngle(S),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const S=[];this.nodes().map(G=>{const N=G.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),I=[{x:N.x,y:N.y},{x:N.x+N.width,y:N.y},{x:N.x+N.width,y:N.y+N.height},{x:N.x,y:N.y+N.height}],O=G.getAbsoluteTransform();I.forEach(function(H){const j=O.point(H);S.push(j)})});const E=new i.Transform;E.rotate(-h.Konva.getAngle(this.rotation()));let F=1/0,v=1/0,C=-1/0,w=-1/0;S.forEach(function(G){const N=E.point(G);F===void 0&&(F=C=N.x,v=w=N.y),F=Math.min(F,N.x),v=Math.min(v,N.y),C=Math.max(C,N.x),w=Math.max(w,N.y)}),E.invert();const R=E.point({x:F,y:v});return{x:R.x,y:R.y,width:C-F,height:w-v,rotation:h.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),y.forEach(T=>{this._createAnchor(T)}),this._createAnchor("rotater")}_createAnchor(T){const S=new g.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:T+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:f?10:"auto"}),E=this;S.on("mousedown touchstart",function(F){E._handleMouseDown(F)}),S.on("dragstart",F=>{S.stopDrag(),F.cancelBubble=!0}),S.on("dragend",F=>{F.cancelBubble=!0}),S.on("mouseenter",()=>{const F=h.Konva.getAngle(this.rotation()),v=this.rotateAnchorCursor(),C=_(T,F,v);S.getStage().content&&(S.getStage().content.style.cursor=C),this._cursorChange=!0}),S.on("mouseout",()=>{S.getStage().content&&(S.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(S)}_createBack(){const T=new u.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(S,E){const F=E.getParent(),v=F.padding();S.beginPath(),S.rect(-v,-v,E.width()+v*2,E.height()+v*2),S.moveTo(E.width()/2,-v),F.rotateEnabled()&&F.rotateLineVisible()&&S.lineTo(E.width()/2,-F.rotateAnchorOffset()*i.Util._sign(E.height())-v),S.fillStrokeShape(E)},hitFunc:(S,E)=>{if(!this.shouldOverdrawWholeArea())return;const F=this.padding();S.beginPath(),S.rect(-F,-F,E.width()+F*2,E.height()+F*2),S.fillStrokeShape(E)}});this.add(T),this._proxyDrag(T),T.on("dragstart",S=>{S.cancelBubble=!0}),T.on("dragmove",S=>{S.cancelBubble=!0}),T.on("dragend",S=>{S.cancelBubble=!0}),this.on("dragmove",S=>{this.update()})}_handleMouseDown(T){if(this._transforming)return;this._movingAnchorName=T.target.name().split(" ")[0];const S=this._getNodeRect(),E=S.width,F=S.height,v=Math.sqrt(Math.pow(E,2)+Math.pow(F,2));this.sin=Math.abs(F/v),this.cos=Math.abs(E/v),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const C=T.target.getAbsolutePosition(),w=T.target.getStage().getPointerPosition();this._anchorDragOffset={x:w.x-C.x,y:w.y-C.y},x++,this._fire("transformstart",{evt:T.evt,target:this.getNode()}),this._nodes.forEach(R=>{R._fire("transformstart",{evt:T.evt,target:R})})}_handleMouseMove(T){let S,E,F;const v=this.findOne("."+this._movingAnchorName),C=v.getStage();C.setPointersPositions(T);const w=C.getPointerPosition();let R={x:w.x-this._anchorDragOffset.x,y:w.y-this._anchorDragOffset.y};const G=v.getAbsolutePosition();this.anchorDragBoundFunc()&&(R=this.anchorDragBoundFunc()(G,R,T)),v.setAbsolutePosition(R);const N=v.getAbsolutePosition();if(G.x===N.x&&G.y===N.y)return;if(this._movingAnchorName==="rotater"){const V=this._getNodeRect();S=v.x()-V.width/2,E=-v.y()+V.height/2;let K=Math.atan2(-E,S)+Math.PI/2;V.height<0&&(K-=Math.PI);const it=h.Konva.getAngle(this.rotation())+K,ht=h.Konva.getAngle(this.rotationSnapTolerance()),st=m(this.rotationSnaps(),it,ht)-V.rotation,Ct=o(V,st);this._fitNodesInto(Ct,T);return}const I=this.shiftBehavior();let O;I==="inverted"?O=this.keepRatio()&&!T.shiftKey:I==="none"?O=this.keepRatio():O=this.keepRatio()||T.shiftKey;var Z=this.centeredScaling()||T.altKey;if(this._movingAnchorName==="top-left"){if(O){var H=Z?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};F=Math.sqrt(Math.pow(H.x-v.x(),2)+Math.pow(H.y-v.y(),2));var j=this.findOne(".top-left").x()>H.x?-1:1,U=this.findOne(".top-left").y()>H.y?-1:1;S=F*this.cos*j,E=F*this.sin*U,this.findOne(".top-left").x(H.x-S),this.findOne(".top-left").y(H.y-E)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(v.y());else if(this._movingAnchorName==="top-right"){if(O){var H=Z?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};F=Math.sqrt(Math.pow(v.x()-H.x,2)+Math.pow(H.y-v.y(),2));var j=this.findOne(".top-right").x()<H.x?-1:1,U=this.findOne(".top-right").y()>H.y?-1:1;S=F*this.cos*j,E=F*this.sin*U,this.findOne(".top-right").x(H.x+S),this.findOne(".top-right").y(H.y-E)}var W=v.position();this.findOne(".top-left").y(W.y),this.findOne(".bottom-right").x(W.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(v.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(v.x());else if(this._movingAnchorName==="bottom-left"){if(O){var H=Z?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};F=Math.sqrt(Math.pow(H.x-v.x(),2)+Math.pow(v.y()-H.y,2));var j=H.x<v.x()?-1:1,U=v.y()<H.y?-1:1;S=F*this.cos*j,E=F*this.sin*U,v.x(H.x-S),v.y(H.y+E)}W=v.position(),this.findOne(".top-left").x(W.x),this.findOne(".bottom-right").y(W.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(v.y());else if(this._movingAnchorName==="bottom-right"){if(O){var H=Z?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};F=Math.sqrt(Math.pow(v.x()-H.x,2)+Math.pow(v.y()-H.y,2));var j=this.findOne(".bottom-right").x()<H.x?-1:1,U=this.findOne(".bottom-right").y()<H.y?-1:1;S=F*this.cos*j,E=F*this.sin*U,this.findOne(".bottom-right").x(H.x+S),this.findOne(".bottom-right").y(H.y+E)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var Z=this.centeredScaling()||T.altKey;if(Z){const V=this.findOne(".top-left"),K=this.findOne(".bottom-right"),et=V.x(),it=V.y(),ht=this.getWidth()-K.x(),ct=this.getHeight()-K.y();K.move({x:-et,y:-it}),V.move({x:ht,y:ct})}const tt=this.findOne(".top-left").getAbsolutePosition();S=tt.x,E=tt.y;const D=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),B=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:S,y:E,width:D,height:B,rotation:h.Konva.getAngle(this.rotation())},T)}_handleMouseUp(T){this._removeEvents(T)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(T){var S;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const E=this.getNode();x--,this._fire("transformend",{evt:T,target:E}),(S=this.getLayer())===null||S===void 0||S.batchDraw(),E&&this._nodes.forEach(F=>{var v;F._fire("transformend",{evt:T,target:F}),(v=F.getLayer())===null||v===void 0||v.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(T,S){const E=this._getNodeRect(),F=1;if(i.Util._inRange(T.width,-this.padding()*2-F,F)){this.update();return}if(i.Util._inRange(T.height,-this.padding()*2-F,F)){this.update();return}const v=new i.Transform;if(v.rotate(h.Konva.getAngle(this.rotation())),this._movingAnchorName&&T.width<0&&this._movingAnchorName.indexOf("left")>=0){const O=v.point({x:-this.padding()*2,y:0});T.x+=O.x,T.y+=O.y,T.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y}else if(this._movingAnchorName&&T.width<0&&this._movingAnchorName.indexOf("right")>=0){const O=v.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,T.width+=this.padding()*2}if(this._movingAnchorName&&T.height<0&&this._movingAnchorName.indexOf("top")>=0){const O=v.point({x:0,y:-this.padding()*2});T.x+=O.x,T.y+=O.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,T.height+=this.padding()*2}else if(this._movingAnchorName&&T.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const O=v.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,T.height+=this.padding()*2}if(this.boundBoxFunc()){const O=this.boundBoxFunc()(E,T);O?T=O:i.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const C=1e7,w=new i.Transform;w.translate(E.x,E.y),w.rotate(E.rotation),w.scale(E.width/C,E.height/C);const R=new i.Transform,G=T.width/C,N=T.height/C;this.flipEnabled()===!1?(R.translate(T.x,T.y),R.rotate(T.rotation),R.translate(T.width<0?T.width:0,T.height<0?T.height:0),R.scale(Math.abs(G),Math.abs(N))):(R.translate(T.x,T.y),R.rotate(T.rotation),R.scale(G,N));const I=R.multiply(w.invert());this._nodes.forEach(O=>{var H;const j=O.getParent().getAbsoluteTransform(),U=O.getTransform().copy();U.translate(O.offsetX(),O.offsetY());const W=new i.Transform;W.multiply(j.copy().invert()).multiply(I).multiply(j).multiply(U);const Z=W.decompose();O.setAttrs(Z),(H=O.getLayer())===null||H===void 0||H.batchDraw()}),this.rotation(i.Util._getRotation(T.rotation)),this._nodes.forEach(O=>{this._fire("transform",{evt:S,target:O}),O._fire("transform",{evt:S,target:O})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(T,S){this.findOne(T).setAttrs(S)}update(){var T;const S=this._getNodeRect();this.rotation(i.Util._getRotation(S.rotation));const E=S.width,F=S.height,v=this.enabledAnchors(),C=this.resizeEnabled(),w=this.padding(),R=this.anchorSize(),G=this.find("._anchor");G.forEach(I=>{I.setAttrs({width:R,height:R,offsetX:R/2,offsetY:R/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:R/2+w,offsetY:R/2+w,visible:C&&v.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:E/2,y:0,offsetY:R/2+w,visible:C&&v.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:E,y:0,offsetX:R/2-w,offsetY:R/2+w,visible:C&&v.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:F/2,offsetX:R/2+w,visible:C&&v.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:E,y:F/2,offsetX:R/2-w,visible:C&&v.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:F,offsetX:R/2+w,offsetY:R/2-w,visible:C&&v.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:E/2,y:F,offsetY:R/2-w,visible:C&&v.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:E,y:F,offsetX:R/2-w,offsetY:R/2-w,visible:C&&v.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:E/2,y:-this.rotateAnchorOffset()*i.Util._sign(F)-w,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:E,height:F,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const N=this.anchorStyleFunc();N&&G.forEach(I=>{N(I)}),(T=this.getLayer())===null||T===void 0||T.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const T=this.findOne("."+this._movingAnchorName);T&&T.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),l.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return b.Node.prototype.toObject.call(this)}clone(T){return b.Node.prototype.clone.call(this,T)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}qe.Transformer=P,P.isTransforming=()=>x>0;function L(A){return A instanceof Array||i.Util.warn("enabledAnchors value should be an array"),A instanceof Array&&A.forEach(function(T){y.indexOf(T)===-1&&i.Util.warn("Unknown anchor name: "+T+". Available names are: "+y.join(", "))}),A||[]}return P.prototype.className="Transformer",(0,c._registerNode)(P),t.Factory.addGetterSetter(P,"enabledAnchors",y,L),t.Factory.addGetterSetter(P,"flipEnabled",!0,(0,a.getBooleanValidator)()),t.Factory.addGetterSetter(P,"resizeEnabled",!0),t.Factory.addGetterSetter(P,"anchorSize",10,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateEnabled",!0),t.Factory.addGetterSetter(P,"rotateLineVisible",!0),t.Factory.addGetterSetter(P,"rotationSnaps",[]),t.Factory.addGetterSetter(P,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(P,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderEnabled",!0),t.Factory.addGetterSetter(P,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(P,"anchorFill","white"),t.Factory.addGetterSetter(P,"anchorCornerRadius",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"borderStrokeWidth",1,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderDash"),t.Factory.addGetterSetter(P,"keepRatio",!0),t.Factory.addGetterSetter(P,"shiftBehavior","default"),t.Factory.addGetterSetter(P,"centeredScaling",!1),t.Factory.addGetterSetter(P,"ignoreStroke",!1),t.Factory.addGetterSetter(P,"padding",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(P,"nodes"),t.Factory.addGetterSetter(P,"node"),t.Factory.addGetterSetter(P,"boundBoxFunc"),t.Factory.addGetterSetter(P,"anchorDragBoundFunc"),t.Factory.addGetterSetter(P,"anchorStyleFunc"),t.Factory.addGetterSetter(P,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(P,"useSingleNodeRotation",!0),t.Factory.backCompat(P,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),qe}var Jo=_a();function $o(i,t){yt(t,!0);let b=Y(t,"staticConfig",3,!1),u=Y(t,"x",15),g=Y(t,"y",15),l=Y(t,"scale",15),h=Y(t,"scaleX",15),a=Y(t,"scaleY",15),c=Y(t,"rotation",15),r=Y(t,"skewX",15),s=Y(t,"skewY",15),p=ne(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const n=new Jo.Transformer({x:u(),y:g(),scale:l(),scaleX:h(),scaleY:a(),rotation:c(),skewX:r(),skewY:s(),...p});if(ue().add(n),!b()){const e=n.getAttrs();n.on("transformend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y),l()!==void 0&&l(e.scale),h()!==void 0&&h(e.scaleX),a()!==void 0&&a(e.scaleY),c()!==void 0&&c(e.rotation),r()!==void 0&&r(e.skewX),s()!==void 0&&s(e.skewY)}),n.on("dragend",()=>{u()!==void 0&&u(e.x),g()!==void 0&&g(e.y)})}return Object.keys(p).filter(e=>!e.startsWith("on")).forEach(e=>{X(()=>{n.setAttr(e,p[e])})}),X(()=>{n.setAttr("x",u())}),X(()=>{n.setAttr("y",g())}),X(()=>{n.setAttr("scale",l())}),X(()=>{n.setAttr("scaleX",h())}),X(()=>{n.setAttr("scaleY",a())}),X(()=>{n.setAttr("rotation",c())}),X(()=>{n.setAttr("skewX",r())}),X(()=>{n.setAttr("skewY",s())}),ae(p,n),ie(()=>{n.destroy()}),bt({node:n})}var je={},dr;function tl(){if(dr)return je;dr=1,Object.defineProperty(je,"__esModule",{value:!0}),je.Wedge=void 0;const i=ut(),t=Ft(),b=dt(),u=gt(),g=dt();let l=class extends t.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,b.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return je.Wedge=l,l.prototype.className="Wedge",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["radius"],(0,g._registerNode)(l),i.Factory.addGetterSetter(l,"radius",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(l,"angle",0,(0,u.getNumberValidator)()),i.Factory.addGetterSetter(l,"clockwise",!1),i.Factory.backCompat(l,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),je}function el(i,t){yt(t,!1);let b=Y(t,"shapes",8),u=Y(t,"canvasZoom",8);Y(t,"selectedId",8);let g=Y(t,"onDragEnd",8),l=Y(t,"onElementClick",8);const h={[J.Circle]:oa,[J.Rectangle]:Pi,[J.Square]:Pi,[J.Triangle]:me,[J.Pentagon]:me,[J.Hexagon]:me,[J.Diamond]:me,[J.Star]:pa,[J.Ellipse]:ha,[J.Arrow]:aa,[J.Heart]:Ti,[J.Cross]:Ti};function a(s){const p=u()/100,n={x:s.x*p,y:s.y*p,fill:s.fill,draggable:!0,id:s.id,stroke:s.stroke,strokeWidth:s.strokeWidth*p,opacity:s.opacity??1,scaleX:s.scaleX??1,scaleY:s.scaleY??1,rotation:s.rotation??0,subType:s.subType},e=fs(s),f={};return Object.keys(e).forEach(_=>{_==="radius"||_==="width"||_==="height"?f[_]=e[_]*p:f[_]=e[_]}),{...n,...f}}qr();var c=oe(),r=Nt(c);de(r,1,b,s=>s.id,(s,p)=>{var n=oe();const e=jt(()=>M(p).subType||M(p).type),f=jt(()=>h[M(e)]),_=jt(()=>a(M(p)));var y=Nt(n);{var k=d=>{var o=oe(),m=Nt(o);Wr(m,()=>M(f),(x,P)=>{P(x,qa(()=>M(_),{onclick:L=>{L.cancelBubble=!0,l()(M(p).id)},ondragend:L=>g()(M(p),L)}))}),rt(d,o)};xt(y,d=>{M(f)&&d(k)})}rt(s,n)}),rt(i,c),bt()}function il(i,t){yt(t,!1);let b=Y(t,"images",8),u=Y(t,"canvasZoom",8);Y(t,"selectedId",8);let g=Y(t,"onDragEnd",8),l=Y(t,"onElementClick",8);function h(r){if((!r.brightness||r.brightness===0)&&(!r.contrast||r.contrast===0))return r.imageElement;const s=document.createElement("canvas"),p=s.getContext("2d");if(!p||!r.imageElement)return r.imageElement;s.width=r.imageElement.naturalWidth,s.height=r.imageElement.naturalHeight;const n=[];if(r.brightness&&r.brightness!==0){const e=1+r.brightness*.5;n.push(`brightness(${e})`)}if(r.contrast&&r.contrast!==0){const e=1+r.contrast*.5;n.push(`contrast(${e})`)}return p.filter=n.join(" "),p.drawImage(r.imageElement,0,0),p.filter="none",s}qr();var a=oe(),c=Nt(a);de(c,1,b,r=>r.id,(r,s)=>{const p=jt(()=>M(s).x*(u()/100)),n=jt(()=>M(s).y*(u()/100)),e=jt(()=>M(s).width*(u()/100)),f=jt(()=>M(s).height*(u()/100)),_=jt(()=>h(M(s))),y=jt(()=>M(s).opacity||1),k=jt(()=>M(s).scaleX||1),d=jt(()=>M(s).scaleY||1),o=jt(()=>M(s).rotation||0);fa(r,{get x(){return M(p)},get y(){return M(n)},get width(){return M(e)},get height(){return M(f)},get image(){return M(_)},get opacity(){return M(y)},get scaleX(){return M(k)},get scaleY(){return M(d)},get rotation(){return M(o)},draggable:!0,get id(){return M(s).id},onclick:m=>{m.cancelBubble=!0,l()(M(s).id)},ondragend:m=>g()(M(s),m)})}),rt(i,a),bt()}var nl=at('<div class="absolute inset-0 pointer-events-none"><div class="absolute top-0 bottom-0 border-l border-gray-300 opacity-60" style="left: 33.33%;"></div> <div class="absolute top-0 bottom-0 border-l border-gray-300 opacity-60" style="left: 66.67%;"></div> <div class="absolute left-0 right-0 border-t border-gray-300 opacity-60" style="top: 33.33%;"></div> <div class="absolute left-0 right-0 border-t border-gray-300 opacity-60" style="top: 66.67%;"></div></div>'),rl=at("<!> <!> <!> <!>",1),al=at('<div class="flex-1 overflow-auto"><div class="flex items-start justify-start"><div class="rounded-xl border border-gray-200 shadow-lg relative"><!> <!></div></div></div>');function sl(i,t){yt(t,!0);let b=mt(void 0),u=mt(void 0),g=mt(void 0);X(()=>{M(b)&&t.onStageReady&&t.onStageReady(M(b))}),X(()=>{t.selectedId&&M(g)&&M(u)?l():M(g)&&M(u)&&h()});function l(){if(!M(g)||!t.selectedId||!M(u))return;let _=null;typeof M(g).getNode=="function"?_=M(g).getNode():M(g).node?_=M(g).node:M(g)._node&&(_=M(g)._node);let y=null;if(typeof M(u).getNode=="function"?y=M(u).getNode():M(u).node?y=M(u).node:M(u)._node&&(y=M(u)._node),!_||!y)return;const k=y.findOne(`#${t.selectedId}`);k&&(_.nodes([k]),y.batchDraw())}function h(){if(!M(g)||!M(u))return;let _=null;if(typeof M(g).getNode=="function"?_=M(g).getNode():M(g).node?_=M(g).node:M(g)._node&&(_=M(g)._node),_){_.nodes([]);let y=null;typeof M(u).getNode=="function"?y=M(u).getNode():M(u).node?y=M(u).node:M(u)._node&&(y=M(u)._node),y&&y.batchDraw()}}function a(_){const y=_.target,k=y.id(),d=y.scaleX(),o=y.scaleY(),m=y.rotation(),x=y.x(),P=y.y();le.update(L=>L.map(A=>A.id===k?{...A,x,y:P,scaleX:d,scaleY:o,rotation:m}:A)),he.update(L=>L.map(A=>A.id===k?{...A,x,y:P,scaleX:d,scaleY:o,rotation:m}:A)),ce.update(L=>L.map(A=>A.id===k?{...A,x,y:P,scaleX:d,scaleY:o,rotation:m}:A)),Kt.pushState()}var c=al(),r=q(c),s=q(r),p=q(s);{var n=_=>{var y=nl();rt(_,y)};xt(p,_=>{t.showGrid&&_(n)})}var e=Q(p,2);{var f=_=>{const y=ft(()=>t.canvasWidth*(t.canvasZoom/100)),k=ft(()=>t.canvasHeight*(t.canvasZoom/100));Qt(jo(_,{get width(){return M(y)},get height(){return M(k)},class:"block",get onclick(){return t.onStageClick},$$events:{wheel(...d){var o;(o=t.onWheel)==null||o.apply(this,d)},mousedown(...d){var o;(o=t.onMouseDown)==null||o.apply(this,d)},mousemove(...d){var o;(o=t.onMouseMove)==null||o.apply(this,d)},mouseup(...d){var o;(o=t.onMouseUp)==null||o.apply(this,d)}},children:(d,o)=>{Qt(Uo(d,{children:(m,x)=>{var P=rl(),L=Nt(P);el(L,{get shapes(){return t.shapes},get canvasZoom(){return t.canvasZoom},get selectedId(){return t.selectedId},get onDragEnd(){return t.onShapeDragEnd},get onElementClick(){return t.onElementClick}});var A=Q(L,2);il(A,{get images(){return t.images},get canvasZoom(){return t.canvasZoom},get selectedId(){return t.selectedId},get onDragEnd(){return t.onImageDragEnd},get onElementClick(){return t.onElementClick}});var T=Q(A,2);de(T,17,()=>t.textElements,E=>E.id,(E,F)=>{const v=ft(()=>M(F).x*(t.canvasZoom/100)),C=ft(()=>M(F).y*(t.canvasZoom/100)),w=ft(()=>M(F).fontSize*(t.canvasZoom/100)),R=ft(()=>M(F).strokeWidth*(t.canvasZoom/100)),G=ft(()=>(M(F).padding||4)*(t.canvasZoom/100)),N=ft(()=>(M(F).width||150)*(t.canvasZoom/100)),I=ft(()=>(M(F).height||30)*(t.canvasZoom/100)),O=ft(()=>M(F).scaleX??1),H=ft(()=>M(F).scaleY??1),j=ft(()=>M(F).rotation??0);Si(E,{get x(){return M(v)},get y(){return M(C)},get text(){return M(F).text},get fontFamily(){return M(F).fontFamily},get fontSize(){return M(w)},get fontWeight(){return M(F).fontWeight},get textAlign(){return M(F).textAlign},get fill(){return M(F).fill},get stroke(){return M(F).stroke},get strokeWidth(){return M(R)},get opacity(){return M(F).opacity},get padding(){return M(G)},get width(){return M(N)},get height(){return M(I)},get scaleX(){return M(O)},get scaleY(){return M(H)},get rotation(){return M(j)},draggable:!0,get id(){return M(F).id},onclick:U=>{U.cancelBubble=!0,t.onTextElementClick(M(F).id)},ondblclick:U=>{U.cancelBubble=!0,t.onTextElementDblClick(M(F))},ondragend:U=>t.onTextElementDragEnd(M(F),U)})});var S=Q(T,2);Qt($o(S,{config:{enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],rotateEnabled:!0,borderEnabled:!0,anchorSize:8,anchorFill:"#ffffff",anchorStroke:"#3b82f6",anchorStrokeWidth:2,borderStroke:"#3b82f6",borderStrokeWidth:1,borderDash:[4,4],rotateAnchorOffset:20,anchorCornerRadius:2},ontransformend:a}),E=>nt(g,E,!0),()=>M(g)),rt(m,P)},$$slots:{default:!0}}),m=>nt(u,m,!0),()=>M(u))},$$slots:{default:!0}}),d=>nt(b,d,!0),()=>M(b))};xt(e,_=>{_(f)})}return z(s),z(r),z(c),St(()=>{Wt(r,`padding: 48px; min-width: ${t.canvasWidth*(t.canvasZoom/100)+96}px; min-height: ${t.canvasHeight*(t.canvasZoom/100)+96}px; margin-top: 12px;`),Wt(s,`background-color: ${t.canvasBackgroundColor??""}; width: ${t.canvasWidth*(t.canvasZoom/100)}px; height: ${t.canvasHeight*(t.canvasZoom/100)}px;`)}),hn("wheel",c,function(..._){var y;(y=t.onWheel)==null||y.apply(this,_)}),rt(i,c),bt({get stageRef(){return M(b)},set stageRef(_){nt(b,pi(_))},updateTransformer:l})}var Ci={exports:{}},Ke={},Ze={},ur;function ol(){if(ur)return Ze;ur=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.Blur=void 0;const i=ut(),t=Rt(),b=gt();function u(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const g=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],l=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function h(c,r){const s=c.data,p=c.width,n=c.height;let e,f,_,y,k,d,o,m,x,P,L,A,T,S,E,F,v,C,w,R,G,N,I,O;const H=r+r+1,j=p-1,U=n-1,W=r+1,Z=W*(W+1)/2,tt=new u,D=g[r],B=l[r];let V=null,K=tt,et=null,it=null;for(_=1;_<H;_++)K=K.next=new u,_===W&&(V=K);for(K.next=tt,o=d=0,f=0;f<n;f++){for(F=v=C=w=m=x=P=L=0,A=W*(R=s[d]),T=W*(G=s[d+1]),S=W*(N=s[d+2]),E=W*(I=s[d+3]),m+=Z*R,x+=Z*G,P+=Z*N,L+=Z*I,K=tt,_=0;_<W;_++)K.r=R,K.g=G,K.b=N,K.a=I,K=K.next;for(_=1;_<W;_++)y=d+((j<_?j:_)<<2),m+=(K.r=R=s[y])*(O=W-_),x+=(K.g=G=s[y+1])*O,P+=(K.b=N=s[y+2])*O,L+=(K.a=I=s[y+3])*O,F+=R,v+=G,C+=N,w+=I,K=K.next;for(et=tt,it=V,e=0;e<p;e++)s[d+3]=I=L*D>>B,I!==0?(I=255/I,s[d]=(m*D>>B)*I,s[d+1]=(x*D>>B)*I,s[d+2]=(P*D>>B)*I):s[d]=s[d+1]=s[d+2]=0,m-=A,x-=T,P-=S,L-=E,A-=et.r,T-=et.g,S-=et.b,E-=et.a,y=o+((y=e+r+1)<j?y:j)<<2,F+=et.r=s[y],v+=et.g=s[y+1],C+=et.b=s[y+2],w+=et.a=s[y+3],m+=F,x+=v,P+=C,L+=w,et=et.next,A+=R=it.r,T+=G=it.g,S+=N=it.b,E+=I=it.a,F-=R,v-=G,C-=N,w-=I,it=it.next,d+=4;o+=p}for(e=0;e<p;e++){for(v=C=w=F=x=P=L=m=0,d=e<<2,A=W*(R=s[d]),T=W*(G=s[d+1]),S=W*(N=s[d+2]),E=W*(I=s[d+3]),m+=Z*R,x+=Z*G,P+=Z*N,L+=Z*I,K=tt,_=0;_<W;_++)K.r=R,K.g=G,K.b=N,K.a=I,K=K.next;for(k=p,_=1;_<=r;_++)d=k+e<<2,m+=(K.r=R=s[d])*(O=W-_),x+=(K.g=G=s[d+1])*O,P+=(K.b=N=s[d+2])*O,L+=(K.a=I=s[d+3])*O,F+=R,v+=G,C+=N,w+=I,K=K.next,_<U&&(k+=p);for(d=e,et=tt,it=V,f=0;f<n;f++)y=d<<2,s[y+3]=I=L*D>>B,I>0?(I=255/I,s[y]=(m*D>>B)*I,s[y+1]=(x*D>>B)*I,s[y+2]=(P*D>>B)*I):s[y]=s[y+1]=s[y+2]=0,m-=A,x-=T,P-=S,L-=E,A-=et.r,T-=et.g,S-=et.b,E-=et.a,y=e+((y=f+W)<U?y:U)*p<<2,m+=F+=et.r=s[y],x+=v+=et.g=s[y+1],P+=C+=et.b=s[y+2],L+=w+=et.a=s[y+3],et=et.next,A+=R=it.r,T+=G=it.g,S+=N=it.b,E+=I=it.a,F-=R,v-=G,C-=N,w-=I,it=it.next,d+=p}}const a=function(r){const s=Math.round(this.blurRadius());s>0&&h(r,s)};return Ze.Blur=a,i.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),Ze}var Qe={},fr;function ll(){if(fr)return Qe;fr=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.Brighten=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=this.brightness()*255,h=g.data,a=h.length;for(let c=0;c<a;c+=4)h[c]+=l,h[c+1]+=l,h[c+2]+=l};return Qe.Brighten=u,i.Factory.addGetterSetter(t.Node,"brightness",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),Qe}var Je={},gr;function hl(){if(gr)return Je;gr=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.Contrast=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=Math.pow((this.contrast()+100)/100,2),h=g.data,a=h.length;let c=150,r=150,s=150;for(let p=0;p<a;p+=4)c=h[p],r=h[p+1],s=h[p+2],c/=255,c-=.5,c*=l,c+=.5,c*=255,r/=255,r-=.5,r*=l,r+=.5,r*=255,s/=255,s-=.5,s*=l,s+=.5,s*=255,c=c<0?0:c>255?255:c,r=r<0?0:r>255?255:r,s=s<0?0:s>255?255:s,h[p]=c,h[p+1]=r,h[p+2]=s};return Je.Contrast=u,i.Factory.addGetterSetter(t.Node,"contrast",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),Je}var $e={},vr;function cl(){if(vr)return $e;vr=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.Emboss=void 0;const i=ut(),t=Rt(),b=At(),u=gt(),g=function(l){const h=this.embossStrength()*10,a=this.embossWhiteLevel()*255,c=this.embossDirection(),r=this.embossBlend(),s=l.data,p=l.width,n=l.height,e=p*4;let f=0,_=0,y=n;switch(c){case"top-left":f=-1,_=-1;break;case"top":f=-1,_=0;break;case"top-right":f=-1,_=1;break;case"right":f=0,_=1;break;case"bottom-right":f=1,_=1;break;case"bottom":f=1,_=0;break;case"bottom-left":f=1,_=-1;break;case"left":f=0,_=-1;break;default:b.Util.error("Unknown emboss direction: "+c)}do{const k=(y-1)*e;let d=f;y+d<1&&(d=0),y+d>n&&(d=0);const o=(y-1+d)*p*4;let m=p;do{const x=k+(m-1)*4;let P=_;m+P<1&&(P=0),m+P>p&&(P=0);const L=o+(m-1+P)*4,A=s[x]-s[L],T=s[x+1]-s[L+1],S=s[x+2]-s[L+2];let E=A;const F=E>0?E:-E,v=T>0?T:-T,C=S>0?S:-S;if(v>F&&(E=T),C>F&&(E=S),E*=h,r){const w=s[x]+E,R=s[x+1]+E,G=s[x+2]+E;s[x]=w>255?255:w<0?0:w,s[x+1]=R>255?255:R<0?0:R,s[x+2]=G>255?255:G<0?0:G}else{let w=a-E;w<0?w=0:w>255&&(w=255),s[x]=s[x+1]=s[x+2]=w}}while(--m)}while(--y)};return $e.Emboss=g,i.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,u.getNumberValidator)(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,u.getNumberValidator)(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,i.Factory.afterSetFilter),$e}var ti={},pr;function dl(){if(pr)return ti;pr=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Enhance=void 0;const i=ut(),t=Rt(),b=gt();function u(l,h,a,c,r){const s=a-h,p=r-c;if(s===0)return c+p/2;if(p===0)return c;let n=(l-h)/s;return n=p*n+c,n}const g=function(l){const h=l.data,a=h.length;let c=h[0],r=c,s,p=h[1],n=p,e,f=h[2],_=f,y;const k=this.enhance();if(k===0)return;for(let E=0;E<a;E+=4)s=h[E+0],s<c?c=s:s>r&&(r=s),e=h[E+1],e<p?p=e:e>n&&(n=e),y=h[E+2],y<f?f=y:y>_&&(_=y);r===c&&(r=255,c=0),n===p&&(n=255,p=0),_===f&&(_=255,f=0);let d,o,m,x,P,L,A,T,S;k>0?(o=r+k*(255-r),m=c-k*(c-0),P=n+k*(255-n),L=p-k*(p-0),T=_+k*(255-_),S=f-k*(f-0)):(d=(r+c)*.5,o=r+k*(r-d),m=c+k*(c-d),x=(n+p)*.5,P=n+k*(n-x),L=p+k*(p-x),A=(_+f)*.5,T=_+k*(_-A),S=f+k*(f-A));for(let E=0;E<a;E+=4)h[E+0]=u(h[E+0],c,r,m,o),h[E+1]=u(h[E+1],p,n,L,P),h[E+2]=u(h[E+2],f,_,S,T)};return ti.Enhance=g,i.Factory.addGetterSetter(t.Node,"enhance",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),ti}var ei={},_r;function ul(){if(_r)return ei;_r=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Grayscale=void 0;const i=function(t){const b=t.data,u=b.length;for(let g=0;g<u;g+=4){const l=.34*b[g]+.5*b[g+1]+.16*b[g+2];b[g]=l,b[g+1]=l,b[g+2]=l}};return ei.Grayscale=i,ei}var ii={},mr;function fl(){if(mr)return ii;mr=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.HSL=void 0;const i=ut(),t=Rt(),b=gt();i.Factory.addGetterSetter(t.Node,"hue",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"saturation",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"luminance",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter);const u=function(g){const l=g.data,h=l.length,a=1,c=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,s=this.luminance()*127,p=a*c*Math.cos(r*Math.PI/180),n=a*c*Math.sin(r*Math.PI/180),e=.299*a+.701*p+.167*n,f=.587*a-.587*p+.33*n,_=.114*a-.114*p-.497*n,y=.299*a-.299*p-.328*n,k=.587*a+.413*p+.035*n,d=.114*a-.114*p+.293*n,o=.299*a-.3*p+1.25*n,m=.587*a-.586*p-1.05*n,x=.114*a+.886*p-.2*n;let P,L,A,T;for(let S=0;S<h;S+=4)P=l[S+0],L=l[S+1],A=l[S+2],T=l[S+3],l[S+0]=e*P+f*L+_*A+s,l[S+1]=y*P+k*L+d*A+s,l[S+2]=o*P+m*L+x*A+s,l[S+3]=T};return ii.HSL=u,ii}var ni={},yr;function gl(){if(yr)return ni;yr=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.HSV=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=g.data,h=l.length,a=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,s=a*c*Math.cos(r*Math.PI/180),p=a*c*Math.sin(r*Math.PI/180),n=.299*a+.701*s+.167*p,e=.587*a-.587*s+.33*p,f=.114*a-.114*s-.497*p,_=.299*a-.299*s-.328*p,y=.587*a+.413*s+.035*p,k=.114*a-.114*s+.293*p,d=.299*a-.3*s+1.25*p,o=.587*a-.586*s-1.05*p,m=.114*a+.886*s-.2*p;let x,P,L,A;for(let T=0;T<h;T+=4)x=l[T+0],P=l[T+1],L=l[T+2],A=l[T+3],l[T+0]=n*x+e*P+f*L,l[T+1]=_*x+y*P+k*L,l[T+2]=d*x+o*P+m*L,l[T+3]=A};return ni.HSV=u,i.Factory.addGetterSetter(t.Node,"hue",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"saturation",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"value",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),ni}var ri={},br;function vl(){if(br)return ri;br=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.Invert=void 0;const i=function(t){const b=t.data,u=b.length;for(let g=0;g<u;g+=4)b[g]=255-b[g],b[g+1]=255-b[g+1],b[g+2]=255-b[g+2]};return ri.Invert=i,ri}var ai={},xr;function pl(){if(xr)return ai;xr=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.Kaleidoscope=void 0;const i=ut(),t=Rt(),b=At(),u=gt(),g=function(a,c,r){const s=a.data,p=c.data,n=a.width,e=a.height,f=r.polarCenterX||n/2,_=r.polarCenterY||e/2;let y=Math.sqrt(f*f+_*_),k=n-f,d=e-_;const o=Math.sqrt(k*k+d*d);y=o>y?o:y;const m=e,x=n,P=360/x*Math.PI/180;for(let L=0;L<x;L+=1){const A=Math.sin(L*P),T=Math.cos(L*P);for(let S=0;S<m;S+=1){k=Math.floor(f+y*S/m*T),d=Math.floor(_+y*S/m*A);let E=(d*n+k)*4;const F=s[E+0],v=s[E+1],C=s[E+2],w=s[E+3];E=(L+S*n)*4,p[E+0]=F,p[E+1]=v,p[E+2]=C,p[E+3]=w}}},l=function(a,c,r){const s=a.data,p=c.data,n=a.width,e=a.height,f=r.polarCenterX||n/2,_=r.polarCenterY||e/2;let y=Math.sqrt(f*f+_*_),k=n-f,d=e-_;const o=Math.sqrt(k*k+d*d);y=o>y?o:y;const m=e,x=n,P=0;let L,A;for(k=0;k<n;k+=1)for(d=0;d<e;d+=1){const T=k-f,S=d-_,E=Math.sqrt(T*T+S*S)*m/y;let F=(Math.atan2(S,T)*180/Math.PI+360+P)%360;F=F*x/360,L=Math.floor(F),A=Math.floor(E);let v=(A*n+L)*4;const C=s[v+0],w=s[v+1],R=s[v+2],G=s[v+3];v=(d*n+k)*4,p[v+0]=C,p[v+1]=w,p[v+2]=R,p[v+3]=G}},h=function(a){const c=a.width,r=a.height;let s,p,n,e,f,_,y,k,d,o,m=Math.round(this.kaleidoscopePower());const x=Math.round(this.kaleidoscopeAngle()),P=Math.floor(c*(x%360)/360);if(m<1)return;const L=b.Util.createCanvasElement();L.width=c,L.height=r;const A=L.getContext("2d").getImageData(0,0,c,r);b.Util.releaseCanvas(L),g(a,A,{polarCenterX:c/2,polarCenterY:r/2});let T=c/Math.pow(2,m);for(;T<=8;)T=T*2,m-=1;T=Math.ceil(T);let S=T,E=0,F=S,v=1;for(P+T>c&&(E=S,F=0,v=-1),p=0;p<r;p+=1)for(s=E;s!==F;s+=v)n=Math.round(s+P)%c,d=(c*p+n)*4,f=A.data[d+0],_=A.data[d+1],y=A.data[d+2],k=A.data[d+3],o=(c*p+s)*4,A.data[o+0]=f,A.data[o+1]=_,A.data[o+2]=y,A.data[o+3]=k;for(p=0;p<r;p+=1)for(S=Math.floor(T),e=0;e<m;e+=1){for(s=0;s<S+1;s+=1)d=(c*p+s)*4,f=A.data[d+0],_=A.data[d+1],y=A.data[d+2],k=A.data[d+3],o=(c*p+S*2-s-1)*4,A.data[o+0]=f,A.data[o+1]=_,A.data[o+2]=y,A.data[o+3]=k;S*=2}l(A,a,{})};return ai.Kaleidoscope=h,i.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,u.getNumberValidator)(),i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,u.getNumberValidator)(),i.Factory.afterSetFilter),ai}var si={},wr;function _l(){if(wr)return si;wr=1,Object.defineProperty(si,"__esModule",{value:!0}),si.Mask=void 0;const i=ut(),t=Rt(),b=gt();function u(n,e,f){let _=(f*n.width+e)*4;const y=[];return y.push(n.data[_++],n.data[_++],n.data[_++],n.data[_++]),y}function g(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function l(n){const e=[0,0,0];for(let f=0;f<n.length;f++)e[0]+=n[f][0],e[1]+=n[f][1],e[2]+=n[f][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function h(n,e){const f=u(n,0,0),_=u(n,n.width-1,0),y=u(n,0,n.height-1),k=u(n,n.width-1,n.height-1),d=e||10;if(g(f,_)<d&&g(_,k)<d&&g(k,y)<d&&g(y,f)<d){const o=l([_,f,k,y]),m=[];for(let x=0;x<n.width*n.height;x++){const P=g(o,[n.data[x*4],n.data[x*4+1],n.data[x*4+2]]);m[x]=P<d?0:255}return m}}function a(n,e){for(let f=0;f<n.width*n.height;f++)n.data[4*f+3]=e[f]}function c(n,e,f){const _=[1,1,1,1,0,1,1,1,1],y=Math.round(Math.sqrt(_.length)),k=Math.floor(y/2),d=[];for(let o=0;o<f;o++)for(let m=0;m<e;m++){const x=o*e+m;let P=0;for(let L=0;L<y;L++)for(let A=0;A<y;A++){const T=o+L-k,S=m+A-k;if(T>=0&&T<f&&S>=0&&S<e){const E=T*e+S,F=_[L*y+A];P+=n[E]*F}}d[x]=P===255*8?255:0}return d}function r(n,e,f){const _=[1,1,1,1,1,1,1,1,1],y=Math.round(Math.sqrt(_.length)),k=Math.floor(y/2),d=[];for(let o=0;o<f;o++)for(let m=0;m<e;m++){const x=o*e+m;let P=0;for(let L=0;L<y;L++)for(let A=0;A<y;A++){const T=o+L-k,S=m+A-k;if(T>=0&&T<f&&S>=0&&S<e){const E=T*e+S,F=_[L*y+A];P+=n[E]*F}}d[x]=P>=255*4?255:0}return d}function s(n,e,f){const _=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],y=Math.round(Math.sqrt(_.length)),k=Math.floor(y/2),d=[];for(let o=0;o<f;o++)for(let m=0;m<e;m++){const x=o*e+m;let P=0;for(let L=0;L<y;L++)for(let A=0;A<y;A++){const T=o+L-k,S=m+A-k;if(T>=0&&T<f&&S>=0&&S<e){const E=T*e+S,F=_[L*y+A];P+=n[E]*F}}d[x]=P}return d}const p=function(n){const e=this.threshold();let f=h(n,e);return f&&(f=c(f,n.width,n.height),f=r(f,n.width,n.height),f=s(f,n.width,n.height),a(n,f)),n};return si.Mask=p,i.Factory.addGetterSetter(t.Node,"threshold",0,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),si}var oi={},Sr;function ml(){if(Sr)return oi;Sr=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Noise=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=this.noise()*255,h=g.data,a=h.length,c=l/2;for(let r=0;r<a;r+=4)h[r+0]+=c-2*c*Math.random(),h[r+1]+=c-2*c*Math.random(),h[r+2]+=c-2*c*Math.random()};return oi.Noise=u,i.Factory.addGetterSetter(t.Node,"noise",.2,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),oi}var li={},Cr;function yl(){if(Cr)return li;Cr=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Pixelate=void 0;const i=ut(),t=At(),b=Rt(),u=gt(),g=function(l){let h=Math.ceil(this.pixelSize()),a=l.width,c=l.height,r,s,p,n,e,f,_,y=Math.ceil(a/h),k=Math.ceil(c/h),d,o,m,x,P,L,A,T=l.data;if(h<=0){t.Util.error("pixelSize value can not be <= 0");return}for(P=0;P<y;P+=1)for(L=0;L<k;L+=1){for(n=0,e=0,f=0,_=0,d=P*h,o=d+h,m=L*h,x=m+h,A=0,r=d;r<o;r+=1)if(!(r>=a))for(s=m;s<x;s+=1)s>=c||(p=(a*s+r)*4,n+=T[p+0],e+=T[p+1],f+=T[p+2],_+=T[p+3],A+=1);for(n=n/A,e=e/A,f=f/A,_=_/A,r=d;r<o;r+=1)if(!(r>=a))for(s=m;s<x;s+=1)s>=c||(p=(a*s+r)*4,T[p+0]=n,T[p+1]=e,T[p+2]=f,T[p+3]=_)}};return li.Pixelate=g,i.Factory.addGetterSetter(b.Node,"pixelSize",8,(0,u.getNumberValidator)(),i.Factory.afterSetFilter),li}var hi={},kr;function bl(){if(kr)return hi;kr=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Posterize=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=Math.round(this.levels()*254)+1,h=g.data,a=h.length,c=255/l;for(let r=0;r<a;r+=1)h[r]=Math.floor(h[r]/c)*c};return hi.Posterize=u,i.Factory.addGetterSetter(t.Node,"levels",.5,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),hi}var ci={},Pr;function xl(){if(Pr)return ci;Pr=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.RGB=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=g.data,h=l.length,a=this.red(),c=this.green(),r=this.blue();for(let s=0;s<h;s+=4){const p=(.34*l[s]+.5*l[s+1]+.16*l[s+2])/255;l[s]=p*a,l[s+1]=p*c,l[s+2]=p*r,l[s+3]=l[s+3]}};return ci.RGB=u,i.Factory.addGetterSetter(t.Node,"red",0,function(g){return this._filterUpToDate=!1,g>255?255:g<0?0:Math.round(g)}),i.Factory.addGetterSetter(t.Node,"green",0,function(g){return this._filterUpToDate=!1,g>255?255:g<0?0:Math.round(g)}),i.Factory.addGetterSetter(t.Node,"blue",0,b.RGBComponent,i.Factory.afterSetFilter),ci}var di={},Tr;function wl(){if(Tr)return di;Tr=1,Object.defineProperty(di,"__esModule",{value:!0}),di.RGBA=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=g.data,h=l.length,a=this.red(),c=this.green(),r=this.blue(),s=this.alpha();for(let p=0;p<h;p+=4){const n=1-s;l[p]=a*s+l[p]*n,l[p+1]=c*s+l[p+1]*n,l[p+2]=r*s+l[p+2]*n}};return di.RGBA=u,i.Factory.addGetterSetter(t.Node,"red",0,function(g){return this._filterUpToDate=!1,g>255?255:g<0?0:Math.round(g)}),i.Factory.addGetterSetter(t.Node,"green",0,function(g){return this._filterUpToDate=!1,g>255?255:g<0?0:Math.round(g)}),i.Factory.addGetterSetter(t.Node,"blue",0,b.RGBComponent,i.Factory.afterSetFilter),i.Factory.addGetterSetter(t.Node,"alpha",1,function(g){return this._filterUpToDate=!1,g>1?1:g<0?0:g}),di}var ui={},Ar;function Sl(){if(Ar)return ui;Ar=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Sepia=void 0;const i=function(t){const b=t.data,u=b.length;for(let g=0;g<u;g+=4){const l=b[g+0],h=b[g+1],a=b[g+2];b[g+0]=Math.min(255,l*.393+h*.769+a*.189),b[g+1]=Math.min(255,l*.349+h*.686+a*.168),b[g+2]=Math.min(255,l*.272+h*.534+a*.131)}};return ui.Sepia=i,ui}var fi={},Er;function Cl(){if(Er)return fi;Er=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.Solarize=void 0;const i=function(t){const b=t.data,u=t.width,g=t.height,l=u*4;let h=g;do{const a=(h-1)*l;let c=u;do{const r=a+(c-1)*4;let s=b[r],p=b[r+1],n=b[r+2];s>127&&(s=255-s),p>127&&(p=255-p),n>127&&(n=255-n),b[r]=s,b[r+1]=p,b[r+2]=n}while(--c)}while(--h)};return fi.Solarize=i,fi}var gi={},Rr;function kl(){if(Rr)return gi;Rr=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Threshold=void 0;const i=ut(),t=Rt(),b=gt(),u=function(g){const l=this.threshold()*255,h=g.data,a=h.length;for(let c=0;c<a;c+=1)h[c]=h[c]<l?0:255};return gi.Threshold=u,i.Factory.addGetterSetter(t.Node,"threshold",.5,(0,b.getNumberValidator)(),i.Factory.afterSetFilter),gi}var Mr;function Pl(){if(Mr)return Ke;Mr=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.Konva=void 0;const i=nn(),t=Co(),b=ra(),u=sa(),g=la(),l=ua(),h=Bo(),a=na(),c=un(),r=vn(),s=ga(),p=Xo(),n=Wo(),e=va(),f=pn(),_=Qo(),y=_a(),k=tl(),d=ol(),o=ll(),m=hl(),x=cl(),P=dl(),L=ul(),A=fl(),T=gl(),S=vl(),E=pl(),F=_l(),v=ml(),C=yl(),w=bl(),R=xl(),G=wl(),N=Sl(),I=Cl(),O=kl();return Ke.Konva=i.Konva.Util._assign(i.Konva,{Arc:t.Arc,Arrow:b.Arrow,Circle:u.Circle,Ellipse:g.Ellipse,Image:l.Image,Label:h.Label,Tag:h.Tag,Line:a.Line,Path:c.Path,Rect:r.Rect,RegularPolygon:s.RegularPolygon,Ring:p.Ring,Sprite:n.Sprite,Star:e.Star,Text:f.Text,TextPath:_.TextPath,Transformer:y.Transformer,Wedge:k.Wedge,Filters:{Blur:d.Blur,Brighten:o.Brighten,Contrast:m.Contrast,Emboss:x.Emboss,Enhance:P.Enhance,Grayscale:L.Grayscale,HSL:A.HSL,HSV:T.HSV,Invert:S.Invert,Kaleidoscope:E.Kaleidoscope,Mask:F.Mask,Noise:v.Noise,Pixelate:C.Pixelate,Posterize:w.Posterize,RGB:R.RGB,RGBA:G.RGBA,Sepia:N.Sepia,Solarize:I.Solarize,Threshold:O.Threshold}}),Ke}var Tl=Ci.exports,Fr;function Al(){if(Fr)return Ci.exports;Fr=1,Object.defineProperty(Tl,"__esModule",{value:!0});const i=Pl();return Ci.exports=i.Konva,Ci.exports}var El=Al();const Rl=$r(El);var Ml=at('<div><label class="flex items-center"><input type="checkbox" class="mr-2 text-purple-600"/> <div><div class="font-medium text-sm">Transparent background</div> <div class="text-xs text-gray-500">Remove background for overlays</div></div></label></div>'),Fl=at('<div class="fixed top-16 right-6 z-50"><div class="bg-white rounded-lg p-6 w-80 shadow-xl border border-gray-200"><div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold text-gray-900">Download Design</h3> <button class="text-gray-400 hover:text-gray-600"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">File type</label> <div class="space-y-2"><label class="flex items-center cursor-pointer"><input type="radio" name="downloadFormat" class="mr-3 text-purple-600"/> <div><div class="font-medium">PNG</div> <div class="text-xs text-gray-500">Best for graphics with transparency</div></div></label> <label class="flex items-center cursor-pointer"><input type="radio" name="downloadFormat" class="mr-3 text-purple-600"/> <div><div class="font-medium">JPG</div> <div class="text-xs text-gray-500">Smaller file size, great for photos</div></div></label> <label class="flex items-center cursor-pointer"><input type="radio" name="downloadFormat" class="mr-3 text-purple-600"/> <div><div class="font-medium">SVG</div> <div class="text-xs text-gray-500">Vector format, scalable</div></div></label></div></div> <div><label class="block text-sm font-medium text-gray-700 mb-2">Size & quality</label> <div class="space-y-2"><label class="flex items-center cursor-pointer"><input type="radio" name="downloadQuality" class="mr-3 text-purple-600"/> <div><div class="font-medium">Small</div> <div class="text-xs text-gray-500">250 × 200 px</div> <div class="text-xs text-gray-400">Quick sharing</div></div></label> <label class="flex items-center cursor-pointer"><input type="radio" name="downloadQuality" class="mr-3 text-purple-600"/> <div><div class="font-medium">Standard</div> <div class="text-xs text-gray-500">500 × 400 px</div> <div class="text-xs text-gray-400">Perfect for web</div></div></label> <label class="flex items-center cursor-pointer"><input type="radio" name="downloadQuality" class="mr-3 text-purple-600"/> <div><div class="font-medium">High quality</div> <div class="text-xs text-gray-500">1000 × 800 px</div> <div class="text-xs text-gray-400">Great for presentations</div></div></label> <label class="flex items-center cursor-pointer"><input type="radio" name="downloadQuality" class="mr-3 text-purple-600"/> <div><div class="font-medium">Ultra HD</div> <div class="text-xs text-gray-500">1500 × 1200 px</div> <div class="text-xs text-gray-400">High resolution</div></div></label> <label class="flex items-center cursor-pointer"><input type="radio" name="downloadQuality" class="mr-3 text-purple-600"/> <div><div class="font-medium">Print quality</div> <div class="text-xs text-gray-500">2000 × 1600 px</div> <div class="text-xs text-gray-400">Best for printing</div></div></label></div></div> <!> <div class="flex space-x-3 pt-4"><button class="flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors">Cancel</button> <button class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">Download</button></div></div></div></div>');function Gl(i,t){yt(t,!0);const b=[],u=[],g={PNG:"png",JPG:"jpg",SVG:"svg"},l={SMALL:"small",STANDARD:"standard",HIGH:"high",ULTRA:"ultra",PRINT:"print"},h={JPEG:"image/jpeg",PNG:"image/png",SVG_XML:"image/svg+xml"},a={FILL_COLOR:"#000000",STROKE_NONE:"none",FONT_FAMILY:"Arial",FONT_SIZE:16,FONT_WEIGHT:"normal"};let c=mt(pi(g.PNG)),r=mt(pi(l.STANDARD)),s=mt(!1);function p(y,k,d){const o=y.width(),m=y.height();let x=`<svg width="${o}" height="${m}" xmlns="http://www.w3.org/2000/svg">`;return d&&(x+=`<rect width="${o}" height="${m}" fill="${k}"/>`),y.children.forEach(L=>{if(!L.visible())return;L.children.forEach(T=>{if(!T.visible()||T.className==="Transformer")return;const S=T.attrs,E=S.x||0,F=S.y||0,v=S.fill||a.FILL_COLOR,C=S.stroke||a.STROKE_NONE,w=S.strokeWidth||0,R=S.scaleX||1,G=S.scaleY||1,N=S.rotation||0;let I="";if(R!==1||G!==1||N!==0){let H,j;S.radius?(H=E+S.radius,j=F+S.radius):S.radiusX&&S.radiusY?(H=E+S.radiusX,j=F+S.radiusY):(H=E+(S.width||0)/2,j=F+(S.height||0)/2),I=`transform="translate(${H},${j}) scale(${R},${G}) rotate(${N*180/Math.PI}) translate(${-H},${-j})"`}const O=S.subType||T.className;switch(O){case J.Rectangle:case J.Square:case"Rect":x+=`<rect x="${E}" y="${F}" width="${S.width}" height="${S.height}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`;break;case J.Circle:case"Circle":const H=S.radius;x+=`<circle cx="${E+H}" cy="${F+H}" r="${H}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`;break;case J.Ellipse:case"Ellipse":const j=S.radiusX||50,U=S.radiusY||30;x+=`<ellipse cx="${E+j}" cy="${F+U}" rx="${j}" ry="${U}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`;break;case"Text":x+=`<text x="${E}" y="${F+(S.fontSize||a.FONT_SIZE)}" font-family="${S.fontFamily||a.FONT_FAMILY}" font-size="${S.fontSize||a.FONT_SIZE}" font-weight="${S.fontWeight||a.FONT_WEIGHT}" fill="${v}" ${I}>${S.text||""}</text>`;break;case J.Triangle:case J.Pentagon:case J.Hexagon:case J.Diamond:case"RegularPolygon":const W=S.sides||3,Z=S.radius,tt=E+Z,D=F+Z;let B="";const V=O===J.Diamond?Math.PI/4:0;for(let kt=0;kt<W;kt++){const Dt=kt*2*Math.PI/W-Math.PI/2+V,Gt=tt+Z*Math.cos(Dt),It=D+Z*Math.sin(Dt);B+=`${Gt},${It} `}x+=`<polygon points="${B.trim()}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`;break;case J.Star:case"Star":const K=S.numPoints||5,et=S.innerRadius,it=S.outerRadius,ht=E+it,ct=F+it;let st="";for(let kt=0;kt<K*2;kt++){const Dt=kt%2===0?it:et,Gt=kt*Math.PI/K-Math.PI/2,It=ht+Dt*Math.cos(Gt),qt=ct+Dt*Math.sin(Gt);st+=`${It},${qt} `}x+=`<polygon points="${st.trim()}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`;break;case J.Arrow:case"Arrow":const Ct=S.points||[];if(Ct.length>=4){const kt=E+Ct[0],Dt=F+Ct[1],Gt=E+Ct[2],It=F+Ct[3],qt=S.pointerLength||15,se=S.pointerWidth||10,Bt=Gt-kt,Ut=It-Dt,Yt=Math.sqrt(Bt*Bt+Ut*Ut),Se=Bt/Yt,mi=Ut/Yt,Mi=Gt-Se*qt,Fi=It-mi*qt,mn=-mi*(se/2),yn=Se*(se/2);x+=`<line x1="${kt}" y1="${Dt}" x2="${Mi}" y2="${Fi}" stroke="${C}" stroke-width="${w}" stroke-linecap="round" ${I}/>`;const ba=`${Gt},${It} ${Mi+mn},${Fi+yn} ${Mi-mn},${Fi-yn}`;x+=`<polygon points="${ba}" fill="${v}" stroke="${C}" stroke-width="${w}" stroke-linejoin="round" ${I}/>`}break;case J.Heart:const ot=S.width||50,lt=S.height||45,vt=`M ${E+ot/2} ${F+lt*.9} 
							C ${E+ot/2} ${F+lt*.6}, ${E+ot*.1} ${F+lt*.6}, ${E+ot*.1} ${F+lt*.35}
							C ${E+ot*.1} ${F+lt*.15}, ${E+ot*.3} ${F+lt*.1}, ${E+ot/2} ${F+lt*.25}
							C ${E+ot*.7} ${F+lt*.1}, ${E+ot*.9} ${F+lt*.15}, ${E+ot*.9} ${F+lt*.35}
							C ${E+ot*.9} ${F+lt*.6}, ${E+ot/2} ${F+lt*.6}, ${E+ot/2} ${F+lt*.9} Z`;x+=`<path d="${vt}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`;break;case J.Cross:const wt=S.width||100,zt=S.height||100,$=S.thickness||20;x+=`<rect x="${E+(wt-$)/2}" y="${F}" width="${$}" height="${zt}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`,x+=`<rect x="${E}" y="${F+(zt-$)/2}" width="${wt}" height="${$}" fill="${v}" stroke="${C}" stroke-width="${w}" ${I}/>`;break;case"Image":const Et=S.width||100,Ot=S.height||100,Ht=S.src||"";Ht&&(x+=`<image x="${E}" y="${F}" width="${Et}" height="${Ot}" href="${Ht}" opacity="${S.opacity||1}" ${I}/>`);break}})}),x+="</svg>",x}function n(){if(!t.stageRef)return;const k={[l.SMALL]:{multiplier:.5,width:250,height:200},[l.STANDARD]:{multiplier:1,width:500,height:400},[l.HIGH]:{multiplier:2,width:1e3,height:800},[l.ULTRA]:{multiplier:3,width:1500,height:1200},[l.PRINT]:{multiplier:4,width:2e3,height:1600}}[M(r)],d=t.stageRef.node;if(!d||!d.toDataURL)return;const o=d.find("Transformer"),m=[];o.forEach((E,F)=>{m[F]=E.visible(),E.visible(!1)});let x=null;const P=M(c)===g.JPG||!M(s);if(P){x=new Rl.Rect({x:0,y:0,width:d.width(),height:d.height(),fill:t.canvasBackgroundColor,listening:!1});const E=d.children[0];E&&(E.add(x),x.moveToBottom(),E.batchDraw())}let L;M(c)===g.SVG?L=p(d,t.canvasBackgroundColor,P):L=d.toDataURL({mimeType:M(c)===g.JPG?h.JPEG:h.PNG,quality:M(c)===g.JPG?.9:1,pixelRatio:k.multiplier}),o.forEach((E,F)=>{E.visible(m[F])}),x&&x.destroy();const A=d.children[0];A&&A.batchDraw();const T=document.createElement("a"),S=`${t.designTitle.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.${M(c)}`;if(T.download=S,M(c)===g.SVG){const E=new Blob([L],{type:h.SVG_XML});T.href=URL.createObjectURL(E)}else T.href=L;T.style.display="none";try{if(document.body.appendChild(T),T.click)T.click();else{const E=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});T.dispatchEvent(E)}setTimeout(()=>{document.body.contains(T)&&document.body.removeChild(T)},100),t.onClose()}catch{}}var e=oe(),f=Nt(e);{var _=y=>{var k=Fl(),d=q(k),o=q(d),m=Q(q(o),2);m.__click=function(...vt){var wt;(wt=t.onClose)==null||wt.apply(this,vt)},z(o);var x=Q(o,2),P=q(x),L=Q(q(P),2),A=q(L),T=q(A);Lt(T);var S;$t(2),z(A);var E=Q(A,2),F=q(E);Lt(F);var v;$t(2),z(E);var C=Q(E,2),w=q(C);Lt(w);var R;$t(2),z(C),z(L),z(P);var G=Q(P,2),N=Q(q(G),2),I=q(N),O=q(I);Lt(O);var H;$t(2),z(I);var j=Q(I,2),U=q(j);Lt(U);var W;$t(2),z(j);var Z=Q(j,2),tt=q(Z);Lt(tt);var D;$t(2),z(Z);var B=Q(Z,2),V=q(B);Lt(V);var K;$t(2),z(B);var et=Q(B,2),it=q(et);Lt(it);var ht;$t(2),z(et),z(N),z(G);var ct=Q(G,2);{var st=vt=>{var wt=Ml(),zt=q(wt),$=q(zt);Lt($),$t(2),z(zt),z(wt),Ja($,()=>M(s),Et=>nt(s,Et)),rt(vt,wt)};xt(ct,vt=>{M(c)!==g.JPG&&vt(st)})}var Ct=Q(ct,2),ot=q(Ct);ot.__click=function(...vt){var wt;(wt=t.onClose)==null||wt.apply(this,vt)};var lt=Q(ot,2);lt.__click=n,z(Ct),z(x),z(d),z(k),St(()=>{S!==(S=g.PNG)&&(T.value=(T.__value=g.PNG)??""),v!==(v=g.JPG)&&(F.value=(F.__value=g.JPG)??""),R!==(R=g.SVG)&&(w.value=(w.__value=g.SVG)??""),H!==(H=l.SMALL)&&(O.value=(O.__value=l.SMALL)??""),W!==(W=l.STANDARD)&&(U.value=(U.__value=l.STANDARD)??""),D!==(D=l.HIGH)&&(tt.value=(tt.__value=l.HIGH)??""),K!==(K=l.ULTRA)&&(V.value=(V.__value=l.ULTRA)??""),ht!==(ht=l.PRINT)&&(it.value=(it.__value=l.PRINT)??"")}),ve(b,[],T,()=>M(c),vt=>nt(c,vt)),ve(b,[],F,()=>M(c),vt=>nt(c,vt)),ve(b,[],w,()=>M(c),vt=>nt(c,vt)),ve(u,[],O,()=>M(r),vt=>nt(r,vt)),ve(u,[],U,()=>M(r),vt=>nt(r,vt)),ve(u,[],tt,()=>M(r),vt=>nt(r,vt)),ve(u,[],V,()=>M(r),vt=>nt(r,vt)),ve(u,[],it,()=>M(r),vt=>nt(r,vt)),rt(y,k)};xt(f,y=>{t.isOpen&&y(_)})}rt(i,e),bt()}re(["click"]);var Ll=(i,t,b,u)=>{(i.key==="Enter"||i.key==="Escape")&&(nt(t,!1),b.onTitleChange(u()))},Dl=at('<input type="text" class="text-xl font-semibold text-gray-900 bg-transparent border-none outline-none focus:bg-gray-50 rounded px-2 py-1"/>'),Nl=(i,t)=>nt(t,!0),Ol=at('<button class="text-xl font-semibold text-gray-900 cursor-pointer hover:bg-gray-50 rounded px-2 py-1 transition-colors bg-transparent border-none" aria-label="Edit design title"> </button>'),Il=at('<div class="flex-1 flex items-center"><!></div>');function Bl(i,t){yt(t,!0);let b=Y(t,"title",7),u=mt(!1);function g(r){return r.focus(),{destroy(){}}}var l=Il(),h=q(l);{var a=r=>{var s=Dl();Lt(s),s.__keydown=[Ll,u,t,b],Br(()=>tn(s,b)),Qa(s,p=>g==null?void 0:g(p)),hn("blur",s,()=>{nt(u,!1),t.onTitleChange(b())}),rt(r,s)},c=r=>{var s=Ol();s.__click=[Nl,u];var p=q(s,!0);z(s),St(()=>ee(p,b())),rt(r,s)};xt(h,r=>{M(u)?r(a):r(c,!1)})}z(l),rt(i,l),bt()}re(["keydown","click"]);const Ul={ExportButton:"Download"},Gr={SidebarClosedWidth:"80px",EditBarHeight:"80px"};var Hl=at('<div class="fixed left-0 right-0 top-0 z-50 flex items-center bg-white border-b border-gray-200 shadow-sm" style="height: 64px;"><div class="flex w-20 items-center justify-center bg-gray-50 border-r border-gray-200" style="height: 64px;"><div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path></svg></div></div> <div class="flex-1 flex items-center justify-between px-6"><!> <div class="flex items-center space-x-4"><div class="flex items-center gap-1"><button class="flex h-8 w-8 items-center justify-center rounded border border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" title="Undo"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"></path></svg></button> <button class="flex h-8 w-8 items-center justify-center rounded border border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" title="Redo"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 7v6h-6"></path><path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"></path></svg></button></div> <button class="rounded-lg bg-purple-600 px-6 py-2 text-sm font-medium text-white transition-colors hover:bg-purple-700"> </button></div></div></div>');function Yl(i,t){yt(t,!0);var b=Hl(),u=Q(q(b),2),g=q(u);Bl(g,{get title(){return t.title},get onTitleChange(){return t.onTitleChange}});var l=Q(g,2),h=q(l),a=q(h);a.__click=function(...p){var n;(n=t.onUndo)==null||n.apply(this,p)};var c=Q(a,2);c.__click=function(...p){var n;(n=t.onRedo)==null||n.apply(this,p)},z(h);var r=Q(h,2);r.__click=function(...p){var n;(n=t.onExportClick)==null||n.apply(this,p)};var s=q(r,!0);z(r),z(l),z(u),z(b),St(()=>{a.disabled=!t.canUndo,c.disabled=!t.canRedo,ee(s,Ul.ExportButton)}),rt(i,b),bt()}re(["click"]);function Xl(i,t){const b=i.target.value;he.update(u=>u.map(g=>g.id===t.editingTextId?{...g,text:b}:g))}function Vl(i,t){(i.key==="Enter"||i.key==="Escape")&&t.onClose()}var Wl=at('<input type="text"/>');function zl(i,t){yt(t,!0);let b=null;const u=ft(()=>t.editingTextId?t.textElements.find(r=>r.id===t.editingTextId):null);function g(){t.onClose()}function l(r,s,p){if(!s)return;const n=s.getNode?s.getNode():s.node||s._node;if(!n)return;const e=n.container().getBoundingClientRect(),f=p/100;setTimeout(()=>{b&&(b.style.left=e.left+r.x*f+"px",b.style.top=e.top+r.y*f+"px",b.style.width=Math.max((r.width||150)*f,100)+"px",b.style.fontSize=r.fontSize*f+"px",b.focus(),b.select())},10)}var h=oe(),a=Nt(h);{var c=r=>{var s=Wl();Lt(s),s.__input=[Xl,t],s.__keydown=[Vl,t],Qt(s,p=>b=p,()=>b),St(()=>{Te(s,M(u).text),Wt(s,`position: absolute; font-family: ${M(u).fontFamily??""}; font-size: ${M(u).fontSize??""}px; font-weight: ${M(u).fontWeight??""}; color: ${M(u).fill??""}; background: white; border: 2px solid #3b82f6; border-radius: 4px; padding: 4px; z-index: 1000; outline: none;`)}),hn("blur",s,g),rt(r,s)};xt(a,r=>{t.editingTextId&&M(u)&&r(c)})}return rt(i,h),bt({positionInput:l})}re(["input","keydown"]);function ql(i){return function(b,u){const g=u.target,l=i/100;ds(b.id,g.x()/l,g.y()/l),Kt.pushState()}}function jl(i){return function(b,u){const g=u.target,l=i/100;Qr(b.id,g.x()/l,g.y()/l),Kt.pushState()}}function Kl(i,t){return function(u){if(!u.ctrlKey&&!u.metaKey)return;u.preventDefault();const g=10;let l;u.deltaY>0?l=Math.max(25,i-g):l=Math.min(500,i+g),t(l)}}function Zl(){let i=!1,t={x:0,y:0},b=null;return{handleMouseDown:a=>{(a.button===1||a.button===0&&a.altKey)&&(i=!0,t={x:a.clientX,y:a.clientY},a.preventDefault())},handleMouseMove:a=>{if(!i||!b)return;const c=a.clientX-t.x,r=a.clientY-t.y,s=b,p=s.position();s.position({x:p.x+c,y:p.y+r}),t={x:a.clientX,y:a.clientY}},handleMouseUp:()=>{i=!1},setStageRef:a=>{b=a}}}const Zt={Fill:"fill",Stroke:"stroke",StrokeWidth:"strokeWidth",Opacity:"opacity",FontFamily:"fontFamily",FontSize:"fontSize",Brightness:"brightness",Contrast:"contrast"};function ma(i,t){cn(i,{get value(){return t.value},get onUpdate(){return t.onUpdate}})}var Ql=(i,t)=>nt(t,!M(t)),Jl=(i,t,b)=>t(M(b)),$l=at('<button type="button" class="w-full px-3 py-2 text-left hover:bg-gray-50 rounded flex items-center justify-center"><div class="w-6 bg-gray-700"></div></button>'),th=at('<div class="fixed w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-[999999]"></div>'),eh=(i,t)=>nt(t,!1),ih=at('<div class="fixed inset-0 z-[999998]"></div>'),nh=at('<div class="flex items-center gap-4"><!> <div class="relative"><button type="button" class="flex items-center gap-2 px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-purple-500"><div class="w-6 h-px bg-gray-700"></div> <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6,9 12,15 18,9"></polyline></svg></button> <!> <!></div></div>');function ya(i,t){yt(t,!0);let b=mt(!1),u=mt(void 0);const g=[0,1,2,3,4,5,6,8,10,12,16,20];function l(y){t.onUpdateWidth(y),nt(b,!1)}var h=nh(),a=q(h);cn(a,{get value(){return t.color},get onUpdate(){return t.onUpdateColor},get type(){return ke.Border}});var c=Q(a,2),r=q(c);r.__click=[Ql,b];var s=q(r),p=Q(s,2);z(r),Qt(r,y=>nt(u,y),()=>M(u));var n=Q(r,2);{var e=y=>{var k=th();const d=ft(()=>{var o;return(o=M(u))==null?void 0:o.getBoundingClientRect()});de(k,21,()=>g,we,(o,m)=>{var x=$l();x.__click=[Jl,l,m];var P=q(x);z(x),St(()=>Wt(P,`height: ${M(m)??""}px;`)),rt(o,x)}),z(k),St(()=>Wt(k,`top: ${M(d)?M(d).bottom+4:0}px; left: ${(M(d)?M(d).left:0)??""}px;`)),rt(y,k)};xt(n,y=>{M(b)&&y(e)})}var f=Q(n,2);{var _=y=>{var k=ih();k.__click=[eh,b],rt(y,k)};xt(f,y=>{M(b)&&y(_)})}z(c),z(h),St(()=>{Wt(s,`height: ${t.width??""}px;`),ye(p,0,`transition-transform ${M(b)?"rotate-180":""}`)}),rt(i,h),bt()}re(["click"]);var rh=(i,t)=>{const b=+i.target.value;t.onUpdate(b)},ah=at('<div class="flex items-center gap-2"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-600"><circle cx="12" cy="12" r="8" opacity="0.3"></circle><circle cx="12" cy="12" r="5" opacity="0.6"></circle><circle cx="12" cy="12" r="2" opacity="1"></circle></svg> <input id="opacity" type="range" min="0" max="1" step="0.01" class="w-20 focus:outline-none focus:ring-2 focus:ring-purple-500"/> <span class="text-sm text-gray-500 w-8"> </span></div>');function _n(i,t){yt(t,!0);var b=ah(),u=Q(q(b),2);Lt(u),u.__input=[rh,t];var g=Q(u,2),l=q(g);z(g),z(b),St(h=>{Te(u,t.value),ee(l,`${h??""}%`)},[()=>Math.round(t.value*100)]),rt(i,b),bt()}re(["input"]);var sh=at('<div class="flex items-center gap-4"><!> <div class="h-6 w-px bg-gray-200"></div> <!> <div class="h-6 w-px bg-gray-200"></div> <!></div>');function Jt(i,t){yt(t,!0);var b=sh(),u=q(b);ma(u,{get value(){return t.element.fill},onUpdate:a=>t.updateProperty(Zt.Fill,a)});var g=Q(u,4);ya(g,{get color(){return t.element.stroke},get width(){return t.element.strokeWidth},onUpdateColor:a=>t.updateProperty(Zt.Stroke,a),onUpdateWidth:a=>t.updateProperty(Zt.StrokeWidth,a)});var l=Q(g,4);const h=ft(()=>t.element.opacity||1);_n(l,{get value(){return M(h)},onUpdate:a=>t.updateProperty(Zt.Opacity,a)}),z(b),rt(i,b),bt()}const _t={Circle:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<circle cx="12" cy="12" r="10" stroke-width="2"/>
	</svg>`,Rectangle:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke-width="2"/>
	</svg>`,Square:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<rect x="4" y="4" width="16" height="16" rx="2" ry="2" stroke-width="2"/>
	</svg>`,Triangle:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M12 2 L22 20 L2 20 Z" stroke-width="2"/>
	</svg>`,Pentagon:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M12 2 L22 9 L18 20 L6 20 L2 9 Z" stroke-width="2"/>
	</svg>`,Hexagon:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M17 3 L21 9 L21 15 L17 21 L7 21 L3 15 L3 9 L7 3 Z" stroke-width="2"/>
	</svg>`,Star:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M12 2 L15.09 8.26 L22 9.27 L17 14.14 L18.18 21.02 L12 17.77 L5.82 21.02 L7 14.14 L2 9.27 L8.91 8.26 Z" stroke-width="2"/>
	</svg>`,Diamond:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M6 3 H18 L22 9 L12 21 L2 9 Z" stroke-width="2"/>
	</svg>`,Arrow:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M5 12 L19 12" stroke-width="2"/>
		<path d="M12 5 L19 12 L12 19" stroke-width="2"/>
	</svg>`,Heart:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" stroke-width="2"/>
	</svg>`,Cross:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M12 2 L12 22" stroke-width="2"/>
		<path d="M2 12 L22 12" stroke-width="2"/>
	</svg>`,Heading:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M6 4 L6 20" stroke-width="2"/>
		<path d="M18 4 L18 20" stroke-width="2"/>
		<path d="M6 12 L18 12" stroke-width="2"/>
	</svg>`,Paragraph:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M3 6 L21 6" stroke-width="2"/>
		<path d="M3 12 L21 12" stroke-width="2"/>
		<path d="M3 18 L15 18" stroke-width="2"/>
	</svg>`,Label:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" stroke-width="2"/>
		<circle cx="7" cy="7" r="1"/>
	</svg>`,Image:`<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke-width="2"/>
		<circle cx="8.5" cy="8.5" r="1.5"/>
		<path d="M21 15 L16 10 L5 21" stroke-width="2"/>
	</svg>`};function oh(){Pt.register({type:Tt.Shape,subType:J.Circle,name:"Circle",icon:_t.Circle,description:"Perfect circle",category:Mt.Shapes,editPanel:{component:Jt,title:"Circle Properties",icon:_t.Circle},konvaComponent:oa,defaultProps:{radius:30,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Rectangle,name:"Rectangle",icon:_t.Rectangle,description:"Basic rectangle shape",category:Mt.Shapes,editPanel:{component:Jt,title:"Rectangle Properties",icon:_t.Rectangle},konvaComponent:Pi,defaultProps:{width:60,height:40,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Square,name:"Square",icon:_t.Square,description:"Perfect square",category:Mt.Shapes,editPanel:{component:Jt,title:"Square Properties",icon:_t.Square},konvaComponent:Pi,defaultProps:{size:50,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Triangle,name:"Triangle",icon:_t.Triangle,description:"Triangle shape",category:Mt.Shapes,editPanel:{component:Jt,title:"Triangle Properties",icon:_t.Triangle},konvaComponent:me,defaultProps:{sides:3,radius:35,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Pentagon,name:"Pentagon",icon:_t.Pentagon,description:"5-sided polygon",category:Mt.Shapes,editPanel:{component:Jt,title:"Pentagon Properties",icon:_t.Pentagon},konvaComponent:me,defaultProps:{sides:5,radius:35,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Hexagon,name:"Hexagon",icon:_t.Hexagon,description:"6-sided polygon",category:Mt.Shapes,editPanel:{component:Jt,title:"Hexagon Properties",icon:_t.Hexagon},konvaComponent:me,defaultProps:{sides:6,radius:35,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Star,name:"Star",icon:_t.Star,description:"5-point star",category:Mt.Shapes,editPanel:{component:Jt,title:"Star Properties",icon:_t.Star},konvaComponent:pa,defaultProps:{numPoints:5,innerRadius:20,outerRadius:40,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Diamond,name:"Diamond",icon:_t.Diamond,description:"Diamond shape",category:Mt.Shapes,editPanel:{component:Jt,title:"Diamond Properties",icon:_t.Diamond},konvaComponent:me,defaultProps:{sides:4,radius:35,rotation:45,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Ellipse,name:"Ellipse",icon:_t.Circle,description:"Oval shape",category:Mt.Shapes,editPanel:{component:Jt,title:"Ellipse Properties",icon:_t.Circle},konvaComponent:ha,defaultProps:{radiusX:50,radiusY:30,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Arrow,name:"Arrow",icon:_t.Arrow,description:"Arrow pointer",category:Mt.Shapes,editPanel:{component:Jt,title:"Arrow Properties",icon:_t.Arrow},konvaComponent:aa,defaultProps:{points:[0,0,60,0],pointerLength:15,pointerWidth:10,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Heart,name:"Heart",icon:_t.Heart,description:"Heart shape",category:Mt.Shapes,editPanel:{component:Jt,title:"Heart Properties",icon:_t.Heart},konvaComponent:Ti,defaultProps:{width:50,height:45,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}}),Pt.register({type:Tt.Shape,subType:J.Cross,name:"Cross",icon:_t.Cross,description:"Cross shape",category:Mt.Shapes,editPanel:{component:Jt,title:"Cross Properties",icon:_t.Cross},konvaComponent:Ti,defaultProps:{width:50,height:50,thickness:15,fill:pt.DefaultFill,stroke:pt.DefaultStroke,strokeWidth:2,draggable:!0}})}var lh=(i,t)=>t.updateProperty(Zt.FontFamily,i.target.value),hh=(i,t)=>t.updateProperty(Zt.FontSize,+i.target.value),ch=at('<div class="flex items-center gap-4"><div class="flex items-center gap-2"><select class="rounded border border-gray-300 px-2 py-1 text-sm"><option>Arial</option><option>Helvetica</option><option>Times New Roman</option><option>Georgia</option><option>Courier New</option></select></div> <div class="flex items-center gap-2"><input type="number" min="8" max="200" class="w-16 rounded border border-gray-300 px-2 py-1 text-sm"/></div> <div class="h-6 w-px bg-gray-200"></div> <!> <div class="h-6 w-px bg-gray-200"></div> <!> <div class="h-6 w-px bg-gray-200"></div> <!></div>');function ji(i,t){yt(t,!0);var b=ch(),u=q(b),g=q(u);Xr(g,()=>t.element.fontFamily);var l;g.__change=[lh,t];var h=q(g);h.value=h.__value="Arial";var a=Q(h);a.value=a.__value="Helvetica";var c=Q(a);c.value=c.__value="Times New Roman";var r=Q(c);r.value=r.__value="Georgia";var s=Q(r);s.value=s.__value="Courier New",z(g),z(u);var p=Q(u,2),n=q(p);Lt(n),n.__input=[hh,t],z(p);var e=Q(p,4);ma(e,{get value(){return t.element.fill},onUpdate:o=>t.updateProperty(Zt.Fill,o)});var f=Q(e,4);const _=ft(()=>t.element.stroke||"#000000"),y=ft(()=>t.element.strokeWidth||0);ya(f,{get color(){return M(_)},get width(){return M(y)},onUpdateColor:o=>t.updateProperty(Zt.Stroke,o),onUpdateWidth:o=>t.updateProperty(Zt.StrokeWidth,o)});var k=Q(f,4);const d=ft(()=>t.element.opacity||1);_n(k,{get value(){return M(d)},onUpdate:o=>t.updateProperty(Zt.Opacity,o)}),z(b),St(()=>{l!==(l=t.element.fontFamily)&&(g.value=(g.__value=t.element.fontFamily)??"",Vr(g,t.element.fontFamily)),Te(n,t.element.fontSize)}),rt(i,b),bt()}re(["change","input"]);function dh(){Pt.register({type:Tt.Text,subType:Ii.Heading,name:"Heading",icon:_t.Heading,description:"Large heading text",category:Mt.Text,editPanel:{component:ji,title:"Heading Properties",icon:_t.Heading},konvaComponent:Si,defaultProps:{text:"Heading",fontFamily:"Arial",fontSize:32,fontWeight:"bold",textAlign:"left",fill:pt.Black,stroke:pt.Transparent,strokeWidth:0,draggable:!0,opacity:1,padding:8,width:200,height:50}}),Pt.register({type:Tt.Text,subType:Ii.Paragraph,name:"Body",icon:_t.Paragraph,description:"Body text paragraph",category:Mt.Text,editPanel:{component:ji,title:"Body Properties",icon:_t.Paragraph},konvaComponent:Si,defaultProps:{text:"Your text here",fontFamily:"Arial",fontSize:16,fontWeight:"normal",textAlign:"left",fill:pt.Black,stroke:pt.Transparent,strokeWidth:0,draggable:!0,opacity:1,padding:6,width:180,height:30}}),Pt.register({type:Tt.Text,subType:Ii.Caption,name:"Caption",icon:_t.Label,description:"Small caption text",category:Mt.Text,editPanel:{component:ji,title:"Caption Properties",icon:_t.Label},konvaComponent:Si,defaultProps:{text:"Caption",fontFamily:"Arial",fontSize:12,fontWeight:"normal",textAlign:"left",fill:pt.Gray,stroke:pt.Transparent,strokeWidth:0,draggable:!0,opacity:1,padding:4,width:120,height:20}})}var uh=(i,t)=>t.updateProperty(Zt.Brightness,+i.target.value),fh=(i,t)=>t.updateProperty(Zt.Contrast,+i.target.value),gh=at('<div class="flex items-center gap-4"><!> <div class="h-6 w-px bg-gray-200"></div> <div class="flex items-center gap-2"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-600"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path></svg> <input type="range" min="-1" max="1" step="0.01" class="w-20"/> <span class="text-xs text-gray-500 w-8"> </span></div> <div class="h-6 w-px bg-gray-200"></div> <div class="flex items-center gap-2"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-600"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a10 10 0 0 0 0 20v-20z" fill="currentColor"></path></svg> <input type="range" min="-1" max="1" step="0.01" class="w-20"/> <span class="text-xs text-gray-500 w-8"> </span></div></div>');function vh(i,t){yt(t,!0);var b=gh(),u=q(b);const g=ft(()=>t.element.opacity||1);_n(u,{get value(){return M(g)},onUpdate:e=>t.updateProperty(Zt.Opacity,e)});var l=Q(u,4),h=Q(q(l),2);Lt(h),h.__input=[uh,t];var a=Q(h,2),c=q(a,!0);z(a),z(l);var r=Q(l,4),s=Q(q(r),2);Lt(s),s.__input=[fh,t];var p=Q(s,2),n=q(p,!0);z(p),z(r),z(b),St((e,f)=>{Te(h,t.element.brightness||0),ee(c,e),Te(s,t.element.contrast||0),ee(n,f)},[()=>Math.round((t.element.brightness||0)*100),()=>Math.round((t.element.contrast||0)*100)]),rt(i,b),bt()}re(["input"]);function ph(){Pt.register({type:Tt.Image,subType:$a.Upload,name:"Upload Image",icon:_t.Image,description:"Upload and add an image",category:Mt.Images,editPanel:{component:vh,title:"Image Properties",icon:_t.Image},konvaComponent:fa,defaultProps:{width:100,height:100,draggable:!0,opacity:1,scaleX:1,scaleY:1,rotation:0}})}function _h(){oh(),dh(),ph()}var mh=at('<div class="h-full bg-gray-50 px-6 py-3 border-b border-gray-200"><div class="flex h-full items-center gap-6 overflow-x-auto"><!></div></div>'),yh=at('<div class="relative h-screen bg-gray-50"><!> <div class="fixed left-0 z-30" style="top: 64px; bottom: 0;"><!></div> <div class="flex h-full flex-col"><div class="sticky z-20"><!></div> <!></div> <!> <!></div>');function Hh(i,t){yt(t,!0);const[b,u]=Wa(),g=()=>bi(le,"$shapes",b),l=()=>bi(he,"$textElements",b),h=()=>bi(ce,"$images",b),a=()=>bi(Kt,"$history",b);_h();let c=mt(!1),r=mt(null),s,p=mt(void 0),n=mt(void 0);function e($){nt(p,$,!0)}let f=mt(null),_=mt("Design Canvas"),y=mt(!1),k=mt("#ffffff"),d=mt(!1),o=mt(100),m=mt(500),x=mt(400);const P=ft(()=>M(r)&&(g().find($=>$.id===M(r))||l().find($=>$.id===M(r))||h().find($=>$.id===M(r)))||null),L=ft(()=>!!M(P)),A=ft(()=>ql(M(o))),T=ft(()=>jl(M(o))),S=ft(()=>Kl(M(o),$=>nt(o,$,!0))),E=Zl();X(()=>{M(p)&&E.setStageRef(M(p))}),X(()=>{M(r)&&!M(P)&&nt(r,null)});const F=ft(()=>gs(M(m),M(x))),v=ps(),C=_s($=>nt(r,$,!0)),w=ns($=>nt(k,$,!0)),R=rs($=>nt(d,$,!0)),G=as($=>nt(o,$,!0)),N=ss($=>nt(m,$,!0),$=>nt(x,$,!0)),I=ft(()=>os(M(m),M(x),$=>nt(o,$,!0))),O=ls($=>nt(r,$,!0)),H=hs($=>nt(_,$,!0)),j=ft(()=>ms(M(o)));let U=mt(void 0);function W($){nt(f,$.id,!0),M(U)&&M(U).positionInput($,M(p),M(o))}function Z(){nt(f,null)}function tt($){nt(c,!0)}function D(){nt(c,!1)}var B=yh(),V=q(B);const K=ft(()=>Kt.canUndo(a())),et=ft(()=>Kt.canRedo(a()));Yl(V,{get title(){return M(_)},get onTitleChange(){return H},onExportClick:()=>nt(y,!0),onUndo:()=>Kt.undo(),onRedo:()=>Kt.redo(),get canUndo(){return M(K)},get canRedo(){return M(et)}});var it=Q(V,2),ht=q(it);Ds(ht,{get isOpen(){return M(c)},get elementSelected(){return M(F)},open:tt,close:D,get clearCanvas(){return Jr}}),z(it);var ct=Q(it,2),st=q(ct),Ct=q(st);{var ot=$=>{Is($,{get selectedElement(){return M(P)},get isVisible(){return M(L)},get onUpdateElement(){return v},get onClose(){return C}})},lt=$=>{var Et=mh(),Ot=q(Et),Ht=q(Ot);So(Ht,{get backgroundColor(){return M(k)},get showGrid(){return M(d)},get zoom(){return M(o)},get canvasWidth(){return M(m)},get canvasHeight(){return M(x)},get onUpdateBackground(){return w},get onToggleGrid(){return R},get onUpdateZoom(){return G},get onUpdateCanvasSize(){return N},get onFitToWindow(){return M(I)},get onResetCanvas(){return O}}),z(Ot),z(Et),rt($,Et)};xt(Ct,$=>{M(P)?$(ot):$(lt,!1)})}z(st);var vt=Q(st,2);Qt(sl(vt,{onStageReady:e,get canvasWidth(){return M(m)},get canvasHeight(){return M(x)},get canvasZoom(){return M(o)},get canvasBackgroundColor(){return M(k)},get showGrid(){return M(d)},get shapes(){return g()},get images(){return h()},get textElements(){return l()},get selectedId(){return M(r)},onStageClick:$=>{$.target===$.target.getStage()&&nt(r,null)},get onWheel(){return M(S)},get onMouseDown(){return E.handleMouseDown},get onMouseMove(){return E.handleMouseMove},get onMouseUp(){return E.handleMouseUp},get onShapeDragEnd(){return M(A)},get onImageDragEnd(){return M(T)},onElementClick:$=>{nt(r,$,!0),M(n)&&M(n)()},onTextElementClick:$=>{nt(r,$,!0),M(n)&&M(n)()},onTextElementDblClick:W,get onTextElementDragEnd(){return M(j)},get updateTransformer(){return M(n)},set updateTransformer($){nt(n,$,!0)}}),$=>s=$,()=>s),z(ct);var wt=Q(ct,2);Qt(zl(wt,{get editingTextId(){return M(f)},get textElements(){return l()},onClose:Z}),$=>nt(U,$,!0),()=>M(U));var zt=Q(wt,2);Gl(zt,{get isOpen(){return M(y)},get stageRef(){return M(p)},get canvasBackgroundColor(){return M(k)},get designTitle(){return M(_)},onClose:()=>nt(y,!1)}),z(B),St(()=>{Wt(ct,`margin-left: ${Gr.SidebarClosedWidth}; margin-top: 64px;`),Wt(st,`top: 64px; height: ${Gr.EditBarHeight};`)}),rt(i,B),bt(),u()}export{Hh as component};
